<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Centrifugo v5 released | Centrifugo</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://centrifugal.dev/blog/2023/06/29/centrifugo-v5-released"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Centrifugo v5 released | Centrifugo"><meta data-rh="true" name="description" content="We are excited to announce a new version of Centrifugo. It&#x27;s an evolutionary step which makes Centrifugo cleaner and more intuitive to use."><meta data-rh="true" property="og:description" content="We are excited to announce a new version of Centrifugo. It&#x27;s an evolutionary step which makes Centrifugo cleaner and more intuitive to use."><meta data-rh="true" property="og:image" content="https://centrifugal.dev/img/v5_thumb.jpg"><meta data-rh="true" name="twitter:image" content="https://centrifugal.dev/img/v5_thumb.jpg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-06-29T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="centrifugo,release"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://centrifugal.dev/blog/2023/06/29/centrifugo-v5-released"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/blog/2023/06/29/centrifugo-v5-released" hreflang="en"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/blog/2023/06/29/centrifugo-v5-released" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EPXZ1LXJ33-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://centrifugal.dev/blog/2023/06/29/centrifugo-v5-released","mainEntityOfPage":"https://centrifugal.dev/blog/2023/06/29/centrifugo-v5-released","url":"https://centrifugal.dev/blog/2023/06/29/centrifugo-v5-released","headline":"Centrifugo v5 released","name":"Centrifugo v5 released","description":"We are excited to announce a new version of Centrifugo. It's an evolutionary step which makes Centrifugo cleaner and more intuitive to use.","datePublished":"2023-06-29T00:00:00.000Z","author":{"@type":"Person","name":"Centrifugal team","description":"üíª‚ú®üîÆ‚ú®üíª","image":"/img/logo_animated.svg"},"image":{"@type":"ImageObject","@id":"https://centrifugal.dev/img/v5_thumb.jpg","url":"https://centrifugal.dev/img/v5_thumb.jpg","contentUrl":"https://centrifugal.dev/img/v5_thumb.jpg","caption":"title image for the blog post: Centrifugo v5 released"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://centrifugal.dev/blog","name":"Centrifugal Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=" Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title=" JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZRQD92LEX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NZRQD92LEX",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Centrifugo" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"><link rel="stylesheet" href="/assets/css/styles.03564f59.css">
<script src="/assets/js/runtime~main.12d42afc.js" defer="defer"></script>
<script src="/assets/js/main.9fa26985.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Centrifugo</b></a><a class="navbar__item navbar__link" href="/docs/getting-started/introduction">Getting Started</a><a class="navbar__item navbar__link" href="/docs/server/configuration">Server guide</a><a class="navbar__item navbar__link" href="/docs/transports/overview">Real-time transports / SDK</a><a class="navbar__item navbar__link" href="/pro">Centrifugo PRO ‚ôªÔ∏è</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs/tutorial/intro">Grand tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/centrifugal/centrifugo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/getting-started/introduction">v6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/getting-started/introduction">v6</a></li><li><a class="dropdown__link" href="/docs/5/getting-started/introduction">v5</a></li><li><a class="dropdown__link" href="/docs/4/getting-started/introduction">v4</a></li><li><a class="dropdown__link" href="/docs/3/getting-started/introduction">v3</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1"><article class=""><header><h1 class="title_f1Hy">Centrifugo v5 released</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-06-29T00:00:00.000Z">June 29, 2023</time> ¬∑ <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/logo_animated.svg" alt="Centrifugal team"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Centrifugal team</span></div><small class="authorTitle_nd0D" title="üíª‚ú®üîÆ‚ú®üíª">üíª‚ú®üîÆ‚ú®üíª</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>In Centrifugo v5 we&#x27;re phasing out old client protocol support, introducing a more intuitive HTTP API, adjusting token management behaviour in SDKs, improving configuration process, and refactoring the history meta ttl option. As the result you get a cleaner, more user-friendly, and optimized Centrifugo experience. And we have important news about the project - check it out in the end of this post.</p>
<img src="/img/v5.jpg">
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>What is Centrifugo?</div><div class="admonitionContent_BuS1"><p>Centrifugo is an open-source scalable real-time messaging server. Centrifugo can instantly deliver messages to application online users connected over supported transports (WebSocket, HTTP-streaming, SSE/EventSource, GRPC, SockJS, WebTransport). Centrifugo has the concept of a channel ‚Äì so it&#x27;s a user-facing PUB/SUB server.</p><p>Centrifugo is language-agnostic and can be used to build chat apps, live comments, multiplayer games, real-time data visualizations, collaborative tools, etc. in combination with any backend. It is well suited for modern architectures and allows decoupling the business logic from the real-time transport layer.</p><p>Several official client SDKs for browser and mobile development wrap the bidirectional protocol. In addition, Centrifugo supports a unidirectional approach for simple use cases with no SDK dependency.</p></div></div>
<p>Let&#x27;s proceed and take a look at most notable changes of Centrifugo v5.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="dropping-old-client-protocol">Dropping old client protocol<a href="#dropping-old-client-protocol" class="hash-link" aria-label="Direct link to Dropping old client protocol" title="Direct link to Dropping old client protocol">‚Äã</a></h2>
<p>With the introduction of Centrifugo v4, our previous major release, <a href="/blog/2022/07/19/centrifugo-v4-released#unified-client-sdk-api">we rolled out</a> a new version of the client protocol along with a set of client SDKs designed to work in conjunction with it. Nevertheless, we maintained support for the old client protocol in Centrifugo v4 to facilitate a seamless migration of applications.</p>
<p>In Centrifugo v5 we are discontinuing support for the old protocol. If you have been using Centrifugo v4 with the latest SDKs, this change should have no impact on you. From our perspective, removing support for the old protocol allows us to eliminate a considerable amount of non-obvious branching in the source code and cleanup Protobuf schema definitions.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="token-behaviour-adjustments-in-sdks">Token behaviour adjustments in SDKs<a href="#token-behaviour-adjustments-in-sdks" class="hash-link" aria-label="Direct link to Token behaviour adjustments in SDKs" title="Direct link to Token behaviour adjustments in SDKs">‚Äã</a></h2>
<p>In Centrifugo v5 we are adjusting <a href="/docs/transports/client_api">client SDK specification</a> in the aspect of connection token management. Previously, returning an empty token string from <code>getToken</code> callback resulted in client disconnection with <code>unauthorized</code> reason.</p>
<p>There was some problem with it though. We did not take into account the fact that empty token may be a valid scenario actually. Centrifugo supports options to avoid using token at all for anonymous access. So the lack of possibility to switch between <code>token</code>/<code>no token</code> scenarios did not allow users to easily implement login/logout workflow. The only way was re-initializing SDK.</p>
<p>Now returning an empty string from <code>getToken</code> is a valid scenario which won&#x27;t result into disconnect on the client side. It&#x27;s still possible to disconnect client by returning a special error from <code>getToken</code> function.</p>
<p>And we are putting back <code>setToken</code> method to our SDKs ‚Äì so it&#x27;s now possible to reset the token to be empty upon user logout.</p>
<p>An abstract example in Javascript which demonstrates how login/logout flow may be now implemented with our SDK:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> centrifuge </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Centrifuge</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;ws://localhost:8000/connection/websocket&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Provide function which returns empty string for anonymous users,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// and proper JWT for authenticated users.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token literal-property property">getToken</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> getTokenImplementation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">centrifuge</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">connect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">loginButton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">addEventListener</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;click&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    centrifuge</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">disconnect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Do actual login here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    centrifuge</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">connect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">logoutButton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">addEventListener</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;click&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    centrifuge</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">disconnect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Reset token - so that getToken will be called on next connect attempt.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    centrifuge</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Do actual logout here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    centrifuge</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">connect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We updated all our SDKs to inherit described behaviour - check out v5 <a href="/docs/getting-started/migration_v5">migration guide</a> for more details.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="history_meta_ttl-refactoring">history_meta_ttl refactoring<a href="#history_meta_ttl-refactoring" class="hash-link" aria-label="Direct link to history_meta_ttl refactoring" title="Direct link to history_meta_ttl refactoring">‚Äã</a></h2>
<p>One of Centrifugo&#x27;s key advantages for real-time messaging tasks is its ephemeral channels and per-channel history. In version 5, we&#x27;ve improved one aspect of handling history by offering users the ability to tune the history meta TTL option at the channel namespace level.</p>
<p>The history meta TTL is the duration Centrifugo retains meta information about each channel stream, such as the latest offset and current stream epoch. This data allows users to successfully restore connections upon reconnection, particularly useful when subscribed to mostly inactive channels where publications are infrequent. Although the history meta TTL can usually be reasonably large (significantly larger than history TTL), there are certain scenarios where it&#x27;s beneficial to minimize it as much as possible.</p>
<p>One such use case is illustrated in this <a href="https://github.com/centrifugal/examples/tree/master/v4/go_async_processing" target="_blank" rel="noopener noreferrer">example</a>. Using Centrifugo SDK and channels with history, it&#x27;s possible to reliably stream results of asynchronous tasks to clients.</p>
<p>As another example, consider a ChatGPT use case where clients ask questions, subscribe to a channel with the answer, and then the response is streamed towards the client token by token. This all may be done over a secure, separate channel protected with a token. With the ability to use a relatively small history meta TTL in the channel namespace, implementing such things is now simpler.</p>
<p>Hence, <code>history_meta_ttl</code> is now an option at the channel namespace level (instead of per-engine). However, setting it is optional as we have a global default value for it - see <a href="/docs/server/channels#history_meta_ttl">details in the doc</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="node-communication-protocol-update">Node communication protocol update<a href="#node-communication-protocol-update" class="hash-link" aria-label="Direct link to Node communication protocol update" title="Direct link to Node communication protocol update">‚Äã</a></h2>
<p>When running in cluster Centrifugo nodes can communicate between each other using broker&#x27;s PUB/SUB. Nodes exchange some information - like statistics, emulation requests, etc.</p>
<p>In Centrifugo v5 we are simplifying and making inter-node communication protocol slightly faster by removing extra encoding layers from it&#x27;s format. Something similar to what we did for our client protocol in Centrifugo v4.</p>
<p>This change, however, leads to an incompatibility between Centrifugo v4 and v5 nodes in terms of their communication protocols. Consequently, Centrifugo v5 cannot be part of a cluster with Centrifugo v4 nodes.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="new-http-api-format">New HTTP API format<a href="#new-http-api-format" class="hash-link" aria-label="Direct link to New HTTP API format" title="Direct link to New HTTP API format">‚Äã</a></h2>
<p>From the beginning Centrifugo HTTP API exposed one <code>/api</code> endpoint to make requests with all command types.</p>
<p>To work properly HTTP API had to add one additional layer to request JSON payload to be able to distinguish between different API methods:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --header &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --header &quot;Authorization: apikey API_KEY&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --request POST \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --data &#x27;{&quot;method&quot;: &quot;publish&quot;, &quot;params&quot;: {&quot;channel&quot;: &quot;test&quot;, &quot;data&quot;: {&quot;x&quot;: 1}}}&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  http://localhost:8000/api</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And it worked fine. It additionally supported request batching where users could send many commands to Centrifugo in one request using line-delimited JSON.</p>
<p>However, the fact that we were accommodating various commands via a single API endpoint resulted in nested serialized payloads for each command. The top-level method would determine the structure of the params. We addressed this issue in the client protocol in Centrifugo v4, and now we&#x27;re addressing a similar issue in the inter-node communication protocol in Centrifugo v5.</p>
<p>At some point we introduced GRPC API in Centrifugo. In GRPC case we don&#x27;t have a way to send batches of commands without defining a separate method to do so.</p>
<p>These developments highlighted the need for us to align the HTTP API format more closely with the GRPC API. Specifically, we need to separate the command method from the actual method payload, moving towards a structure like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --header &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --header &quot;X-API-Key: API_KEY&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --request POST \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --data &#x27;{&quot;channel&quot;: &quot;test&quot;, &quot;data&quot;: {&quot;x&quot;: 1}}&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  http://localhost:8000/api/publish</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note:</p>
<ul>
<li><code>/api/publish</code> instead of <code>/api</code> in path</li>
<li>payload does not include <code>method</code> and <code>params</code> keys anymore</li>
<li>we also support <code>X-API-Key</code> header for setting API key to be closer to OpenAPI specification (see more about OpenAPI below)</li>
</ul>
<p>In v5 we implemented the approach above. Many thanks to <a href="https://github.com/StringNick" target="_blank" rel="noopener noreferrer">@StringNick</a> for the help with the implementation and discussions.</p>
<p>Our HTTP and GRPC API are very similar now. We&#x27;ve also introduced a new batch method to send multiple commands in both HTTP and GRPC APIs, a feature that was previously unavailable in GRPC.</p>
<p>Documentation for v5 was updated to reflect this change. But it worth noting - old API format id still supported. It will be supported for some time while we are migrating our HTTP API libraries to use modern API version. Hopefully users won&#x27;t be affected by this migration a lot, just switching to a new version of library at some point.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="openapi-spec-and-swagger-ui">OpenAPI spec and Swagger UI<a href="#openapi-spec-and-swagger-ui" class="hash-link" aria-label="Direct link to OpenAPI spec and Swagger UI" title="Direct link to OpenAPI spec and Swagger UI">‚Äã</a></h2>
<p>One additional benefit of moving to the new HTTP format is the possibility to define a clear OpenAPI schema for each API method Centrifugo has. It was previously quite tricky due to the fact we had one endpoint capable to work with all kinds of commands.</p>
<p>This change paves the way for generating HTTP clients based on our OpenAPI specification.</p>
<p>We now have Swagger UI built-in. To access it, launch Centrifugo with the <code>&quot;swagger&quot;: true</code> option and navigate to <code>http://localhost:8000/swagger</code>.</p>
<p>The Swagger UI operates on the internal port, so if you&#x27;re running Centrifugo using our Kubernetes Helm chart, it won&#x27;t be exposed to the same ingress as client connection endpoints. This is similar to how our Prometheus, admin, API, and debug endpoints currently work.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="opentelemetry-for-server-api">OpenTelemetry for server API<a href="#opentelemetry-for-server-api" class="hash-link" aria-label="Direct link to OpenTelemetry for server API" title="Direct link to OpenTelemetry for server API">‚Äã</a></h2>
<p>Another good addition is an OpenTelemetry tracing support for HTTP and GRPC server API requests. If you are using OpenTelemetry in your services you can now now enable tracing export in Centrifugo and find Centrifugo API request exported traces in your tracing collector UI.</p>
<p>Description and simple example with Jaeger may be found <a href="/docs/server/observability#opentelemetry">in observability chapter</a>. We only support OTLP HTTP export format and trace format defined in W3C spec: <a href="https://www.w3.org/TR/trace-context/" target="_blank" rel="noopener noreferrer">https://www.w3.org/TR/trace-context/</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="separate-config-for-subscription-token">Separate config for subscription token<a href="#separate-config-for-subscription-token" class="hash-link" aria-label="Direct link to Separate config for subscription token" title="Direct link to Separate config for subscription token">‚Äã</a></h2>
<p>With the introduction of JWKS support in Centrifugo v4 (a way to validate JWT tokens using a remote endpoint which manages keys and key rotation - see <a href="https://datatracker.ietf.org/doc/html/rfc7517" target="_blank" rel="noopener noreferrer">JWK spec</a>) Centrifugo users can rely on JWKS provider (like Keycloak, AWS Cognito) for making authentication.</p>
<p>But at the same time developers may want to work with channels using subscription tokens managed in a custom way ‚Äì without using the same JWKS configuration used for connection tokens.</p>
<p>Centrifugo v5 allows doing by introducing the <code>separate_subscription_token_config</code> option.</p>
<p>When <code>separate_subscription_token_config</code> is <code>true</code> Centrifugo does not look at general token options at all when verifying subscription tokens and uses config options starting from <code>subscription_token_</code> prefix instead.</p>
<p>Here is an example how to use JWKS for connection tokens, but have HMAC-based verification for subscription tokens:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">config.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;token_jwks_public_endpoint&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://example.com/openid-connect/certs&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;separate_subscription_token_config&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;subscription_token_hmac_secret_key&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;separate_secret_which_must_be_strong&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="unknown-config-keys-warnings">Unknown config keys warnings<a href="#unknown-config-keys-warnings" class="hash-link" aria-label="Direct link to Unknown config keys warnings" title="Direct link to Unknown config keys warnings">‚Äã</a></h2>
<p>With every release, Centrifugo offers more and more options. One thing we&#x27;ve noticed is that some options from previous Centrifugo options, which were already removed, still persist in the user&#x27;s configuration file.</p>
<p>Another issue is that a single typo in the configuration key can cost hours of debugging especially for Centrifugo new users. What is worse, the typo might result in unexpected behavior if the feature isn&#x27;t properly tested before being run in production.</p>
<p>In Centrifugo v5, we are addressing these problems. Now, Centrifugo logs on WARN level about unknown keys found in the configuration upon server start-up. Not only in the configuration file but also verifying the validity of environment variables (looking at those starting with <code>CENTRIFUGO_</code> prefix). This should help clean up the configuration to align with the latest Centrifugo release and catch typos at an early stage.</p>
<p>It looks like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">08:25:33 [WRN] unknown key found in the namespace object key=watch namespace_name=xx</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">08:25:33 [WRN] unknown key found in the proxy object key=type proxy_name=connect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">08:25:33 [WRN] unknown key found in the configuration file key=granulr_proxy_mode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">08:25:33 [WRN] unknown key found in the environment key=CENTRIFUGO_ADDRES</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>These warnings do not prevent server to start so you can gradually clean up the configuration.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="simplifying-protocol-debug-with-postman">Simplifying protocol debug with Postman<a href="#simplifying-protocol-debug-with-postman" class="hash-link" aria-label="Direct link to Simplifying protocol debug with Postman" title="Direct link to Simplifying protocol debug with Postman">‚Äã</a></h2>
<p>Centrifugo v5 supports a special url parameter for bidirectional websocket which turns on using native WebSocket frame ping-pong mechanism instead of server-to-client application level pings Centrifugo uses by default. This simplifies debugging Centrifugo protocol with tools like Postman, wscat, websocat, etc.</p>
<p>Previously it was inconvenient due to the fact Centrifugo sends periodic ping message to the client (<code>{}</code> in JSON protocol scenario) and expects pong response back within some time period. Otherwise Centrifugo closes connection. This results in problems with mentioned tools because you had to manually send <code>{}</code> pong message upon ping message. So typical session in <code>wscat</code> could look like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚ùØ wscat --connect ws://localhost:8000/connection/websocket</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Connected (press CTRL+C to quit)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; {&quot;id&quot;: 1, &quot;connect&quot;: {}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt; {&quot;id&quot;:1,&quot;connect&quot;:{&quot;client&quot;:&quot;9ac9de4e-5289-4ad6-9aa7-8447f007083e&quot;,&quot;version&quot;:&quot;0.0.0&quot;,&quot;ping&quot;:25,&quot;pong&quot;:true}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt; {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Disconnected (code: 3012, reason: &quot;no pong&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The parameter is called <code>cf_ws_frame_ping_pong</code>, to use it connect to Centrifugo bidirectional WebSocket endpoint like <code>ws://localhost:8000/connection/websocket?cf_ws_frame_ping_pong=true</code>. Here is an example which demonstrates working with Postman WebSocket where we connect to local Centrifugo and subscribe to two channels <code>test1</code> and <code>test2</code>:</p>
<video width="100%" loop="" autoplay="" muted="" src="/img/postman.mp4"></video>
<p>You can then proceed to Centrifugo <a href="/docs/server/admin_web">admin web UI</a>, publish something to these channels and see publications in Postman.</p>
<p>Note, how we sent several JSON commands in one WebSocket frame to Centrifugo from Postman in the example above - this is possible since Centrifugo protocol supports batches of commands in line-delimited format.</p>
<p>We consider this feature to be used only for debugging, <strong>in production prefer using our SDKs without using <code>cf_ws_frame_ping_pong</code> parameter</strong> ‚Äì because app-level ping-pong is more efficient and our SDKs detect broken connections due to it.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-future-of-sockjs">The future of SockJS<a href="#the-future-of-sockjs" class="hash-link" aria-label="Direct link to The future of SockJS" title="Direct link to The future of SockJS">‚Äã</a></h2>
<p>As you know SockJS is deprecated in Centrifugal ecosystem since Centrifugo v4. In this release we are not removing support for it ‚Äì but we may do this in the next release.</p>
<p>Unfortunately, SockJS client repo is poorly maintained these days. And some of its iframe-based transports are becoming archaic. If you depend on SockJS and you really need fallback for WebSocket ‚Äì consider switching to Centrifugo own bidirectional emulation for the browser which works over HTTP-streaming (using modern fetch API with Readable streams) or SSE. It should be more performant and work without sticky sessions requirement (sticky sessions is an optimization in our implementation). More details may be found in <a href="/blog/2022/07/19/centrifugo-v4-released#modern-websocket-emulation-in-javascript">Centrifugo v4 release post</a>.</p>
<p>If you think SockJS is still required for your use case - reach us out so we could think about the future steps together.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="introducing-centrifugal-labs-ltd">Introducing Centrifugal Labs LTD<a href="#introducing-centrifugal-labs-ltd" class="hash-link" aria-label="Direct link to Introducing Centrifugal Labs LTD" title="Direct link to Introducing Centrifugal Labs LTD">‚Äã</a></h2>
<p>Finally, some important news we mentioned in the beginning!</p>
<p>Centrifugo is now backed by the company called <strong>Centrifugal Labs LTD</strong> - a Cyprus-registered technology company. This should help us to finally launch <a href="/docs/pro/overview">Centrifugo PRO</a> offering ‚Äì the product we have been working on for a couple of years now and which has some unique and powerful features like <a href="/docs/pro/analytics">real-time analytics</a> or <a href="/docs/pro/push_notifications">push notification API</a>.</p>
<p>As a Centrifugo user you will start noticing mentions of Centrifugal Labs LTD in our licenses, Github organization, throughout this web site. And that&#x27;s mostly it - no radical changes at this point. We will still be working on improving Centrifugo trying to find a balance between OSS and PRO versions. Which is difficult TBH ‚Äì but we will try.</p>
<p>An ideal plan for us ‚Äì make Centrifugo development sustainable enough to have the possibility for features from the PRO version flow to the OSS version eventually. The reality may be harder than this of course.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">‚Äã</a></h2>
<p>That&#x27;s all about most notable things happened in Centrifugo v5. We updated documentation to reflect the changes in v5, also some documentation chapters were rewritten. For example, take a look at the refreshed <a href="/docs/getting-started/design">Design overview</a>. Several more changes and details outlined in the <a href="/docs/getting-started/migration_v5">migration guide for Centifugo v5</a>. Please feel free to contact in the community rooms if you have questions about the release. And as usual, let the Centrifugal force be with you!</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/centrifugo">centrifugo</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/release">release</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/centrifugal/centrifugal.dev/edit/main/blog/2023-06-29-centrifugo-v5-released.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2023/08/19/asynchronous-message-streaming-to-centrifugo-with-benthos"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Asynchronous message streaming to Centrifugo with Benthos</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2023/03/31/keycloak-sso-centrifugo"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Setting up Keycloak SSO authentication flow and connecting to Centrifugo WebSocket</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dropping-old-client-protocol" class="table-of-contents__link toc-highlight">Dropping old client protocol</a></li><li><a href="#token-behaviour-adjustments-in-sdks" class="table-of-contents__link toc-highlight">Token behaviour adjustments in SDKs</a></li><li><a href="#history_meta_ttl-refactoring" class="table-of-contents__link toc-highlight">history_meta_ttl refactoring</a></li><li><a href="#node-communication-protocol-update" class="table-of-contents__link toc-highlight">Node communication protocol update</a></li><li><a href="#new-http-api-format" class="table-of-contents__link toc-highlight">New HTTP API format</a></li><li><a href="#openapi-spec-and-swagger-ui" class="table-of-contents__link toc-highlight">OpenAPI spec and Swagger UI</a></li><li><a href="#opentelemetry-for-server-api" class="table-of-contents__link toc-highlight">OpenTelemetry for server API</a></li><li><a href="#separate-config-for-subscription-token" class="table-of-contents__link toc-highlight">Separate config for subscription token</a></li><li><a href="#unknown-config-keys-warnings" class="table-of-contents__link toc-highlight">Unknown config keys warnings</a></li><li><a href="#simplifying-protocol-debug-with-postman" class="table-of-contents__link toc-highlight">Simplifying protocol debug with Postman</a></li><li><a href="#the-future-of-sockjs" class="table-of-contents__link toc-highlight">The future of SockJS</a></li><li><a href="#introducing-centrifugal-labs-ltd" class="table-of-contents__link toc-highlight">Introducing Centrifugal Labs LTD</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contacts</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/company">About us</a></li><li class="footer__item"><a href="mailto:hello@centrifugal.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Send e-mail</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/joinchat/U57MI8Lam9mhpuhd" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/tYgADKx" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/centrifugalabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/attributions">Attributions</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 Centrifugal Labs LTD</div></div></div></footer></div>
</body>
</html>