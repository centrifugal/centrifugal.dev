<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Discovering Centrifugo PRO: push notifications API | Centrifugo</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://centrifugal.dev/blog/2023/10/29/discovering-centrifugo-pro-push-notifications"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Discovering Centrifugo PRO: push notifications API | Centrifugo"><meta data-rh="true" name="description" content="We start talking more about recently launched Centrifugo PRO. In this post, we share details about Centrifugo PRO push notification API implementation - how it works and what makes it special and practical."><meta data-rh="true" property="og:description" content="We start talking more about recently launched Centrifugo PRO. In this post, we share details about Centrifugo PRO push notification API implementation - how it works and what makes it special and practical."><meta data-rh="true" property="og:image" content="https://centrifugal.dev/img/blog_push_notifications_cover_thumb.jpg"><meta data-rh="true" name="twitter:image" content="https://centrifugal.dev/img/blog_push_notifications_cover_thumb.jpg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-10-29T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="centrifugo,pro,push notifications"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://centrifugal.dev/blog/2023/10/29/discovering-centrifugo-pro-push-notifications"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/blog/2023/10/29/discovering-centrifugo-pro-push-notifications" hreflang="en"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/blog/2023/10/29/discovering-centrifugo-pro-push-notifications" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EPXZ1LXJ33-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://centrifugal.dev/blog/2023/10/29/discovering-centrifugo-pro-push-notifications","mainEntityOfPage":"https://centrifugal.dev/blog/2023/10/29/discovering-centrifugo-pro-push-notifications","url":"https://centrifugal.dev/blog/2023/10/29/discovering-centrifugo-pro-push-notifications","headline":"Discovering Centrifugo PRO: push notifications API","name":"Discovering Centrifugo PRO: push notifications API","description":"We start talking more about recently launched Centrifugo PRO. In this post, we share details about Centrifugo PRO push notification API implementation - how it works and what makes it special and practical.","datePublished":"2023-10-29T00:00:00.000Z","author":{"@type":"Person","name":"Alexander Emelin","description":"Founder of Centrifugal Labs","image":"/img/alexander_emelin.jpeg"},"image":{"@type":"ImageObject","@id":"https://centrifugal.dev/img/blog_push_notifications_cover_thumb.jpg","url":"https://centrifugal.dev/img/blog_push_notifications_cover_thumb.jpg","contentUrl":"https://centrifugal.dev/img/blog_push_notifications_cover_thumb.jpg","caption":"title image for the blog post: Discovering Centrifugo PRO: push notifications API"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://centrifugal.dev/blog","name":"Centrifugal Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=" Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title=" JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZRQD92LEX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NZRQD92LEX",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Centrifugo" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"><link rel="stylesheet" href="/assets/css/styles.03564f59.css">
<script src="/assets/js/runtime~main.12d42afc.js" defer="defer"></script>
<script src="/assets/js/main.9fa26985.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Centrifugo</b></a><a class="navbar__item navbar__link" href="/docs/getting-started/introduction">Getting Started</a><a class="navbar__item navbar__link" href="/docs/server/configuration">Server guide</a><a class="navbar__item navbar__link" href="/docs/transports/overview">Real-time transports / SDK</a><a class="navbar__item navbar__link" href="/pro">Centrifugo PRO ♻️</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs/tutorial/intro">Grand tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/centrifugal/centrifugo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/getting-started/introduction">v6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/getting-started/introduction">v6</a></li><li><a class="dropdown__link" href="/docs/5/getting-started/introduction">v5</a></li><li><a class="dropdown__link" href="/docs/4/getting-started/introduction">v4</a></li><li><a class="dropdown__link" href="/docs/3/getting-started/introduction">v3</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1"><article class=""><header><h1 class="title_f1Hy">Discovering Centrifugo PRO: push notifications API</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-10-29T00:00:00.000Z">October 29, 2023</time> · <!-- -->14 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/alexander_emelin.jpeg" alt="Alexander Emelin"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Alexander Emelin</span></div><small class="authorTitle_nd0D" title="Founder of Centrifugal Labs">Founder of Centrifugal Labs</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><img src="/img/blog_push_notifications_cover.jpg">
<p>In our <a href="/blog/2023/06/29/centrifugo-v5-released">v5 release post</a>, we announced the upcoming launch of Centrifugo PRO. We are happy to say that it was released soon after that, and at this point, we already have several customers of the PRO version.</p>
<p>I think it&#x27;s time to look at the current state of the PRO version and finally start talking more about its benefits. In this post, we will talk more about one of the coolest PRO features we have at this point: the push notifications API.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="centrifugo-pro-goals">Centrifugo PRO goals<a href="#centrifugo-pro-goals" class="hash-link" aria-label="Direct link to Centrifugo PRO goals" title="Direct link to Centrifugo PRO goals">​</a></h2>
<p>When Centrifugo was originally created, its main goal was to help introduce real-time messaging features to existing systems, written in traditional frameworks which work on top of the worker/thread model. Serving many concurrent connections is a non-trivial task in general, and without native efficient concurrency support, it becomes mostly impossible without a shift in the technology stack. Integrating with Centrifugo makes it simple to introduce an efficient real-time layer, while keeping the existing application architecture.</p>
<p>As time went on, Centrifugo got some unique features which now justify its usage even in conjunction with languages/frameworks with good concurrency support. Simply using Centrifugo for at-most-once PUB/SUB may already save a lot of development time. The task, which seems trivial at first glance, has a lot of challenges in practice: client SDKs with reconnect and channel multiplexing, scalability to many nodes, WebSocket fallbacks, etc.</p>
<p>The combination of useful possibilities has made Centrifugo an attractive component for building enterprise-level applications. Let&#x27;s be honest here - for pet projects, developers often prefer writing WebSocket communications themselves, and Centrifugo may be too heavy and an extra dependency. But in a corporate environment, the decision on which technology to use should take into account a lot of factors, like those we just mentioned above. Using a mature technology is often preferred to building from scratch and making all the mistakes along the way.</p>
<p>With the PRO version, our goal is to provide even more value for established businesses when switching to Centrifugo. We want to solve tricky cases and simplify them for our customers; we want to step into related areas where we see we can provide sufficient value.</p>
<p>One rule we try to follow for PRO features that extend Centrifugo’s scope is this: we are not trying to replicate something that already exists in other systems, but rather, we strive to improve upon it. We focus on solving practical issues that we observe, providing a unique value proposition for our customers. This post describes one such example — we will demonstrate our approach to push notifications, which is <a href="/docs/pro/overview#features">one the features</a> of Centrifugo PRO.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="why-providing-push-notifications-api">Why providing push notifications API<a href="#why-providing-push-notifications-api" class="hash-link" aria-label="Direct link to Why providing push notifications API" title="Direct link to Why providing push notifications API">​</a></h2>
<img src="/img/push_characters.jpg">
<p>Why provide a push notifications API at all? Well, actually, real-time messages and push notifications are so close that many developers hardly see the difference before starting to work with both more closely.</p>
<p>I’ve heard several stories where chat functionality on mobile devices was implemented using only native push notifications — without using a separate real-time transport like WebSocket while the app is in the foreground. While this is not a recommended approach due to the delivery properties of push notifications, it proves that real-time messages and push notifications are closely related concepts and sometimes may interchange with each other.</p>
<p>When developers introduce WebSocket communication in an application, they often ask the question—what should I do next to deliver some important messages to a user who is currently not actively using the application? WebSockets are great when the app is in the foreground, but when the app goes to the background, the recommended approach is to close the WebSocket connection. This is important to save battery, and operating systems force the closing of connections after some time anyway.</p>
<p>The delivery of important app data is then possible over push notifications. See a <a href="https://web.dev/articles/push-notifications-overview" target="_blank" rel="noopener noreferrer">good overview of them on web.dev</a>.</p>
<p>Previously, Centrifugo positioned itself solely as a transport layer for real-time messages. In our FAQ, we emphasized this fact and suggested using separate software products to send push notifications.</p>
<p>Now, with Centrifugo PRO, we provide this functionality to our customers. We have extended our server API with methods to manage and send push notifications. I promised to tell you why we believe our implementation is super cool. Let’s dive into the details.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="push-notifications-api-like-no-one-provides">Push notifications API like no one provides<a href="#push-notifications-api-like-no-one-provides" class="hash-link" aria-label="Direct link to Push notifications API like no one provides" title="Direct link to Push notifications API like no one provides">​</a></h2>
<p>Push notifications are super handy, but there’s a bit to do to get them working right. Let&#x27;s break it down!</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="on-the-users-side-frontend">On the user&#x27;s side (frontend)<a href="#on-the-users-side-frontend" class="hash-link" aria-label="Direct link to On the user&#x27;s side (frontend)" title="Direct link to On the user&#x27;s side (frontend)">​</a></h4>
<ul>
<li>Request permission from the user to receive push notifications.</li>
<li>Integrate with the platform-specific notification service (e.g., Apple Push Notification Service for iOS, Firebase Cloud Messaging for Android) to obtain the device token.</li>
<li>Send the device token to the server for storage and future use.</li>
<li>Integrate with the platform-specific notification handler to listen for incoming push notifications</li>
<li>Handle incoming push notifications: display the notification content to the user, either as a banner, alert, or in-app message, depending on the user&#x27;s preferences and the type of notification. Handle user actions on the notification, such as opening the app, dismissing the notification, or taking a specific action related to the notification content.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="on-the-server-backend">On the server (backend)<a href="#on-the-server-backend" class="hash-link" aria-label="Direct link to On the server (backend)" title="Direct link to On the server (backend)">​</a></h4>
<ul>
<li>Store device tokens in a database when received from the client side</li>
<li>Regularly clean up the database to remove stale or invalid device tokens. and handle scenarios where a device token becomes invalid or is revoked by the user, ensuring that no further notifications are sent to that device.</li>
<li>Integrate with platform-specific notification services (e.g., APNS, FCM) to send notifications to devices. Handle errors or failures in sending notifications and implement retry mechanisms if necessary.</li>
<li>Track the delivery status of each push notification sent out. Monitor the open rates, click-through rates, and other relevant metrics for the notifications.</li>
<li>Use analytics to understand user behavior in response to notifications and refine the notification strategy based on insights gained.</li>
</ul>
<p>We believe that we were able to achieve a unique combination of design decisions which allows us to provide push notification support like no one else provides. Let’s dive into what makes our approach special!</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="frontend-decisions">Frontend decisions<a href="#frontend-decisions" class="hash-link" aria-label="Direct link to Frontend decisions" title="Direct link to Frontend decisions">​</a></h2>
<p>When providing the push notification feature, other solutions like Pusher or Ably also offer their own SDKs for managing notifications on the client side.</p>
<p>What we&#x27;ve learned, though, during the Centrifugo life cycle, is that creating and maintaining client SDKs for various environments (iOS, Android, Web, Flutter) is one of the hardest parts of the Centrifugo project.</p>
<p>So the decision here was simple and natural: Centrifugo PRO does not introduce any client SDKs for push notifications on the client side.</p>
<p>When integrating with Centrifugo, you can simply use the native SDKs provided by each platform. We bypass the complexities of SDK development and concentrate on server-side improvements. With this decision, we are not introducing any limitations to the client side.</p>
<p>You get:</p>
<ul>
<li>Wealthy documentation and community support. Platforms like APNs provide comprehensive documentation, tutorials, and best practices, making the integration process smoother.</li>
<li>Stability and reliability: native SDKs are rigorously tested and frequently updated by the platform providers. This ensures that they are stable, reliable, and free from critical bugs.</li>
<li>Access to the latest features. As platform providers roll out new features or enhancements, native SDKs are usually the first to get updated. This ensures that your application can leverage the latest functionalities without waiting for SDKs to catch up.</li>
</ul>
<p>This approach was not possible with our real-time SDKs, as WebSocket communication is very low-level, and Centrifugo’s main goal was to provide some high-level features on top of it. However, with push notifications, proceeding without a custom SDK seems like a choice beneficial for everyone.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="server-implementation">Server implementation<a href="#server-implementation" class="hash-link" aria-label="Direct link to Server implementation" title="Direct link to Server implementation">​</a></h2>
<p>The main work we did was on the server side. Let&#x27;s go through the entire workflow of push notification delivery and describe what Centrifugo PRO provides for each step.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-we-keep-tokens">How we keep tokens<a href="#how-we-keep-tokens" class="hash-link" aria-label="Direct link to How we keep tokens" title="Direct link to How we keep tokens">​</a></h3>
<p>Let&#x27;s suppose you got the permission from the user and received the device push token. At this point you must save it to database for sending notifications later using this token. Centrifugo PRO provides API called <a href="/docs/pro/push_notifications#device_register">device_register</a> to do exactly this.</p>
<p>At this point, we use PostgreSQL for storing tokens – which is a very popular SQL database. Probably we will add more storage backend options in the future.</p>
<p>When calling Centrifugo <code>device_register</code> API you can provide user ID, list of topics to subscribe, platform from which the user came from (ios, android, web), also push notifications provider. To deliver push notifications to devices Centrifugo PRO integrates with the following push notification providers:</p>
<ul>
<li>fcm - <a href="https://firebase.google.com/docs/cloud-messaging" target="_blank" rel="noopener noreferrer">Firebase Cloud Messaging (FCM)</a> <i class="bi bi-android2" style="color:yellowgreen"></i> <i class="bi bi-apple" style="color:cornflowerblue"></i> <i class="bi bi-globe" style="color:orange"></i></li>
<li>hms - <a href="https://developer.huawei.com/consumer/en/hms/huawei-pushkit/" target="_blank" rel="noopener noreferrer">Huawei Messaging Service (HMS) Push Kit</a> <i class="bi bi-android2" style="color:yellowgreen"></i> <i class="bi bi-apple" style="color:cornflowerblue"></i> <i class="bi bi-globe" style="color:orange"></i></li>
<li>apns - <a href="https://developer.apple.com/documentation/usernotifications" target="_blank" rel="noopener noreferrer">Apple Push Notification service (APNs) </a> <i class="bi bi-apple" style="color:cornflowerblue"></i></li>
</ul>
<p><img decoding="async" loading="lazy" alt="Push" src="/assets/images/push_notifications-c1af39fb6bbb1da727bd940368acd4f8.png" width="2879" height="1195" class="img_ev3q"></p>
<p>So we basically cover all the most popular platforms out of the box.</p>
<p>After registering the device token, Centrifugo PRO returns a <code>device_id</code> to you. This device ID must be stored on the client device. As long as the frontend has this <code>device_id</code>, it can update the device&#x27;s push token information from time to time to keep it current (by just calling <code>device_register</code> again, but with <code>device_id</code> attached).</p>
<p>After saving the token, your backend can start sending push notifications to devices.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-we-send-notifications">How we send notifications<a href="#how-we-send-notifications" class="hash-link" aria-label="Direct link to How we send notifications" title="Direct link to How we send notifications">​</a></h3>
<p>To send push notifications we provide another API called <a href="/docs/pro/push_notifications#send_push_notification">send_push_notification</a>. You need to provide some filter in the API request to tell Centrifugo who you want to send notification. You also need to provide push notification payload. For example, using Centrifugo HTTP API:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -X POST http://localhost:8000/api/send_push_notification \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-H &quot;Authorization: apikey &lt;KEY&gt;&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-d @- &lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;recipient&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;filter&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;topics&quot;: [&quot;test&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;notification&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;fcm&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;message&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;notification&quot;: {&quot;title&quot;: &quot;Hello&quot;, &quot;body&quot;: &quot;How are you?&quot;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here is another important decision we made: Centrifugo PRO allows you to specify raw JSON objects for each provider we support. In other words, we do not wrap the push notifications API for FCM, APNS, HMS - we give you a way to construct the entire push notification message.</p>
<p>This means the Centrifugo push API supports all the fields of push notification payloads out-of-the-box, for all push providers. You can simply use the documentation of FCM, APNs, and send the constructed requests to Centrifugo. There is no need for us to update Centrifugo PRO in any way to support new fields added by providers to push APIs.</p>
<p>When you send a push notification with a filter and push payload for each provider you want, it&#x27;s queued by Centrifugo. We use Redis Streams for queuing and optionally a queue based on PostgreSQL (less efficient, but still robust enough).</p>
<p>The fact that the notification is being queued means a very fast response time – so you can integrate with Centrifugo from within the hot paths of your application backend. You may additionally provide a push expiration time and a unique push identifier. If you have not provided a unique identifier, Centrifugo generates one for you and returns it in the response. The unique identifier may later be used to track push status in Centrifugo PRO&#x27;s push notification analytics.</p>
<p>We then have efficient workers which process the queue with minimal latency and send push notifications using batch requests for each provider - i.e., we do this in the most effective way possible. We conducted a benchmark of our worker system with FCM – and we can easily send <strong>several million pushes per minute</strong>.</p>
<p>Another decision we made - Centrifugo PRO supports sending push notifications to a raw list of tokens. This makes it possible for our customers to use their own token storage. For example, such storage could already exist before you started using Centrifugo, or you might need a different storage/schema. In such cases, you can use Centrifugo just as an effective push sender server.</p>
<p>Finally, Centrifugo PRO supports sending delayed push notification - to queue push for a later delivery, so for example you can send notification based on user time zone and let Centrifugo PRO send it when needed. Or you may send slightly delayed push notification together with real-time message and if client provided an ack to real-time message - <a href="/docs/pro/push_notifications#cancel_push">cancel push notification</a>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="secure-unified-topics">Secure unified topics<a href="#secure-unified-topics" class="hash-link" aria-label="Direct link to Secure unified topics" title="Direct link to Secure unified topics">​</a></h3>
<p>FCM and HMS have a built-in way of sending notification to large groups of devices over topics mechanism (the same for HMS). One problem with native FCM or HMS topics though is that device can subscribe to any topic from the frontend side without any permission check. In today&#x27;s world this is usually not desired. So Centrifugo PRO re-implements FCM and HMS topics by introducing an additional API to manage device subscriptions to topics.</p>
<p>Centrifugo PRO device topic subscriptions also <strong>add a way to introduce the missing topic semantics for APNs</strong>.</p>
<p>Centrifugo PRO additionally provides an API to create persistent bindings of user to notification topics. See <a href="/docs/pro/push_notifications#user_topic_list">user_topic_list</a> and <a href="/docs/pro/push_notifications#user_topic_update">user_topic_update</a>. As soon as user registers a device – it will be automatically subscribed to its own topics pre-created over the API. As soon as user logs out from the app and you update user ID of the device - user topics binded to the device automatically removed/switched.</p>
<p>This design solves one of the issues with push notifications (with FCM in particular) – if two different users use the same device it&#x27;s becoming problematic to unsubscribe the device from large number of topics upon logout. Also, as soon as user to topic binding added (using <code>user_topic_update</code> API) – it will be synchronized across all user active devices. You can still manage such persistent subscriptions on the application backend side if you prefer and provide the full list inside <code>device_register</code> call - Centrifugo PRO API gives you freedom here.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="push-analytics">Push analytics<a href="#push-analytics" class="hash-link" aria-label="Direct link to Push analytics" title="Direct link to Push analytics">​</a></h3>
<p>Centrifugo PRO offers the ability to inspect sent push notifications using <a href="/docs/pro/analytics">ClickHouse analytics</a>. Push providers may also offer their own analytics, such as FCM, which provides insight into push notification delivery. Centrifugo PRO also offers a way to analyze push notification delivery and interaction using the <a href="/docs/pro/push_notifications#update_push_status">update_push_status</a> API. This API allows updating ClickHouse table and add status for each push sent:</p>
<ul>
<li><code>delivered</code></li>
<li>or <code>interacted</code></li>
</ul>
<p>It&#x27;s then possible to make queries to ClickHouse and build various analytical reports. Or use ClickHouse for real-time graphs - for example, from Grafana.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="push-notifications-ui">Push notifications UI<a href="#push-notifications-ui" class="hash-link" aria-label="Direct link to Push notifications UI" title="Direct link to Push notifications UI">​</a></h3>
<p>Finally, Centrifugo PRO provides a simple web UI for inspecting registered devices. It can simplify development, provide a way to look at live data, and send simple push notification alerts to users or topics.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/push_ui-01989161306e71d882a064b605395dcb.png" width="2728" height="1094" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>We really believe in our push notifications and will be working hard to make them even better. The API we already have serves well to cover common push notification delivery use cases, but we won&#x27;t stop here. Some areas for improvements are: functionality of built-in push notifications web UI, extending push analytics by providing user friendly UI for the insights about push delivery and engagement. The good thing is that we already have a ground for making this.</p>
<p>Take a look at the documentation of <a href="/docs/pro/push_notifications">Centrifugo PRO push notification API</a> for more formal details and some things not mentioned here. Probably at the time you are reading this we already added something great to the API.</p>
<p>Even though Centrifugo PRO is pretty new, it already has a lot of helpful features, and we have plans to add even more. You can see what’s coming up next on our <a href="https://github.com/orgs/centrifugal/projects/3/views/1" target="_blank" rel="noopener noreferrer">Centrifugo PRO planned features board</a>. We&#x27;re excited to share more blog posts like this one in the future.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/centrifugo">centrifugo</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/pro">pro</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/push-notifications">push notifications</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/centrifugal/centrifugal.dev/edit/main/blog/2023-10-29-discovering-centrifugo-pro-push-notifications.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2024/03/18/stream-loki-logs-to-browser-with-websocket-to-grpc-subscriptions"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Stream logs from Loki to browser with Centrifugo Websocket-to-GRPC subscriptions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2023/08/29/using-centrifugo-in-rabbitx"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Using Centrifugo in RabbitX</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#centrifugo-pro-goals" class="table-of-contents__link toc-highlight">Centrifugo PRO goals</a></li><li><a href="#why-providing-push-notifications-api" class="table-of-contents__link toc-highlight">Why providing push notifications API</a></li><li><a href="#push-notifications-api-like-no-one-provides" class="table-of-contents__link toc-highlight">Push notifications API like no one provides</a></li><li><a href="#frontend-decisions" class="table-of-contents__link toc-highlight">Frontend decisions</a></li><li><a href="#server-implementation" class="table-of-contents__link toc-highlight">Server implementation</a><ul><li><a href="#how-we-keep-tokens" class="table-of-contents__link toc-highlight">How we keep tokens</a></li><li><a href="#how-we-send-notifications" class="table-of-contents__link toc-highlight">How we send notifications</a></li><li><a href="#secure-unified-topics" class="table-of-contents__link toc-highlight">Secure unified topics</a></li><li><a href="#push-analytics" class="table-of-contents__link toc-highlight">Push analytics</a></li><li><a href="#push-notifications-ui" class="table-of-contents__link toc-highlight">Push notifications UI</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contacts</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/company">About us</a></li><li class="footer__item"><a href="mailto:hello@centrifugal.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Send e-mail</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/joinchat/U57MI8Lam9mhpuhd" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/tYgADKx" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/centrifugalabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/attributions">Attributions</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Centrifugal Labs LTD</div></div></div></footer></div>
</body>
</html>