"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[9475],{19050:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var i=n(85893),o=n(11151);const s={title:"Notable Centrifugo v5 milestones in 2024",tags:["centrifugo"],description:"While we concentrate our main efforts on Centrifugo v6 development, let's recap the most notable features and improvements introduced during Centrifugo v5 lifecycle.",author:"Centrifugal team",authorTitle:"\ud83d\udcbb\u2728\ud83d\udd2e\u2728\ud83d\udcbb",authorImageURL:"/img/logo_animated.svg",image:"/img/v5_milestones.jpg",hide_table_of_contents:!1},r=void 0,a={permalink:"/blog/2024/12/23/centrifugo-v5-milestones",editUrl:"https://github.com/centrifugal/centrifugal.dev/edit/main/blog/2024-12-23-centrifugo-v5-milestones.md",source:"@site/blog/2024-12-23-centrifugo-v5-milestones.md",title:"Notable Centrifugo v5 milestones in 2024",description:"While we concentrate our main efforts on Centrifugo v6 development, let's recap the most notable features and improvements introduced during Centrifugo v5 lifecycle.",date:"2024-12-23T00:00:00.000Z",tags:[{label:"centrifugo",permalink:"/blog/tags/centrifugo"}],readingTime:8.36,hasTruncateMarker:!0,authors:[{name:"Centrifugal team",title:"\ud83d\udcbb\u2728\ud83d\udd2e\u2728\ud83d\udcbb",imageURL:"/img/logo_animated.svg"}],frontMatter:{title:"Notable Centrifugo v5 milestones in 2024",tags:["centrifugo"],description:"While we concentrate our main efforts on Centrifugo v6 development, let's recap the most notable features and improvements introduced during Centrifugo v5 lifecycle.",author:"Centrifugal team",authorTitle:"\ud83d\udcbb\u2728\ud83d\udd2e\u2728\ud83d\udcbb",authorImageURL:"/img/logo_animated.svg",image:"/img/v5_milestones.jpg",hide_table_of_contents:!1},unlisted:!1,nextItem:{title:"Performance optimizations of WebSocket compression in Go application",permalink:"/blog/2024/08/19/optimizing-websocket-compression"}},c={authorsImageUrls:[void 0]},l=[{value:"Grand Tutorial \u2013 the most advanced WebSocket chat app tutorial",id:"grand-tutorial--the-most-advanced-websocket-chat-app-tutorial",level:2},{value:"Built-in asynchronous consumers",id:"built-in-asynchronous-consumers",level:2},{value:"Idempotency key for publish API",id:"idempotency-key-for-publish-api",level:2},{value:"gRPC Proxy Subscription Streams",id:"grpc-proxy-subscription-streams",level:2},{value:"Delta Compression in Channels",id:"delta-compression-in-channels",level:2},{value:"Cache recovery mode for channels",id:"cache-recovery-mode-for-channels",level:2},{value:"Expanded observability",id:"expanded-observability",level:2},{value:"Nats integration improvements",id:"nats-integration-improvements",level:2},{value:"Redis integration improvements",id:"redis-integration-improvements",level:2},{value:"Better SDKs",id:"better-sdks",level:2},{value:"Centrifugo PRO milestones",id:"centrifugo-pro-milestones",level:2},{value:"Compression improvements",id:"compression-improvements",level:3},{value:"Better observability",id:"better-observability",level:3},{value:"New features for push notifications",id:"new-features-for-push-notifications",level:3},{value:"Channel state events preview",id:"channel-state-events-preview",level:3},{value:"SSO for admin UI",id:"sso-for-admin-ui",level:3},{value:"Centrifugo v6 is coming",id:"centrifugo-v6-is-coming",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("img",{src:"/img/v5_milestones.jpg"}),"\n",(0,i.jsx)(t.p,{children:"While we concentrate our main efforts on Centrifugo v6 development, let's recap the most notable features and improvements introduced during Centrifugo v5 lifecycle."}),"\n",(0,i.jsx)(t.p,{children:"We are excited about how many things done in 2024 we can be proud of. Also, we are grateful to our community for the feedback, support and love towards the project we see."}),"\n",(0,i.jsx)(t.p,{children:"Let's start remembering what had happened with the project over the year."}),"\n",(0,i.jsx)(t.h2,{id:"grand-tutorial--the-most-advanced-websocket-chat-app-tutorial",children:"Grand Tutorial \u2013 the most advanced WebSocket chat app tutorial"}),"\n",(0,i.jsxs)(t.p,{children:["We launched the ",(0,i.jsx)(t.a,{href:"/docs/tutorial/intro",children:(0,i.jsx)(t.strong,{children:"Grand Tutorial"})}),", an official step-by-step guide how to build a complex real-time application with Centrifugo. This comprehensive tutorial walks developers through the entire process, implementing client side, server side and Centrifugo integration. Moreover, it gives answers to robust message delivery and provides performance estimation you can expect to achieve with Centrifugo."]}),"\n",(0,i.jsx)("video",{width:"100%",loop:!0,muted:!0,controls:!0,src:"/img/grand-chat-tutorial-demo.mp4"}),"\n",(0,i.jsx)(t.h2,{id:"built-in-asynchronous-consumers",children:"Built-in asynchronous consumers"}),"\n",(0,i.jsx)(t.p,{children:"While working on the Grand Chat Tutorial, we realized that Centrifugo could natively consume external queues to simplify integration with the existing backends. Thus, at some point of v5 life cycle built-in asynchronous consumers were introduced. At this point we have two types of them:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/docs/server/consumers#postgresql-outbox-consumer",children:"PostgreSQL Outbox Table"}),". Enables seamless integration with transactional outbox pattern for reliable  messaging. Save your model and emit event to Centrifugo in one transaction."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/docs/server/consumers#kafka-consumer",children:"Kafka Topics"}),". Native Kafka topic consumption makes Centrifugo even more versatile for real-time event streaming."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["You can find examples how both can be used in ",(0,i.jsx)(t.a,{href:"/docs/tutorial/outbox_cdc",children:"Broadcast using transactional outbox and CDC"})," chapter of the tutorial."]}),"\n",(0,i.jsx)(t.p,{children:"In v6 we continue improving asynchronous consumers and adding a new mode for Kafka consumer \u2013 more details very soon! During v6 life cycle we can add more built-in integrations with popular queue systems."}),"\n",(0,i.jsx)(t.h2,{id:"idempotency-key-for-publish-api",children:"Idempotency key for publish API"}),"\n",(0,i.jsxs)(t.p,{children:["The addition of ",(0,i.jsx)(t.code,{children:"idempotency_key"})," in publish and broadcast ",(0,i.jsx)(t.a,{href:"/docs/server/server_api#api-methods",children:"server API methods"})," provides an effective way to prevent duplicate messages and ensure consistency in a distributed system as it gives a way to safely make publication retries upon network failures."]}),"\n",(0,i.jsx)(t.h2,{id:"grpc-proxy-subscription-streams",children:"gRPC Proxy Subscription Streams"}),"\n",(0,i.jsxs)(t.p,{children:["Centrifugo v5.1.0 introduced an experimental support for ",(0,i.jsx)(t.a,{href:"/docs/server/proxy_streams",children:"gRPC proxy subscription streams"}),". This feature allows developers to send individual stream of events to the client using gRPC-streaming based proxies (bidirectional or unidirectional), providing a way to integrate with third-party existing streams using GRPC streaming between Centrifugo and backend."]}),"\n",(0,i.jsx)(t.p,{children:"Technically, this is quite an interesting concept \u2013 Centrifugo can multiplex different streams within a single WebSocket connection (or any other supported transport like SSE or HTTP-streaming), and the communication between Centrifugo and the backend is multiplexed within a single HTTP/2 connection (used by GRPC internally)."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:n(76983).Z+"",width:"3242",height:"1065"})}),"\n",(0,i.jsxs)(t.p,{children:["This feature makes it possible to integrate with external streams in munutes. If you've ever heard about ",(0,i.jsx)(t.a,{href:"http://websocketd.com/",children:"WebSocketd"})," \u2013 then the idea is very similar, but over the network! With multiplexing, authentication, authorization, scalabilty Centrifugo features coming with the concept out-of-the-box."]}),"\n",(0,i.jsxs)(t.p,{children:["See also ",(0,i.jsx)(t.a,{href:"/blog/2024/03/18/stream-loki-logs-to-browser-with-websocket-to-grpc-subscriptions",children:"Stream logs from Loki to browser with Centrifugo Websocket-to-GRPC subscriptions"})," relevant blog post."]}),"\n",(0,i.jsx)(t.h2,{id:"delta-compression-in-channels",children:"Delta Compression in Channels"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"/docs/server/delta_compression",children:"Delta compression"})," based on Fossil algorithm was introduced to minimize data transfer overhead in channels, optimizing performance and bandwidth usage during real-time message delivery. The feature is quite unique for self-hosted real-time messaging systems. And we'd like to note that now we not only support delta compression in JavaScript SDK, but recently the community contributed support for it to our Java and Python SDKs. And there is an ongoing PR to Swift SDK."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"delta frames",src:n(85259).Z+"",width:"4002",height:"902"})}),"\n",(0,i.jsxs)(t.p,{children:["See example where delta compression can be very beneficial in ",(0,i.jsx)(t.a,{href:"/blog/2024/05/30/real-time-data-compression-experiments",children:"Experimenting with real-time data compression by simulating a football match events\n"})," blog post."]}),"\n",(0,i.jsx)(t.h2,{id:"cache-recovery-mode-for-channels",children:"Cache recovery mode for channels"}),"\n",(0,i.jsxs)(t.p,{children:["The new ",(0,i.jsx)(t.a,{href:"/docs/server/cache_recovery",children:"cache recovery mode"})," in Centrifugo transforms channels into real-time caches by delivering only the most recent message upon resubscription. This feature has proven highly effective for ",(0,i.jsx)(t.a,{href:"https://www.azuracast.com/docs/developers/now-playing-data/#high-performance-updates",children:'AzuraCast\'s "Now Playing"'})," functionality, ensuring effective updates for users. With Centrifugo\u2019s cache recovery mode, the system now operates more efficiently, significantly reducing the load on the backend."]}),"\n",(0,i.jsx)(t.h2,{id:"expanded-observability",children:"Expanded observability"}),"\n",(0,i.jsx)(t.p,{children:"Several new metrics were added to provide deeper insights into Centrifugo operations. A couple of examples:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"centrifugo_node_pub_sub_lag_seconds"}),": tracks lag in pub/sub processing \u2013 may be very important for server monitoring."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"centrifugo_client_ping_pong_duration_seconds"}),": measures client latency distribution on top of existing ping-pong mechanism with transport type resolution."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Metrics would be one of the main focuses of Centrifugo v6, so we will continue working hard on better observability of Centrifugo."}),"\n",(0,i.jsx)(t.h2,{id:"nats-integration-improvements",children:"Nats integration improvements"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"/docs/server/engines#nats-raw-mode",children:"Raw mode"}),". Offers a way to consume existing Nats topics with 1-to-1 matching to Centrifugo channels"]}),"\n",(0,i.jsxs)(t.li,{children:["It's now possible to have ",(0,i.jsx)(t.a,{href:"/docs/server/engines#nats_allow_wildcards",children:"wildcard subscriptions"})," with Nats \u2013 i.e. a way to consume from many channels having only one subscription."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The useful addition in Centrifugo PRO was a possibility to use ",(0,i.jsx)(t.a,{href:"/docs/pro/namespace_engines",children:"per-namespace brokers and presence managers"}),". So it's possible to use wildcard subscriptions with Nats in one channel namespace, and benefit from Redis broker features (presence, history cache and automatic recovery) in other channel namespaces."]}),"\n",(0,i.jsx)(t.h2,{id:"redis-integration-improvements",children:"Redis integration improvements"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://redis.io/blog/announcing-redis-community-edition-and-redis-stack-74/#:~:text=You%20can%20now%20set%20an%20expiration%20for%20hash%20fields.",children:"Redis 7.4 added possibility"})," to set per field TTL in HASH data structure. We ",(0,i.jsx)(t.a,{href:"/docs/server/engines#redis_presence_hash_field_ttl",children:"utilized this"})," for Centrifugo presence to handle online presence more efficiently and reducing the overhead of presence requests."]}),"\n",(0,i.jsxs)(t.li,{children:["Global Redis Presence User Mapping. We've ",(0,i.jsx)(t.a,{href:"/docs/server/engines#optimize-getting-presence-stats",children:"provided an option"})," to drastically improve ",(0,i.jsx)(t.code,{children:"presence_stats"})," performance for channels with a large number of active subscribers, making Redis-backed deployments more efficient."]}),"\n",(0,i.jsxs)(t.li,{children:["Centrifugo works gracefully with Redis eviction algorithms now. It degrades in a way that clients lose their positions in channel streams, but they can ",(0,i.jsx)(t.a,{href:"/docs/server/history_and_recovery#automatic-message-recovery",children:"recover in idiomatic way"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"better-sdks",children:"Better SDKs"}),"\n",(0,i.jsx)(t.p,{children:"Several improvements were made in client SDKs. Among others, we'd like to highlight the following:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["some important connection stability and correctness improvements in Javascript SDK, for example ",(0,i.jsx)(t.a,{href:"https://github.com/centrifugal/centrifuge-js/pull/281",children:"this one"})," where we fixed ",(0,i.jsx)(t.code,{children:"WebSocket is closed before the connection is established"})," error preventing reconnect after long offline period, or ",(0,i.jsx)(t.a,{href:"https://github.com/centrifugal/centrifuge-js/pull/278",children:"this one"})," where we worked on the correctness of quick subscribe/unsubscribe scenarios."]}),"\n",(0,i.jsxs)(t.li,{children:["at some point we brought back to life our ",(0,i.jsx)(t.a,{href:"https://github.com/centrifugal/centrifuge-python",children:"Python realtime SDK"}),". For many years we did not have enough resources to do this, but now we are happy to see it alive again."]}),"\n",(0,i.jsxs)(t.li,{children:["delta compression support in Javascript SDK. And later the support for it was added in Java and Python SDKs, and that ",(0,i.jsx)(t.a,{href:"https://github.com/centrifugal/centrifuge-java/pull/74",children:"was contributed"})," by Centrifugal community members which is simply great."]}),"\n",(0,i.jsxs)(t.li,{children:["a method to ",(0,i.jsx)(t.a,{href:"https://github.com/centrifugal/centrifuge-swift/issues/106",children:"reset reconnecting state"})," in Swift SDK, which can be expanded to other SDKs in the future. Previously, we only had similar functionality in Javascript SDK where browser online/offline notifications are available."]}),"\n",(0,i.jsxs)(t.li,{children:["we now have a high-quality alternative to our official Dart/Flutter SDK \u2013 see ",(0,i.jsx)(t.a,{href:"https://github.com/PlugFox/spinify",children:"https://github.com/PlugFox/spinify"})," made by ",(0,i.jsx)(t.a,{href:"https://github.com/PlugFox",children:"PlugFox"}),". An alternative may provide more idiomatic API for Dart developers, more performance and customization."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"centrifugo-pro-milestones",children:"Centrifugo PRO milestones"}),"\n",(0,i.jsxs)(t.p,{children:["In v5 release post we ",(0,i.jsx)(t.a,{href:"/blog/2023/06/29/centrifugo-v5-released#introducing-centrifugal-labs-ltd",children:"introduced Centrifugal Labs"})," \u2013 a company around Centrifugo PRO product, the enhanced version of Centrifugo. It was operational since then. During the year we found new PRO customers, and generally passed very important milestones as a company."]}),"\n",(0,i.jsx)(t.p,{children:"The most important for this post is that we continued to improve Centrifugo PRO with new features. Let's recap!"}),"\n",(0,i.jsx)(t.h3,{id:"compression-improvements",children:"Compression improvements"}),"\n",(0,i.jsxs)(t.p,{children:["The first thing to mention regarding Centrifugo PRO is compression performance optimizations. We introduced the cache for prepared WebSocket messages to reduce CPU usage and improve compression ratio. This feature ",(0,i.jsx)(t.a,{href:"/blog/2024/08/19/optimizing-websocket-compression",children:"was very helpful for our customers"})," who have a lot of data to send over WebSocket connections. Also, ",(0,i.jsx)(t.a,{href:"/docs/pro/delta_at_most_once",children:"delta compression for channels with at most once delivery guarantees"})," is available for Centrifugo PRO users."]}),"\n",(0,i.jsx)(t.h3,{id:"better-observability",children:"Better observability"}),"\n",(0,i.jsxs)(t.p,{children:["We believe that PRO version should provide an ",(0,i.jsx)(t.a,{href:"/docs/pro/observability_enhancements",children:"enhanced observability"})," as when the business grows it's crucial to have a deep insight into the system. One notable feature is namespace segmentation for in/out message size metrics. This allows identifying namespaces which consume a lot of bandwidth. In Centrifugo v6 we will make a step forward here, stay tuned!"]}),"\n",(0,i.jsx)(t.h3,{id:"new-features-for-push-notifications",children:"New features for push notifications"}),"\n",(0,i.jsxs)(t.p,{children:["One of the most attractive features of Centrifugo PRO is ",(0,i.jsx)(t.a,{href:"/docs/pro/push_notifications",children:"push notifications"})," support. During the year several notable improvements were made regarding it. Let's recap."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"/docs/pro/push_notifications#timezone-aware-push",children:"Timezone-aware push notifications"})," \u2013 Centrifugo PRO can now send push notifications based on device timezone. Or ",(0,i.jsx)(t.a,{href:"/docs/pro/push_notifications#templating",children:"notification templating"})," - allows using variables and substitute them to values based on particular device metadata. Also, ",(0,i.jsx)(t.a,{href:"/docs/pro/push_notifications#localizations",children:"notification localizations"})," - for providing translations of push content based on particular device locale. Next, ",(0,i.jsx)(t.a,{href:"/docs/pro/push_notifications#push-rate-limits",children:"per user device rate limiting"})," - lets app developers be more careful about the number and rate of push notifications on per user device basis."]}),"\n",(0,i.jsx)(t.p,{children:"And finally, better scalability of push notification device/topic storage by using reads from PostgreSQL replicas."}),"\n",(0,i.jsx)(t.h3,{id:"channel-state-events-preview",children:"Channel state events preview"}),"\n",(0,i.jsxs)(t.p,{children:["We published a ",(0,i.jsx)(t.a,{href:"/docs/pro/channel_state_events",children:"Channel state events"})," feature preview \u2013 to be notified about channel occupied and channel vacated events on the app backend. Note that we do not recommend this feature for production usage yet. While it may seem simple - the implementation is quite complex under the hood, because we try to solve important issues like event ordering, avoiding event race conditions, making sure we survive Centrifugo node restarts, scalability with Redis Cluster. This all requires a careful approach, so we want to step-by-step improve the feature based on the customer feedback. In Centrifugo v6, we make a little step forward with channel state events, will share more details very soon."]}),"\n",(0,i.jsx)(t.h3,{id:"sso-for-admin-ui",children:"SSO for admin UI"}),"\n",(0,i.jsxs)(t.p,{children:["We added ",(0,i.jsx)(t.a,{href:"/docs/pro/admin_idp_auth",children:"SSO for admin UI"})," using OpenID connect (OIDC)protocol, this is a very natural feature to have for corporate users who want to use their existing identity provider to authenticate in Centrifugo admin UI instead of custom password management."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:n(59761).Z+"",width:"1972",height:"1012"})}),"\n",(0,i.jsx)(t.h2,{id:"centrifugo-v6-is-coming",children:"Centrifugo v6 is coming"}),"\n",(0,i.jsx)(t.p,{children:"There were more improvements and features introduced during Centrifugo v5 lifecycle, here we tried to highlight the most notable ones. This year was quite productive for the project, and we hope your work was more productive due to the help of Centrifugo."}),"\n",(0,i.jsx)(t.p,{children:"We are looking forward to the upcoming year and the release of Centrifugo v6 very soon. Stay tuned for the upcoming announcement where we will introduce the new features and improvements of the new major release."}),"\n",(0,i.jsx)(t.p,{children:"Merry Christmas and Happy New Year everyone! \ud83c\udf84"})]})}function h(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},59761:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/admin_idp_auth-92fc159f4d015d269d1666453dbee5e3.png"},85259:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/delta_abstract-9104c3b2e3b81831daecf3b400e0d798.png"},76983:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/on_demand_stream_connections-7cc823b5765cd558dba320f7f7bfa439.png"},11151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>r});var i=n(67294);const o={},s=i.createContext(o);function r(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);