"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[9175],{99047:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var t=i(85893),s=i(11151);const o={id:"push_notifications",sidebar_label:"Appx #4: Adding push notifications",title:"Appendix #4: Adding push notifications"},r=void 0,a={id:"tutorial/push_notifications",title:"Appendix #4: Adding push notifications",description:"This chapter is under construction.",source:"@site/docs/tutorial/push_notifications.md",sourceDirName:"tutorial",slug:"/tutorial/push_notifications",permalink:"/docs/tutorial/push_notifications",draft:!1,unlisted:!1,editUrl:"https://github.com/centrifugal/centrifugal.dev/edit/main/docs/tutorial/push_notifications.md",tags:[],version:"current",frontMatter:{id:"push_notifications",sidebar_label:"Appx #4: Adding push notifications",title:"Appendix #4: Adding push notifications"},sidebar:"Tutorial",previous:{title:"Appx #3: Prometheus and Grafana",permalink:"/docs/tutorial/monitoring"}},c={},d=[{value:"Use Centrifugo PRO image",id:"use-centrifugo-pro-image",level:3},{value:"Update Centrifugo configuration",id:"update-centrifugo-configuration",level:3},{value:"Register project in Firebase",id:"register-project-in-firebase",level:3},{value:"Get the public VAPID key",id:"get-the-public-vapid-key",level:3},{value:"Get Firebase web config",id:"get-firebase-web-config",level:3},{value:"Designing topics",id:"designing-topics",level:3},{value:"Send push notifications",id:"send-push-notifications",level:3},{value:"Frontend integration",id:"frontend-integration",level:3},{value:"Service Worker for background pushes",id:"service-worker-for-background-pushes",level:3},{value:"Conclusion",id:"conclusion",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.admonition,{title:"Under construction \ud83d\udea7",type:"info",children:[(0,t.jsx)(n.p,{children:"This chapter is under construction."}),(0,t.jsx)(n.p,{children:"The tutorial source code already has working implementation for push notifications, but may have some polishing. To enable push notifications some adjustments to the tutorial source code should be made. These adjustments are mentioned in this tutorial and listed in the tutorial source code in comment for PUSH_NOTIFICATIONS_ENABLED option in backend/app/settings.py."})]}),"\n",(0,t.jsx)(n.p,{children:"At this point our messenger app effectively works in real-time \u2013 new messages are delivered to online users over WebSocket, initial data is loaded from the main application database, and sometimes Centrifugo publication history helps to recover after temporary disconnections. But there is one more feature we can add to the app more engaging - push notifications."}),"\n",(0,t.jsx)(n.p,{children:"In this appendix, we\u2019ll demonstrate how to integrate Web Push Notifications into the Grand Chat application. Push notifications allow users to receive alerts about new messages even when the application is not open in their browser. This feature helps keep users engaged and informed about important updates."}),"\n",(0,t.jsxs)(n.p,{children:["We'll leverage the ",(0,t.jsx)(n.a,{href:"/docs/pro/push_notifications",children:"Push Notification API of Centrifugo PRO"}),", specifically its integration with Firebase Cloud Messaging (FCM). In general, Centrifugo PRO is not the only choice here \u2013 it's possible to use any other third-party push notification service or your own."]}),"\n",(0,t.jsx)(n.p,{children:"Below is a demonstration of the final result. In this demo notifications are delivered to Chrome (on the left) and Firefox (on the right), and clicking a notification directs users to the chat room:"}),"\n",(0,t.jsx)("video",{width:"100%",loop:!0,autoPlay:"autoplay",muted:!0,controls:!0,src:"/img/grand-chat-tutorial-demo-push.mp4"}),"\n",(0,t.jsx)(n.p,{children:"When a user logs out, their token is unregistered from the push notification service, ensuring they no longer receive notifications."}),"\n",(0,t.jsx)(n.h3,{id:"use-centrifugo-pro-image",children:"Use Centrifugo PRO image"}),"\n",(0,t.jsxs)(n.p,{children:["Push notifications API is available in Centrifugo PRO only. Centrifugo PRO uses a separate docker image. In ",(0,t.jsx)(n.code,{children:"docker-compose.yml"})," file change Centrifugo image to PRO version:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"  centrifugo:\n    image: centrifugo/centrifugo-pro:v6\n    ...\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": Centrifugo PRO offers a sandbox mode for experimentation without a license key"]}),"\n",(0,t.jsxs)(n.li,{children:["For production, a valid license key is required, ",(0,t.jsx)(n.a,{href:"/docs/pro/overview#pricing",children:"see pricing section"})]}),"\n",(0,t.jsxs)(n.li,{children:["By downloading Centrifugo PRO, you agree to the ",(0,t.jsx)(n.a,{href:"/license",children:"license agreement"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"update-centrifugo-configuration",children:"Update Centrifugo configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="centrifugo/config.json"',children:'{\n  "database": {\n    "enabled": true,\n    "postgresql": {\n      "dsn": "postgresql://grandchat:grandchat@db:5432/grandchat"\n    }\n  },\n  "push_notifications": {\n    "enabled": true,\n    "queue": {\n      "redis": {\n        "address": "redis:6379"\n      }\n    },\n    "enabled_providers": [\n      "fcm"\n    ],\n    "fcm": {\n      "credentials_file": "fcm.json"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Key Points:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Enable ",(0,t.jsx)(n.code,{children:"database"}),": Required for storing device tokens and topics."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"push_notifications"}),": Enable push notifications and fcm as the provider. Use Redis for notification queue engine. Provide Centrifugo path to the ",(0,t.jsx)(n.code,{children:"fcm.json"})," file, which you\u2019ll get from Firebase."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"register-project-in-firebase",children:"Register project in Firebase"}),"\n",(0,t.jsx)(n.p,{children:"To use FCM the first step would be registering your project in Firebase console. You can find a nice instruction how to do this by following this URL:"}),"\n",(0,t.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,t.jsx)(n.a,{href:"https://github.com/Catapush/catapush-docs/blob/master/AndroidSDK/DOCUMENTATION_PLATFORM_GMS_FCM.md",children:"Firebase Registration Guide"})]}),"\n",(0,t.jsxs)(n.p,{children:["After registration, download the ",(0,t.jsx)(n.code,{children:"fcm.json"})," credentials file and place it in your ",(0,t.jsx)(n.code,{children:"centrifugo"})," folder (near ",(0,t.jsx)(n.code,{children:"config.json"})," file). In Centrifugo configuration above ",(0,t.jsx)(n.code,{children:"push_notifications.fcm.credentials_file"})," is exactly this file."]}),"\n",(0,t.jsx)(n.h3,{id:"get-the-public-vapid-key",children:"Get the public VAPID key"}),"\n",(0,t.jsx)(n.p,{children:"For Web push notifications you also need to get the public VAPID key."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Find it in the Firebase Console under your project settings."}),"\n",(0,t.jsxs)(n.li,{children:["Follow this ",(0,t.jsx)(n.a,{href:"https://stackoverflow.com/questions/54996206/firebase-cloud-messaging-where-to-find-public-vapid-key",children:"Stack Overflow guide"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"get-firebase-web-config",children:"Get Firebase web config"}),"\n",(0,t.jsx)(n.p,{children:"You also need to get Firebase web config. This is a JavaScript object with Firebase configuration. You can get it in Firebase console in the settings of your project."}),"\n",(0,t.jsx)(n.p,{children:"It's required to initialize Firebase messaging in the frontend app and to register a Service Worker to handle push notifications while app is closed."}),"\n",(0,t.jsx)(n.h3,{id:"designing-topics",children:"Designing topics"}),"\n",(0,t.jsx)(n.p,{children:"For the Grand Chat tutorial we will subscribe users to push notification topics corresponding to chat rooms. When a user sends a message to a chat room we will send a push notification to all users subscribed to this chat room topic."}),"\n",(0,t.jsx)(n.p,{children:"Once user clicks join button in the chat room we will subscribe user to the topic corresponding to this chat room. When user leaves the chat room we will unsubscribe user from this topic. To do this we can use Centrifugo API to manage user subscriptions to topics."}),"\n",(0,t.jsx)(n.p,{children:"To manage subscriptions to topics reliably we can use CDC approach introduced in the previous tutorial chapters:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/chat/views.py"',children:"def update_user_room_topic(self, user_id, room_id, op):\n    if not settings.PUSH_NOTIFICATIONS_ENABLED:\n        return\n    if 'cdc' not in settings.CENTRIFUGO_BROADCAST_MODE:\n        return\n    partition = hash(room_id)\n    CDC.objects.create(method='user_topic_update', payload={\n        'user': str(user_id),\n        'topics': ['chat:messages:' + str(room_id)],\n        'op': op\n    }, partition=partition)\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then once user joins room we can call:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/chat/views.py"',children:"self.update_user_room_topic(request.user.pk, room_id, 'add')\n"})}),"\n",(0,t.jsx)(n.p,{children:"Once user leaves room we can call:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/chat/views.py"',children:"self.update_user_room_topic(request.user.pk, room_id, 'remove')\n"})}),"\n",(0,t.jsx)(n.p,{children:"This way we will get the proper mapping of users to push topics in Centrifugo database."}),"\n",(0,t.jsx)(n.p,{children:"We also need to add some options to the backend:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/app/settings.py"',children:"PUSH_NOTIFICATIONS_ENABLED = False\nPUSH_NOTIFICATIONS_VAPID_PUBLIC_KEY = 'YOUR_VAPID_PUBLIC_KEY'\nPUSH_NOTIFICATIONS_FIREBASE_CONFIG = {...YOUR FIREBASE CONFIG}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Add the following to ",(0,t.jsx)(n.code,{children:"backend/app/urls.py"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/app/urls.py"',children:"path('api/device/register/', views.device_register_view, name='api-device-register'),\n"})}),"\n",(0,t.jsx)(n.p,{children:"Implement device registering view:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/app/views.py"',children:"@require_POST\ndef device_register_view(request):\n    if not request.user.is_authenticated:\n        return JsonResponse({'detail': 'must be authenticated'}, status=403)\n\n    device_info = json.loads(request.body).get('device')\n    if not device_info:\n        return JsonResponse({'detail': 'device not found'}, status=400)\n\n    # Attach user ID to device info.\n    device_info[\"user\"] = str(request.user.pk)\n\n    session = requests.Session()\n    try:\n        resp = session.post(\n            settings.CENTRIFUGO_HTTP_API_ENDPOINT + '/api/device_register',\n            data=json.dumps(device_info),\n            headers={\n                'Content-type': 'application/json',\n                'X-API-Key': settings.CENTRIFUGO_HTTP_API_KEY,\n                'X-Centrifugo-Error-Mode': 'transport'\n            }\n        )\n    except requests.exceptions.RequestException as e:\n        logging.error(e)\n        return JsonResponse({'detail': 'failed to register device'}, status=500)\n\n    if resp.status_code != 200:\n        logging.error(resp.json())\n        return JsonResponse({'detail': 'failed to register device'}, status=500)\n\n    return JsonResponse({\n        'device_id': resp.json().get('result', {}).get('id')\n    })\n"})}),"\n",(0,t.jsxs)(n.p,{children:["And implement passing additional settings in the login response (in ",(0,t.jsx)(n.code,{children:"backend/app/views.py"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/app/views.py"',children:"def login_view(request):\n    ...\n    return JsonResponse({\n        'id': user.pk,\n        'username': user.username,\n        'settings': {\n            'push_notifications': {\n                'enabled': settings.PUSH_NOTIFICATIONS_ENABLED,\n                'vapid_public_key': settings.PUSH_NOTIFICATIONS_VAPID_PUBLIC_KEY,\n                'firebase_config': settings.PUSH_NOTIFICATIONS_FIREBASE_CONFIG,\n            }\n        }\n    })\n"})}),"\n",(0,t.jsx)(n.p,{children:"Also extend logout view:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/app/views.py"',children:"@require_POST\ndef logout_view(request):\n    ...\n    \n    device_ids = []\n    device_id = json.loads(request.body).get('device_id', '')\n    if device_id:\n        device_ids = [device_id]\n\n    session = requests.Session()\n    try:\n        resp = session.post(\n            settings.CENTRIFUGO_HTTP_API_ENDPOINT + '/api/device_remove',\n            data=json.dumps({\n                'users': [str(request.user.pk)],\n                'ids': device_ids\n            }),\n            headers={\n                'Content-type': 'application/json',\n                'X-API-Key': settings.CENTRIFUGO_HTTP_API_KEY,\n                'X-Centrifugo-Error-Mode': 'transport'\n            }\n        )\n    except requests.exceptions.RequestException as e:\n        logging.error(e)\n        return JsonResponse({'detail': 'failed to register device'}, status=500)\n    \n    ...\n"})}),"\n",(0,t.jsx)(n.p,{children:"So that we can unregister device token from Centrifugo PRO device storage when user logs out."}),"\n",(0,t.jsx)(n.h3,{id:"send-push-notifications",children:"Send push notifications"}),"\n",(0,t.jsxs)(n.p,{children:["Once a new message is sent to a chat room we can send a push notification to all users subscribed to this chat room topic. To do this we can use ",(0,t.jsx)(n.code,{children:"send_push_notification"})," method of Centrifugo API:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:'title="backend/chat/views.py"',children:'partition = hash(room_id)\npayload = {\n    "recipient": {\n        "filter": {\n            "topics": [f\'chat:messages:{room_id}\']\n        }\n    },\n    "notification": {\n        "fcm": {\n            "message": {\n                "notification": {\n                    "title": room_name,\n                    "body": broadcast_payload.get(\'data\', {}).get(\'body\', {}).get(\'content\', \'\')\n                },\n                "webpush": {\n                  "fcm_options": {\n                    "link": f\'http://localhost:9000/rooms/{room_id}\'\n                  }\n                }\n            }\n        }\n    }\n}\nCDC.objects.create(method=\'send_push_notification\', payload=payload, partition=partition)\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Note, here we send push to all subscribers of ",(0,t.jsx)(n.code,{children:"chat:messages:{room_id}"})," topic \u2013 and Centrifugo PRO will do the rest iterating over all registered devices which have users subscribed to the topic and send push to them."]}),"\n",(0,t.jsx)(n.p,{children:"But we don't have any devices saved yet \u2013 to do this we need to update frontend to request permission for push notifications and register device token in Centrifugo PRO device storage. Let's do that."}),"\n",(0,t.jsx)(n.h3,{id:"frontend-integration",children:"Frontend integration"}),"\n",(0,t.jsx)(n.p,{children:"In the frontend we need to add code to request permission for push notifications and register device token in Centrifugo. We also need to register service worker to handle push notifications while the app is not opened."}),"\n",(0,t.jsxs)(n.p,{children:["To request permissions for push notifications we should first add ",(0,t.jsx)(n.code,{children:"firebase"})," SDK to ",(0,t.jsx)(n.code,{children:"package.json"}),". Then let's create a module to work with FCM tokens:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",metastring:'title="frontend/src/PushNotification.tsx"',children:"import { getMessaging, getToken, onMessage, deleteToken } from 'firebase/messaging';\nimport { initializeApp } from 'firebase/app';\n\nlet messaging;\n\nexport const initializeFirebase = (firebaseConfig: any) => {\n    if (!messaging) {\n        if (navigator.serviceWorker === undefined) {\n            return\n        }\n        const app = initializeApp(firebaseConfig);\n        messaging = getMessaging(app);\n    }\n};\n\nexport const requestNotificationToken = async (firebaseConfig: any, vapidKey: string): Promise<string | null> => {\n    try {\n        const permission = await Notification.requestPermission();\n        if (permission !== 'granted') {\n            return null;\n        }\n\n        if ('serviceWorker' in navigator) {\n            if (navigator.serviceWorker === undefined) {\n                return null;\n            }\n            try {\n                const registration = await navigator.serviceWorker.register('/firebase-messaging-sw.js');\n            } catch (err) {\n                return null;\n            }\n        } else {\n            return null;\n        }\n        const token = await getToken(messaging, {\n            vapidKey: vapidKey,\n        });\n        return token;\n    } catch (error) {\n        return null;\n    }\n};\n\nexport const onForegroundNotification = (callback) => {\n    if (messaging) {\n        onMessage(messaging, callback);\n    }\n};\n\nexport const removeNotificationToken = async () => {\n    if (messaging) {\n        await deleteToken(messaging);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Once user logs into app \u2013 we ask for push notification permission and extract FCM token:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",metastring:'title="frontend/src/App.tsx"',children:"  useEffect(() => {\n    if (!authenticated || !csrf) return;\n    if (!userInfo.settings || !userInfo.settings.push_notifications || !userInfo.settings.push_notifications.enabled) {\n        return;\n    }\n    const setupNotifications = async () => {\n        initializeFirebase(userInfo.settings.push_notifications.firebase_config);\n        const token = await requestNotificationToken(userInfo.settings.push_notifications.firebase_config, userInfo.settings.push_notifications.vapid_public_key);\n\n        if (token) {\n            const deviceInfo = {\n                provider: 'fcm',\n                token: token,\n                platform: 'web',\n                meta: { 'user-agent': navigator.userAgent },\n                tags: {\n                    tz: Intl.DateTimeFormat().resolvedOptions().timeZone,\n                },\n            };\n            if (localStorage.getItem(LOCAL_STORAGE_DEVICE_ID_KEY)) {\n                deviceInfo['device_id'] = localStorage.getItem(LOCAL_STORAGE_DEVICE_ID_KEY);\n            }\n            try {\n                const response = await registerDevice(csrf, deviceInfo);\n                console.log('Token sent to server:', response);\n                const deviceId = response.device_id;\n                localStorage.setItem(LOCAL_STORAGE_DEVICE_ID_KEY, deviceId);\n                onForegroundNotification((payload) => {\n                    console.log('Message received in foreground:', payload);\n                    // We are ignoring foreground messages since we receive them over Centrifugo WebSocket.\n                });\n            } catch (error) {\n                console.error('Failed to send token to server:', error);\n            }\n        } else {\n            console.warn('No token received, cannot proceed.');\n        }\n    };\n\n    setupNotifications();\n}, [authenticated, userInfo, csrf]);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["We register this token in Centrifugo PRO using Centrifugo API. To do this we call new Django endpoint ",(0,t.jsx)(n.code,{children:"/api/device/register"})," and call Centrifugo ",(0,t.jsx)(n.code,{children:"device_register"})," method from it. On every app load we are updating token registration in Centrifugo PRO."]}),"\n",(0,t.jsx)(n.p,{children:"Once user logs out we unregister device token from Centrifugo PRO and remove token from FCM:"}),"\n",(0,t.jsx)(n.p,{children:"And on frontend:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",metastring:'title="frontend/src/App.tsx"',children:"  const onLoggedOut = async () => {\n    ...\n    localStorage.removeItem(LOCAL_STORAGE_DEVICE_ID_KEY);\n    await removeNotificationToken();\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"service-worker-for-background-pushes",children:"Service Worker for background pushes"}),"\n",(0,t.jsxs)(n.p,{children:["Note, we also registered ",(0,t.jsx)(n.code,{children:"/firebase-messaging-sw.js"})," as a Service Worker. Service Worker runs in the background and can show notifications even when the app is closed."]}),"\n",(0,t.jsx)(n.p,{children:"The file we're registering as Service Worker looks like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",metastring:'title="frontend/public/firebase-messaging-sw.js"',children:"// Scripts for firebase and firebase messaging\nimportScripts('https://www.gstatic.com/firebasejs/9.16.0/firebase-app-compat.js');\nimportScripts('https://www.gstatic.com/firebasejs/9.16.0/firebase-messaging-compat.js');\nimportScripts('/firebase-config.js');\n\nif (!self.firebaseConfig) {\n    console.error('Firebase config not found');\n} else {\n    firebase.initializeApp(self.firebaseConfig);\n    const messaging = firebase.messaging();\n\n    messaging.onBackgroundMessage(function (payload) {\n        console.log('Received background message ', payload);\n\n        const notification = payload.data;\n        if (!notification) {\n            return\n        }\n\n        // Customize notification here.\n        const notificationOptions = {\n            ...notification,\n        };\n\n        self.registration.showNotification(\n            notification.title,\n            notificationOptions\n        );\n    });\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Basically, we are initializing Firebase messaging in the Service Worker and then listen to background messages from Firebase. Once we receive a message we show a notification."}),"\n",(0,t.jsx)(n.h3,{id:"conclusion",children:"Conclusion"}),"\n",(0,t.jsx)(n.p,{children:"Here we showed how to add push notifications to the Grand Chat application. We used Centrifugo PRO push notifications API and Firebase Cloud Messaging to achieve this."})]})}function p(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>r});var t=i(67294);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);