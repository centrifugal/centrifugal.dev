"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[7637],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var i=s(96540);const r={},a=i.createContext(r);function t(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(a.Provider,{value:n},e.children)}},70365:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"pro/namespace_engines","title":"Per-namespace engines","description":"Centrifugo OSS allows specifying an engine. Engine is responsible for PUB/SUB and channel stream/history features (we call this part Broker), and for online presence (this part is called Presence Manager). Engine in Centrifugo OSS is global for the entire Centrifugo setup \u2013 once defined, all channels use it to make operations.","source":"@site/docs/pro/namespace_engines.md","sourceDirName":"pro","slug":"/pro/namespace_engines","permalink":"/docs/pro/namespace_engines","draft":false,"unlisted":false,"editUrl":"https://github.com/centrifugal/centrifugal.dev/edit/main/docs/pro/namespace_engines.md","tags":[],"version":"current","frontMatter":{"id":"namespace_engines","title":"Per-namespace engines"},"sidebar":"Pro","previous":{"title":"Operation rate limits","permalink":"/docs/pro/rate_limiting"},"next":{"title":"Admin UI: SSO, more data","permalink":"/docs/pro/admin_ui"}}');var r=s(74848),a=s(28453);const t={id:"namespace_engines",title:"Per-namespace engines"},o=void 0,c={},l=[{value:"Defining brokers",id:"defining-brokers",level:2},{value:"Defining presence managers",id:"defining-presence-managers",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Centrifugo OSS allows ",(0,r.jsx)(n.a,{href:"/docs/server/engines",children:"specifying an engine"}),". Engine is responsible for PUB/SUB and channel stream/history features (we call this part ",(0,r.jsx)(n.code,{children:"Broker"}),"), and for online presence (this part is called ",(0,r.jsx)(n.code,{children:"Presence Manager"}),"). Engine in Centrifugo OSS is global for the entire Centrifugo setup \u2013 once defined, all channels use it to make operations."]}),"\n",(0,r.jsx)(n.p,{children:"Centrifugo PRO allows redefining brokers and presence managers on a namespace level. This may help with individual scaling based on channel activity, using different properties inside different channel namespaces within a single Centrifugo setup. This feature significantly enhances Centrifugo's adaptability, making it easier to meet diverse and evolving application demands."}),"\n",(0,r.jsx)(n.p,{children:"For example, you can configure Centrifugo to use Redis engine by default, but for some specific namespace use Nats for PUB/SUB \u2013 this may be handy if you need wildcard subscriptions for one of the features in the app, or maybe you want to consume from raw Nats topics for some app feature, but for other features you still need functionality implemented by Centrifugo Redis Engine - like history in channels, automatic recovery. Or, maybe you want to separate Redis setups used for broker purposes and online presence purposes."}),"\n",(0,r.jsx)(n.h2,{id:"defining-brokers",children:"Defining brokers"}),"\n",(0,r.jsx)(n.p,{children:"First, you need create configuration for additional brokers:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  ...\n  "brokers": [\n    {\n      "enabled": true,\n      "name": "mycustomredis",\n      "type": "redis",\n      "redis": {\n        "address": "127.0.0.1:6379"\n      }\n    },\n    {\n      "enabled": true,\n      "name": "mycustomnats",\n      "type": "nats",\n      "nats": {\n        "url": "nats://localhost:4222"\n      }\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"At this point Centrifugo PRO supports two broker types:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"redis"})," - inherits all the possibilities of Centrifugo ",(0,r.jsx)(n.a,{href:"/docs/server/engines#redis-engine",children:"built-in Redis Engine"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"nats"})," \u2013  inherits all the possibilities of Centrifugo ",(0,r.jsx)(n.a,{href:"/docs/server/engines#nats-broker",children:"integration with Nats broker"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["These brokers inherit all options described in ",(0,r.jsx)(n.a,{href:"/docs/server/engines",children:"Engines and scalability"})," chapter. The only difference that it's possible to specify which custom broker to use inside a channel namespace:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  ...\n  "channel": {\n    "namespaces": [\n      {\n        "name": "rates",\n        "broker_name": "mycustomnats"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"defining-presence-managers",children:"Defining presence managers"}),"\n",(0,r.jsx)(n.p,{children:"And for custom Presence Managers a similar approach may be applied. First, define a custom presence manager:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "presence_managers": [\n    {\n      "enabled": true,\n      "name": "mycustomredis",\n      "type": "redis",\n      "redis": {}\n    }\n  ]\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Centrifugo PRO only supports ",(0,r.jsx)(n.code,{children:"redis"})," type of Presence Manager."]}),"\n",(0,r.jsx)(n.p,{children:"And then enable it for namespace:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  ...\n  "channel": {\n    "namespaces": [\n      {\n        "name": "rates",\n        "broker_name": "mycustomnats",\n        "presence_manager_name": "mycustomredis"\n      }\n    ]\n  }\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);