"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[2318],{27929:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"pro/delta_at_most_once","title":"Delta compression for at most once scenario","description":"Enable delta compression for at most once delivery in Centrifugo PRO using the keep_latest_publication option to reduce channel bandwidth.","source":"@site/docs/pro/delta_at_most_once.md","sourceDirName":"pro","slug":"/pro/delta_at_most_once","permalink":"/docs/pro/delta_at_most_once","draft":false,"unlisted":false,"editUrl":"https://github.com/centrifugal/centrifugal.dev/edit/main/docs/pro/delta_at_most_once.md","tags":[],"version":"current","frontMatter":{"description":"Enable delta compression for at most once delivery in Centrifugo PRO using the keep_latest_publication option to reduce channel bandwidth.","id":"delta_at_most_once","sidebar_label":"Delta for at most once","title":"Delta compression for at most once scenario"}}');var s=t(74848),a=t(28453);const i={description:"Enable delta compression for at most once delivery in Centrifugo PRO using the keep_latest_publication option to reduce channel bandwidth.",id:"delta_at_most_once",sidebar_label:"Delta for at most once",title:"Delta compression for at most once scenario"},r=void 0,c={},l=[];function d(e){const n={a:"a",code:"code",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Centrifugo OSS supports ",(0,s.jsx)(n.a,{href:"/docs/server/delta_compression",children:"delta compression"})," only in channels with recovery and positioning on. To support delta compression for the case when subscribers do not use recovery and positioning Centrifugo PRO provides a boolean namespace option called ",(0,s.jsx)(n.code,{children:"keep_latest_publication"}),". When it's on \u2013 Centrifugo saves latest publication in channels to node's memory and uses it to construct delta updates. The publication lives in node's memory while there are active channel subscribers. This allows dealing with at most once guarantee of Broker's PUB/SUB layer and send deltas properly. So you get efficient at most once broadcast and the reduced bandwidth (of course if delta compression makes sense for data in a channel)."]}),"\n",(0,s.jsxs)(n.p,{children:["All you need to do is enable ",(0,s.jsx)(n.code,{children:"keep_latest_publication"})," for the desired namespace:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "channel": {\n    "namespaces": [\n      {\n        "name": "example",\n        "allowed_delta_types": [\n          "fossil"\n        ],\n        "keep_latest_publication": true\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Everything else stays the same as described in ",(0,s.jsx)(n.a,{href:"/docs/server/delta_compression",children:"delta compression"})," chapter:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"clients need to negotiate delta compression when subscribing"}),"\n",(0,s.jsxs)(n.li,{children:["publishers need to indicate the desire to use delta compression by using API ",(0,s.jsx)(n.code,{children:"delta"})," field, or by using ",(0,s.jsx)(n.code,{children:"delta_publish"})," channel namespace option."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var o=t(96540);const s={},a=o.createContext(s);function i(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);