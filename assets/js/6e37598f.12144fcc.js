"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[1196],{75548:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var s=t(85893),r=t(11151);const i={id:"observability_enhancements",title:"Observability enhancements"},o=void 0,a={id:"pro/observability_enhancements",title:"Observability enhancements",description:"Centrifugo PRO version provides an enhanced observability as when the business grows it's crucial to have a deep insight into the system.",source:"@site/docs/pro/observability_enhancements.md",sourceDirName:"pro",slug:"/pro/observability_enhancements",permalink:"/docs/pro/observability_enhancements",draft:!1,unlisted:!1,editUrl:"https://github.com/centrifugal/centrifugal.dev/edit/main/docs/pro/observability_enhancements.md",tags:[],version:"current",frontMatter:{id:"observability_enhancements",title:"Observability enhancements"},sidebar:"Pro",previous:{title:"Message batching control",permalink:"/docs/pro/client_message_batching"},next:{title:"CPU and RSS stats",permalink:"/docs/pro/process_stats"}},l={},c=[{value:"Additional metrics insights",id:"additional-metrics-insights",level:2},{value:"Channel namespace resolution for metrics",id:"channel-namespace-resolution-for-metrics",level:2},{value:"Sentry integration",id:"sentry-integration",level:2},{value:"Sentry options",id:"sentry-options",level:3},{value:"sentry.enabled",id:"sentryenabled",level:4},{value:"sentry.dsn",id:"sentrydsn",level:4},{value:"sentry.environment",id:"sentryenvironment",level:4},{value:"sentry.sample_rate",id:"sentrysample_rate",level:4}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Centrifugo PRO version provides an enhanced observability as when the business grows it's crucial to have a deep insight into the system."}),"\n",(0,s.jsx)(n.h2,{id:"additional-metrics-insights",children:"Additional metrics insights"}),"\n",(0,s.jsx)(n.p,{children:"Centrifugo PRO has some enhancements to exposed metrics."}),"\n",(0,s.jsx)(n.p,{children:"It's possible to understand how many clients from different environments are currently connected to your Centrifugo. I.e. from browser, from Android, iOS devices. This is possible because our SDKs pass the name of SDK to a server, and provide a way to redefine it."}),"\n",(0,s.jsx)(n.p,{children:"Names of clients you are using in SDKs must be registered in Centrifugo configuration. This is done to avoid cardinality issues in Prometheus."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "prometheus": {\n    "enabled": true,\n    "additional_client_names": [\n      "my-name1",\n      "my-name2"\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"And Centrifugo PRO already aware of some names used by our official SDKs, so out of the box you will get segmentation by those."}),"\n",(0,s.jsx)(n.h2,{id:"channel-namespace-resolution-for-metrics",children:"Channel namespace resolution for metrics"}),"\n",(0,s.jsx)(n.p,{children:"Centrifugo PRO supports channel namespace resolution for many metrics related to channel. One application could be for setups with many namespaces to understand which namespaces consume more bandwidth. Or which namespace generates more frames, or errors. Or number inflight subscriptions with channel namespace resolution!"}),"\n",(0,s.jsx)(n.p,{children:"To enable:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "prometheus": {\n    "enabled": true,\n    "channel_namespace_resolution": true\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Centrifugo PRO requires separate flag to enable channel namespace resolution for metrics because it may have some overhead (in most cases negligible though)."}),"\n",(0,s.jsx)(n.h2,{id:"sentry-integration",children:"Sentry integration"}),"\n",(0,s.jsxs)(n.p,{children:["Centrifugo PRO comes with an integration with ",(0,s.jsx)(n.a,{href:"https://sentry.io/",children:"Sentry"}),". Just a couple of lines in the configuration:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  ...\n  "sentry": {\n    "enabled": true,\n    "dsn": "your-project-public-dsn"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u2013 and you will see Centrifugo PRO errors collected by your self-hosted or cloud Sentry installation."}),"\n",(0,s.jsx)("img",{src:"/img/sentry.jpg"}),"\n",(0,s.jsx)(n.h3,{id:"sentry-options",children:"Sentry options"}),"\n",(0,s.jsx)(n.h4,{id:"sentryenabled",children:"sentry.enabled"}),"\n",(0,s.jsx)(n.p,{children:"Boolean flag to enable Sentry integration."}),"\n",(0,s.jsx)(n.h4,{id:"sentrydsn",children:"sentry.dsn"}),"\n",(0,s.jsx)(n.p,{children:"Sentry DSN to use for error reporting."}),"\n",(0,s.jsx)(n.h4,{id:"sentryenvironment",children:"sentry.environment"}),"\n",(0,s.jsx)(n.p,{children:"Environment name to set for Sentry events."}),"\n",(0,s.jsx)(n.h4,{id:"sentrysample_rate",children:"sentry.sample_rate"}),"\n",(0,s.jsxs)(n.p,{children:["Sample rate to set for Sentry events. By default, all events are sent to Sentry. You can set a sample rate to send only a fraction of events to Sentry. For example, to send 1/10 of events set this to ",(0,s.jsx)(n.code,{children:"0.1"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var s=t(67294);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);