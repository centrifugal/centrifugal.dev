"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[4306],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var t=i(96540);const o={},s=t.createContext(o);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(s.Provider,{value:n},e.children)}},31097:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"pro/bandwidth_optimizations","title":"Bandwidth optimizations","description":"In high-volume scenarios, bandwidth optimizations can be crucial for reducing network traffic costs and improving performance. Here you can see features of Centrifugo PRO which help optimize bandwidth usage.","source":"@site/docs/pro/bandwidth_optimizations.md","sourceDirName":"pro","slug":"/pro/bandwidth_optimizations","permalink":"/docs/pro/bandwidth_optimizations","draft":false,"unlisted":false,"editUrl":"https://github.com/centrifugal/centrifugal.dev/edit/main/docs/pro/bandwidth_optimizations.md","tags":[],"version":"current","frontMatter":{"id":"bandwidth_optimizations","title":"Bandwidth optimizations"},"sidebar":"Pro","previous":{"title":"Scalability optimizations","permalink":"/docs/pro/scalability"},"next":{"title":"Message batching control","permalink":"/docs/pro/client_message_batching"}}');var o=i(74848),s=i(28453);const a={id:"bandwidth_optimizations",title:"Bandwidth optimizations"},r=void 0,c={},l=[{value:"Delta compression for at most once",id:"delta-compression-for-at-most-once",level:2},{value:"Channel compaction",id:"channel-compaction",level:2},{value:"Drop intermediary publications",id:"drop-intermediary-publications",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"In high-volume scenarios, bandwidth optimizations can be crucial for reducing network traffic costs and improving performance. Here you can see features of Centrifugo PRO which help optimize bandwidth usage."}),"\n",(0,o.jsx)(n.h2,{id:"delta-compression-for-at-most-once",children:"Delta compression for at most once"}),"\n",(0,o.jsxs)(n.p,{children:["Centrifugo OSS supports ",(0,o.jsx)(n.a,{href:"/docs/server/delta_compression",children:"delta compression"})," only in channels with recovery and positioning on. To support delta compression for the case when subscribers do not use recovery and positioning Centrifugo PRO provides a boolean namespace option called ",(0,o.jsx)(n.code,{children:"keep_latest_publication"}),". When it's on \u2013 Centrifugo saves latest publication in channels to node's memory and uses it to construct delta updates. The publication lives in node's memory while there are active channel subscribers. This allows dealing with at most once guarantee of Broker's PUB/SUB layer and send deltas properly. So you get efficient at most once broadcast and the reduced bandwidth (of course if delta compression makes sense for data in a channel)."]}),"\n",(0,o.jsxs)(n.p,{children:["All you need to do is enable ",(0,o.jsx)(n.code,{children:"keep_latest_publication"})," for the desired namespace:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n    "channel": {\n        "namespaces": [{\n            "name": "example",\n            "allowed_delta_types": [\n                "fossil"\n            ],\n            "keep_latest_publication": true\n        }]\n    }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Everything else stays the same as described in ",(0,o.jsx)(n.a,{href:"/docs/server/delta_compression",children:"delta compression"})," chapter:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"clients need to negotiate delta compression when subscribing"}),"\n",(0,o.jsxs)(n.li,{children:["publishers need to indicate the desire to use delta compression by using API ",(0,o.jsx)(n.code,{children:"delta"})," field, or by using ",(0,o.jsx)(n.code,{children:"delta_publish"})," channel namespace option."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"channel-compaction",children:"Channel compaction"}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"This is a beta feature. We suggest testing it carefully in your environment before using in production."})}),"\n",(0,o.jsx)(n.p,{children:"Channel compaction is a feature that allows reducing the size of messages sent to clients by replacing full channel names with shorter numeric IDs. This can be particularly beneficial in scenarios where channel names are long as it helps to minimize the amount of data transmitted over the network. In protobuf protocol this allows using varint channel identifier type instead of string channel name."}),"\n",(0,o.jsxs)(n.p,{children:["To enable channel compaction, set the ",(0,o.jsx)(n.code,{children:"allow_channel_compaction"})," option to ",(0,o.jsx)(n.code,{children:"true"})," in your Centrifugo configuration for the desired namespace:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n    "channel": {\n        "namespaces": [{\n            "name": "example",\n            "allow_channel_compaction": true\n        }]\n    }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"After that client SDKs which support channel compaction will automatically negotiate it during the subscription, no additional steps required."}),"\n",(0,o.jsxs)(n.p,{children:["At this moment only JavaScript SDK (",(0,o.jsx)(n.code,{children:"centrifuge-js"}),") supports this feature (since v5.5.0). And Centrifugo PRO supports this since v6.4.0."]}),"\n",(0,o.jsx)(n.h2,{id:"drop-intermediary-publications",children:"Drop intermediary publications"}),"\n",(0,o.jsxs)(n.p,{children:["Another optimization related to bandwidth is the ability to drop intermediary publications in channels using ",(0,o.jsx)(n.a,{href:"/docs/pro/client_message_batching",children:"Message batching control"})," features of Centrifugo PRO. Specifically, see ",(0,o.jsx)(n.a,{href:"/docs/pro/client_message_batching#batch_flush_latest",children:"batch_flush_latest"})," option."]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);