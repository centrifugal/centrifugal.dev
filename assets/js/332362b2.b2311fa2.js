"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[2918],{75215:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>a});var t=i(85893),s=i(11151);const o={id:"configuration",title:"Configure Centrifugo"},r=void 0,l={id:"server/configuration",title:"Configure Centrifugo",description:"Centrifugo can start without any configuration \u2013 it runs out-of-the-box with enabled HTTP API endpoint and enabled WebSocket transport endpoint for client real-time connections. In most cases though, you still need to configure it to set authorization options for HTTP API, connection JWT authentication, or maybe authentication over connect proxy, describe the desired channel behaviour, and so on.",source:"@site/docs/server/configuration.md",sourceDirName:"server",slug:"/server/configuration",permalink:"/docs/server/configuration",draft:!1,unlisted:!1,editUrl:"https://github.com/centrifugal/centrifugal.dev/edit/main/docs/server/configuration.md",tags:[],version:"current",frontMatter:{id:"configuration",title:"Configure Centrifugo"},sidebar:"Guides",next:{title:"Server API walkthrough",permalink:"/docs/server/server_api"}},c={},a=[{value:"Configuration sources",id:"configuration-sources",level:3},{value:"Command-line flags",id:"command-line-flags",level:3},{value:"OS environment variables",id:"os-environment-variables",level:3},{value:"Configuration file",id:"configuration-file",level:3},{value:"Config file formats",id:"config-file-formats",level:2},{value:"JSON config format",id:"json-config-format",level:3},{value:"TOML config format",id:"toml-config-format",level:3},{value:"YAML config format",id:"yaml-config-format",level:3},{value:"Validation and warnings on start",id:"validation-and-warnings-on-start",level:2},{value:"HTTP server config options",id:"http-server-config-options",level:2},{value:"http_server.port",id:"http_serverport",level:3},{value:"http_server.address",id:"http_serveraddress",level:3},{value:"http_server.tls",id:"http_servertls",level:3},{value:"http_server.tls_autocert",id:"http_servertls_autocert",level:3},{value:"http_server.tls_external",id:"http_servertls_external",level:3},{value:"http_server.internal_port",id:"http_serverinternal_port",level:3},{value:"http_server.internal_address",id:"http_serverinternal_address",level:3},{value:"http_server.internal_tls",id:"http_serverinternal_tls",level:3},{value:"Logging configuration",id:"logging-configuration",level:2},{value:"log.level",id:"loglevel",level:3},{value:"log.file",id:"logfile",level:3},{value:"Engine config",id:"engine-config",level:2},{value:"engine.type",id:"enginetype",level:3},{value:"Broker config",id:"broker-config",level:2},{value:"Presence Manager config",id:"presence-manager-config",level:2},{value:"Server HTTP API config",id:"server-http-api-config",level:2},{value:"Server GRPC API config",id:"server-grpc-api-config",level:2},{value:"Client connection config",id:"client-connection-config",level:2},{value:"client.allowed_origins",id:"clientallowed_origins",level:3},{value:"client.token",id:"clienttoken",level:3},{value:"client.subscription_token",id:"clientsubscription_token",level:3},{value:"client.proxy.connect",id:"clientproxyconnect",level:3},{value:"client.proxy.refresh",id:"clientproxyrefresh",level:3},{value:"client.ping_interval",id:"clientping_interval",level:3},{value:"client.pong_timeout",id:"clientpong_timeout",level:3},{value:"client.queue_max_size",id:"clientqueue_max_size",level:3},{value:"client.history_max_publication_limit",id:"clienthistory_max_publication_limit",level:3},{value:"client.recovery_max_publication_limit",id:"clientrecovery_max_publication_limit",level:3},{value:"client.channel_limit",id:"clientchannel_limit",level:3},{value:"client.user_connection_limit",id:"clientuser_connection_limit",level:3},{value:"client.connection_limit",id:"clientconnection_limit",level:3},{value:"client.connection_rate_limit",id:"clientconnection_rate_limit",level:3},{value:"client.queue_max_size",id:"clientqueue_max_size-1",level:3},{value:"client.concurrency",id:"clientconcurrency",level:3},{value:"client.stale_close_delay",id:"clientstale_close_delay",level:3},{value:"client.user_id_http_header",id:"clientuser_id_http_header",level:3},{value:"client.connect_include_server_time",id:"clientconnect_include_server_time",level:3},{value:"client.allow_anonymous_connect_without_token",id:"clientallow_anonymous_connect_without_token",level:3},{value:"client.disallow_anonymous_connection_tokens",id:"clientdisallow_anonymous_connection_tokens",level:3},{value:"client.subscribe_to_user_personal_channel",id:"clientsubscribe_to_user_personal_channel",level:3},{value:"Channel configuration",id:"channel-configuration",level:2},{value:"channel.without_namespace",id:"channelwithout_namespace",level:3},{value:"channel.namespaces",id:"channelnamespaces",level:3},{value:"channel.history_meta_ttl",id:"channelhistory_meta_ttl",level:3},{value:"channel.proxy.subscribe",id:"channelproxysubscribe",level:3},{value:"channel.proxy.publish",id:"channelproxypublish",level:3},{value:"channel.proxy.sub_refresh",id:"channelproxysub_refresh",level:3},{value:"channel.proxy.subscribe_stream",id:"channelproxysubscribe_stream",level:3},{value:"channel.proxy.state",id:"channelproxystate",level:3},{value:"chanel.proxy.cache_empty",id:"chanelproxycache_empty",level:3},{value:"channel.max_length",id:"channelmax_length",level:3},{value:"Client RPC configuration",id:"client-rpc-configuration",level:2},{value:"rpc.without_namespace",id:"rpcwithout_namespace",level:3},{value:"rpc.namespaces",id:"rpcnamespaces",level:3},{value:"rpc.namespace_boundary",id:"rpcnamespace_boundary",level:3},{value:"rpc.ping",id:"rpcping",level:3},{value:"Real-time transports",id:"real-time-transports",level:2},{value:"websocket",id:"websocket",level:3},{value:"sse",id:"sse",level:3},{value:"http_stream",id:"http_stream",level:3},{value:"webtransport",id:"webtransport",level:3},{value:"uni_websocket",id:"uni_websocket",level:3},{value:"uni_sse",id:"uni_sse",level:3},{value:"uni_http_stream",id:"uni_http_stream",level:3},{value:"uni_grpc",id:"uni_grpc",level:3},{value:"Emulation config",id:"emulation-config",level:2},{value:"emulation.max_request_body_size",id:"emulationmax_request_body_size",level:3},{value:"Admin UI config",id:"admin-ui-config",level:2},{value:"admin.enabled",id:"adminenabled",level:3},{value:"Debug config",id:"debug-config",level:2},{value:"debug.enabled",id:"debugenabled",level:3},{value:"Health config",id:"health-config",level:2},{value:"health.enabled",id:"healthenabled",level:3},{value:"Prometheus config",id:"prometheus-config",level:2},{value:"prometheus.enabled",id:"prometheusenabled",level:3},{value:"prometheus.instrument_http_handlers",id:"prometheusinstrument_http_handlers",level:3},{value:"Swagger UI config",id:"swagger-ui-config",level:2},{value:"swagger.enabled",id:"swaggerenabled",level:3},{value:"Miscellaneous options",id:"miscellaneous-options",level:2},{value:"pid_file",id:"pid_file",level:3},{value:"Insecure options",id:"insecure-options",level:2},{value:"client.insecure",id:"clientinsecure",level:3},{value:"client.insecure_skip_token_signature_verify",id:"clientinsecure_skip_token_signature_verify",level:3},{value:"http_api.insecure",id:"http_apiinsecure",level:3},{value:"admin.insecure",id:"admininsecure",level:3},{value:"Custom internal port",id:"custom-internal-port",level:2},{value:"Endpoint management",id:"endpoint-management",level:2},{value:"Default endpoints",id:"default-endpoints",level:3},{value:"Customize handler prefixes",id:"customize-handler-prefixes",level:3},{value:"Disable default endpoints",id:"disable-default-endpoints",level:3},{value:"Proxies",id:"proxies",level:2},{value:"Consumers",id:"consumers",level:2},{value:"Opentelemetry",id:"opentelemetry",level:2},{value:"Graphite",id:"graphite",level:2},{value:"Shutdown",id:"shutdown",level:2},{value:"Signal handling",id:"signal-handling",level:2},{value:"Anonymous usage stats",id:"anonymous-usage-stats",level:2},{value:"Setting time duration options",id:"setting-time-duration-options",level:2},{value:"TLS config object",id:"tls-config-object",level:2},{value:"Setting namespaces over env",id:"setting-namespaces-over-env",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Centrifugo can start without any configuration \u2013 it runs out-of-the-box with enabled HTTP API endpoint and enabled WebSocket transport endpoint for client real-time connections. In most cases though, you still need to configure it to set ",(0,t.jsx)(n.a,{href:"/docs/server/server_api#http-api-authorization",children:"authorization options for HTTP API"}),", ",(0,t.jsx)(n.a,{href:"/docs/server/authentication",children:"connection JWT authentication"}),", or maybe authentication over ",(0,t.jsx)(n.a,{href:"/docs/server/proxy",children:"connect proxy"}),", describe the desired ",(0,t.jsx)(n.a,{href:"/docs/server/channels",children:"channel behaviour"}),", and so on."]}),"\n",(0,t.jsx)(n.p,{children:"This document describes configuration principles and configuration sections, and most of the options available in Centrifugo. Where the feature requires more description we point from here to the dedicated documentation chapters."}),"\n",(0,t.jsx)(n.h3,{id:"configuration-sources",children:"Configuration sources"}),"\n",(0,t.jsx)(n.p,{children:"Centrifugo can be configured in several ways:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"using command-line flags (highest priority \u2013 flags override everything)"}),"\n",(0,t.jsx)(n.li,{children:"environment variables (medium priority \u2013 env vars override config file options)"}),"\n",(0,t.jsx)(n.li,{children:"configuration file (lowest priority)."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"command-line-flags",children:"Command-line flags"}),"\n",(0,t.jsx)(n.p,{children:"Command-line options have the highest priority when set than other ways to configure Centrifugo."}),"\n",(0,t.jsxs)(n.p,{children:["Centrifugo supports several command-line flags. See ",(0,t.jsx)(n.code,{children:"centrifugo -h"})," for available flags. Command-line flags limited to most frequently used. Mostly useful for development. In general, ",(0,t.jsx)(n.strong,{children:"we recommend to avoid using flags for configuring Centrifugo in a production environment"})," because flags often harder to redefine without changes in how Centrifugo deployed \u2013 prefer using environment variables or configuration file."]}),"\n",(0,t.jsx)(n.h3,{id:"os-environment-variables",children:"OS environment variables"}),"\n",(0,t.jsx)(n.p,{children:"Environment variables have the second priority after flags. Flags override env vars, env vars override config file."}),"\n",(0,t.jsxs)(n.p,{children:["Almost all Centrifugo options can be set over env in the format ",(0,t.jsx)(n.code,{children:"CENTRIFUGO_<OPTION_NAME>"}),". Setting options over environment variables is mostly straightforward \u2013 you just prefix the option used in configuration file with ",(0,t.jsx)(n.code,{children:"CENTRIFUGO_"}),", make it uppercase and replace nested levels with ",(0,t.jsx)(n.code,{children:"_"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"There are some cases though where we need to configure arrays of objects. For arrays of objects Centrifugo either provides a way to point the specific array instance by name when setting environment variable, or provides a way to set the entire array of objects as a JSON string."})}),"\n",(0,t.jsxs)(n.p,{children:["Boolean options can be set using strings according to Go language ",(0,t.jsx)(n.a,{href:"https://pkg.go.dev/strconv#ParseBool",children:"ParseBool"})," function. I.e. to set ",(0,t.jsx)(n.code,{children:"true"})," you can just use ",(0,t.jsx)(n.code,{children:'"true"'})," value for an environment variable (or simply ",(0,t.jsx)(n.code,{children:'"1"'}),"). To set ",(0,t.jsx)(n.code,{children:"false"})," use ",(0,t.jsx)(n.code,{children:'"false"'})," or ",(0,t.jsx)(n.code,{children:'"0"'}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Array of strings can be set over env using space-separated string values."}),"\n",(0,t.jsx)(n.p,{children:"Let's look at the example. Suppose the configuration file looks like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    "allowed_origins": [\n      "https://mysite1.com",\n      "https://mysite2.com"\n    ]\n  },\n  "prometheus": {\n    "enabled": true\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"The same may be achieved using environment variables in this way:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'export CENTRIFUGO_CLIENT_ALLOWED_ORIGINS="https://mysite1.com https://mysite2.com"\nexport CENTRIFUGO_PROMETHEUS_ENABLED="true"\n'})}),"\n",(0,t.jsx)(n.p,{children:"Empty environment variables are considered unset (!) and will fall back to the next configuration source."}),"\n",(0,t.jsx)(n.h3,{id:"configuration-file",children:"Configuration file"}),"\n",(0,t.jsx)(n.p,{children:"Configuration file supports all options mentioned in Centrifugo documentation and can be in one of three supported formats: JSON, YAML, or TOML."}),"\n",(0,t.jsx)(n.p,{children:"Config file options have the lowest priority among configuration sources (i.e. option set over environment variable is preferred over the same option in config file)."}),"\n",(0,t.jsx)(n.p,{children:"One simple way to start with Centrifugo and its configuration is to run:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"centrifugo genconfig\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This command generates ",(0,t.jsx)(n.code,{children:"config.json"})," configuration file in a current directory. This file already has the minimal number which are often used set. It's then possible to start Centrifugo with generated config file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"centrifugo -c config.json\n"})}),"\n",(0,t.jsx)(n.h2,{id:"config-file-formats",children:"Config file formats"}),"\n",(0,t.jsx)(n.p,{children:"Centrifugo supports three configuration file formats: JSON, YAML, or TOML."}),"\n",(0,t.jsx)(n.h3,{id:"json-config-format",children:"JSON config format"}),"\n",(0,t.jsx)(n.p,{children:"Here is an example of Centrifugo JSON configuration file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    "token": {\n      "hmac_secret_key": "<YOUR-SECRET-STRING-HERE>"\n    },\n    "allowed_origins": [\n      "http://localhost:3000"\n    ]\n  },\n  "http_api": {\n    "key": "<YOUR-API-KEY-HERE>"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"client.token.hmac_secret_key"})," used to check JWT signature (more info about JWT in ",(0,t.jsx)(n.a,{href:"/docs/server/authentication",children:"authentication chapter"}),"). If you are using ",(0,t.jsx)(n.a,{href:"/docs/server/proxy#connect-proxy",children:"connect proxy"})," then you may use Centrifugo without JWT."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"http_api.key"})," used for Centrifugo API endpoint authorization, see more in ",(0,t.jsx)(n.a,{href:"/docs/server/server_api#http-api",children:"chapter about server HTTP API"}),". Keep both values secret and never reveal them to clients."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"client.allowed_origins"})," option ",(0,t.jsx)(n.a,{href:"#clientallowed_origins",children:"described below"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"toml-config-format",children:"TOML config format"}),"\n",(0,t.jsx)(n.p,{children:"Centrifugo also supports TOML format for configuration file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"centrifugo --config=config.toml\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Where ",(0,t.jsx)(n.code,{children:"config.toml"})," may contain sth like:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'title="config.toml"',children:'[client]\nallowed_origins = [ "http://localhost:3000" ]\n\n  [client.token]\n  hmac_secret_key = "<YOUR-SECRET-STRING-HERE>"\n\n[http_api]\nkey = "<YOUR-API-KEY-HERE>"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"yaml-config-format",children:"YAML config format"}),"\n",(0,t.jsx)(n.p,{children:"YAML format is also supported:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="config.yaml"',children:'client:\n  token:\n    hmac_secret_key: "<YOUR-SECRET-STRING-HERE>"\n  allowed_origins:\n  - http://localhost:3000\nhttp_api:\n  key: "<YOUR-API-KEY-HERE>"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"validation-and-warnings-on-start",children:"Validation and warnings on start"}),"\n",(0,t.jsxs)(n.p,{children:["Centrifugo validates configuration on start, in case the configuration is invalid server exits with code 1. See also some built-in ",(0,t.jsx)(n.a,{href:"/docs/server/console_commands",children:"CLI helpers"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Centrifugo also tries to help you find misconfigurations by writing logs on WARN level during server startup in case configuration file or environment variables have keys which are not known by Centrifugo. Unknown keys do not result into server exiting at this point."}),"\n",(0,t.jsx)(n.p,{children:"It's recommended to pay attention to logs on server start to ensure that configuration is correct."}),"\n",(0,t.jsx)(n.h2,{id:"http-server-config-options",children:"HTTP server config options"}),"\n",(0,t.jsxs)(n.p,{children:["Let's describe configuration options you can set for Centrifugo HTTP server. They are combined under ",(0,t.jsx)(n.code,{children:"http_server"})," section of configuration file."]}),"\n",(0,t.jsx)(n.h3,{id:"http_serverport",children:"http_server.port"}),"\n",(0,t.jsxs)(n.p,{children:["Port to bind Centrifugo to (string, by default ",(0,t.jsx)(n.code,{children:'"8000"'}),")."]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "http_server" : {\n    "port": "8000"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"http_serveraddress",children:"http_server.address"}),"\n",(0,t.jsxs)(n.p,{children:["Bind your Centrifugo to a specific interface address (string, by default ",(0,t.jsx)(n.code,{children:'""'})," - listen on all available interfaces)."]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "http_server" : {\n    "address": "0.0.0.0"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"http_servertls",children:"http_server.tls"}),"\n",(0,t.jsx)(n.p,{children:"TLS layer is very important not only for securing your connections but also to increase a chance to establish Websocket connection."}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"In most situations you better put TLS termination task on your reverse proxy/load balancing software such as Nginx. This can be a good thing for performance."})}),"\n",(0,t.jsxs)(n.p,{children:["If you still need to configure Centrifugo server TLS then ",(0,t.jsx)(n.code,{children:"tls"})," object can help you. This is a ",(0,t.jsx)(n.a,{href:"#tls-config-object",children:"unified TLS object"}),". If set and enabled Centrifugo HTTP server will start with TLS support."]}),"\n",(0,t.jsx)(n.h3,{id:"http_servertls_autocert",children:"http_server.tls_autocert"}),"\n",(0,t.jsx)(n.p,{children:"Centrifugo supports certificate loading and renewal from Let's Encrypt using ACME protocol for HTTP server."}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"In most situations you better put TLS termination task on your reverse proxy/load balancing software such as Nginx. This can be a good thing for performance."})}),"\n",(0,t.jsx)(n.p,{children:"For automatic certificates from Let's Encrypt add into configuration file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "http_server": {\n    "tls_autocert": {\n      "enabled": true,\n      "host_whitelist": "www.example.com",\n      "cache_dir": "/tmp/certs",\n      "email": "user@example.com",\n      "http": true,\n      "http_addr": ":80"\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"http_server.tls_autocert.enabled"})," (boolean) says Centrifugo that you want automatic certificate handling using ACME provider."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"http_server.tls_autocert.host_whitelist"})," (string) is a string with your app domain address. This can be comma-separated\nlist. It's optional but recommended for extra security."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"http_server.tls_autocert.cache_dir"})," (string) is a path to a folder to cache issued certificate files. This is optional\nbut will increase performance."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"http_server.tls_autocert.email"})," (string) is optional - it's an email address ACME provider will send notifications\nabout problems with your certificates."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"http_server.tls_autocert.http"})," (boolean) is an option to handle http_01 ACME challenge on non-TLS port."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"http_server.tls_autocert.http_addr"})," (string) can be used to set address for handling http_01 ACME challenge (default is ",(0,t.jsx)(n.code,{children:":80"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:["When configured correctly and your domain is valid (",(0,t.jsx)(n.code,{children:"localhost"})," will not work) - certificates will be retrieved on first request to Centrifugo."]}),"\n",(0,t.jsx)(n.p,{children:"Also Let's Encrypt certificates will be automatically renewed."}),"\n",(0,t.jsx)(n.h3,{id:"http_servertls_external",children:"http_server.tls_external"}),"\n",(0,t.jsxs)(n.p,{children:["Bool, default ",(0,t.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["When set to ",(0,t.jsx)(n.code,{children:"true"})," Centrifugo will use TLS configuration from ",(0,t.jsx)(n.code,{children:"tls"})," option only for external endpoints (i.e. for client-facing ones \u2013 WebSocket, SSE, and so on)."]}),"\n",(0,t.jsx)(n.h3,{id:"http_serverinternal_port",children:"http_server.internal_port"}),"\n",(0,t.jsxs)(n.p,{children:["The port to bind internal endpoints to (string, by default ",(0,t.jsx)(n.code,{children:'""'})," \u2013 not used). When set Centrifugo will bind internal endpoints to this port. See more about internal endpoints ",(0,t.jsx)(n.a,{href:"#custom-internal-port",children:"below"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"http_serverinternal_address",children:"http_server.internal_address"}),"\n",(0,t.jsxs)(n.p,{children:["Bind internal endpoints to a specific interface address (string, by default ",(0,t.jsx)(n.code,{children:'""'})," - listen on all available interfaces)."]}),"\n",(0,t.jsx)(n.h3,{id:"http_serverinternal_tls",children:"http_server.internal_tls"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"#tls-config-object",children:"TLS configuration object"}),". This is useful when you want to use different TLS settings for internal endpoints (like Prometheus, debug, health, etc)."]}),"\n",(0,t.jsx)(n.h2,{id:"logging-configuration",children:"Logging configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Logging options may be set under ",(0,t.jsx)(n.code,{children:"log"})," section of configuration file."]}),"\n",(0,t.jsx)(n.h3,{id:"loglevel",children:"log.level"}),"\n",(0,t.jsxs)(n.p,{children:["Log level (string, by default ",(0,t.jsx)(n.code,{children:'"info"'}),"). Possible values are: ",(0,t.jsx)(n.code,{children:'"none"'}),", ",(0,t.jsx)(n.code,{children:'"trace"'}),", ",(0,t.jsx)(n.code,{children:'"debug"'}),", ",(0,t.jsx)(n.code,{children:'"info"'}),", ",(0,t.jsx)(n.code,{children:'"warn"'}),", ",(0,t.jsx)(n.code,{children:'"error"'}),". See also some info in ",(0,t.jsx)(n.a,{href:"/docs/server/observability#logs",children:"observability"})," chapter."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "log" : {\n    "level": "error"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"logfile",children:"log.file"}),"\n",(0,t.jsxs)(n.p,{children:["Path to a file to which Centrifugo will write logs (string, by default ",(0,t.jsx)(n.code,{children:'""'})," \u2013 not used, logs go to STDOUT)."]}),"\n",(0,t.jsx)(n.h2,{id:"engine-config",children:"Engine config"}),"\n",(0,t.jsx)(n.p,{children:"Engine in Centrifugo is responsible for PUB/SUB, channel history cache, online presence features. By default, all Centrifugo PUB/SUB, channel history cache, online presence features are managed by in-memory engine. To scale Centrifugo to many nodes you may want to set alternative engine."}),"\n",(0,t.jsxs)(n.p,{children:["Here we only mention ",(0,t.jsx)(n.code,{children:"engine.type"})," option, but there are more available engine type specific options. We have a chapter dedicated to engines - ",(0,t.jsx)(n.a,{href:"/docs/server/engines",children:"Engines and Scalability"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"enginetype",children:"engine.type"}),"\n",(0,t.jsx)(n.p,{children:"Default: memory"}),"\n",(0,t.jsx)(n.p,{children:"By default, all Centrifugo PUB/SUB, channel history cache, online presence features are managed by in-memory engine:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "engine": {\n    "type": "memory"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["There is a possibility to use ",(0,t.jsx)(n.code,{children:"redis"})," type for an alternative full-featured engine implementation based on ",(0,t.jsx)(n.a,{href:"https://redis.io/",children:"Redis"}),". Centrifugo also provides an integration with ",(0,t.jsx)(n.a,{href:"https://nats.io/",children:"Nats"})," server for at most once delivery cases. See more details in a dedicated chapter ",(0,t.jsx)(n.a,{href:"/docs/server/engines",children:"Engines and Scalability"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"broker-config",children:"Broker config"}),"\n",(0,t.jsxs)(n.p,{children:["Centrifugo v6 introduced a new way to set a separate broker responsible for PUB/SUB and history cache related operations \u2013 using ",(0,t.jsx)(n.code,{children:"broker"})," section of config."]}),"\n",(0,t.jsx)(n.p,{children:"Once a separate broker configured it will be used for Broker part instead of Engine's Broker part."}),"\n",(0,t.jsxs)(n.p,{children:["See more description of available options inside the section in ",(0,t.jsx)(n.a,{href:"/docs/server/engines#separate-broker-and-presence-manager",children:"Engines and Scalability"})," chapter."]}),"\n",(0,t.jsx)(n.h2,{id:"presence-manager-config",children:"Presence Manager config"}),"\n",(0,t.jsxs)(n.p,{children:["Centrifugo v6 introduced a new way to set a separate presence manager responsible for online presence management \u2013 using ",(0,t.jsx)(n.code,{children:"presence_manager"})," section of config."]}),"\n",(0,t.jsx)(n.p,{children:"Once a separate presence manager configured it will be used for Presence Manager part instead of Engine's Presence Manager part."}),"\n",(0,t.jsxs)(n.p,{children:["See more description of available options inside the section in ",(0,t.jsx)(n.a,{href:"/docs/server/engines#separate-broker-and-presence-manager",children:"Engines and Scalability"})," chapter."]}),"\n",(0,t.jsx)(n.h2,{id:"server-http-api-config",children:"Server HTTP API config"}),"\n",(0,t.jsxs)(n.p,{children:["Options related to server HTTP API may be set under ",(0,t.jsx)(n.code,{children:"http_api"})," section of configuration."]}),"\n",(0,t.jsxs)(n.p,{children:["See more details in ",(0,t.jsx)(n.a,{href:"/docs/server/server_api",children:"dedicated chapter"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "http_api": {\n    ...\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"server-grpc-api-config",children:"Server GRPC API config"}),"\n",(0,t.jsxs)(n.p,{children:["Options related to server HTTP API may be set under ",(0,t.jsx)(n.code,{children:"grpc_api"})," section of configuration."]}),"\n",(0,t.jsxs)(n.p,{children:["See more details in ",(0,t.jsx)(n.a,{href:"/docs/server/server_api",children:"dedicated chapter"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "grpc_api": {\n    ...\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"client-connection-config",children:"Client connection config"}),"\n",(0,t.jsxs)(n.p,{children:["Client connection options may be set under ",(0,t.jsx)(n.code,{children:"client"})," section of configuration:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    ...\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"clientallowed_origins",children:"client.allowed_origins"}),"\n",(0,t.jsx)(n.p,{children:"Default: empty array."}),"\n",(0,t.jsxs)(n.p,{children:["This option allows setting an array of allowed origin patterns (array of strings) for WebSocket endpoints to prevent ",(0,t.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Cross-site_request_forgery",children:"CSRF"})," or WebSocket hijacking attacks. Also, it's used for HTTP-based unidirectional transports to enable CORS for configured origins."]}),"\n",(0,t.jsxs)(n.p,{children:["As soon as ",(0,t.jsx)(n.code,{children:"client.allowed_origins"})," is defined every connection request with ",(0,t.jsx)(n.code,{children:"Origin"})," set will be checked against each pattern in an array."]}),"\n",(0,t.jsxs)(n.p,{children:["Connection requests without ",(0,t.jsx)(n.code,{children:"Origin"})," header set are passing through without any checks (i.e. always allowed). Those originate from non-browser environment, so non-related to the mentioned security concerns."]}),"\n",(0,t.jsxs)(n.p,{children:["For example, a client connects to Centrifugo from a web browser application on ",(0,t.jsx)(n.code,{children:"http://localhost:3000"}),". In this case, ",(0,t.jsx)(n.code,{children:"client.allowed_origins"})," should be configured in this way:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    "allowed_origins": [\n      "http://localhost:3000"\n    ]\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["When connecting from ",(0,t.jsx)(n.code,{children:"https://example.com"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    "allowed_origins": [\n      "https://example.com"\n    ]\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Origin pattern can contain wildcard symbol ",(0,t.jsx)(n.code,{children:"*"})," to match subdomains:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    "allowed_origins": [\n      "https://*.example.com"\n    ]\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u2013 in this case requests with ",(0,t.jsx)(n.code,{children:"Origin"})," header like ",(0,t.jsx)(n.code,{children:"https://foo.example.com"})," or ",(0,t.jsx)(n.code,{children:"https://bar.example.com"})," will pass the check."]}),"\n",(0,t.jsx)(n.p,{children:"It's also possible to allow all origins in the following way (but this is discouraged and insecure when using connect proxy feature):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    "allowed_origins": [\n      "*"\n    ]\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"clienttoken",children:"client.token"}),"\n",(0,t.jsxs)(n.p,{children:["The section ",(0,t.jsx)(n.code,{children:"client.token"})," contains options for client connection and subscription JWT auth. See more details in ",(0,t.jsx)(n.a,{href:"/docs/server/authentication",children:"JWT authentication"})," and ",(0,t.jsx)(n.a,{href:"/docs/server/channel_token_auth",children:"Channel JWT authorization"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"clientsubscription_token",children:"client.subscription_token"}),"\n",(0,t.jsxs)(n.p,{children:["It's possible to use separate token options for channel subscription \u2013 see details ",(0,t.jsx)(n.a,{href:"/docs/server/channel_token_auth#separate-subscription-token-config",children:"here"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"clientproxyconnect",children:"client.proxy.connect"}),"\n",(0,t.jsxs)(n.p,{children:["The configuration object for proxy to use for connect events. See how to configure ",(0,t.jsx)(n.a,{href:"/docs/server/proxy",children:"event proxies"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"clientproxyrefresh",children:"client.proxy.refresh"}),"\n",(0,t.jsxs)(n.p,{children:["The configuration object for proxy to use for refresh events. See how to configure ",(0,t.jsx)(n.a,{href:"/docs/server/proxy",children:"event proxies"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"clientping_interval",children:"client.ping_interval"}),"\n",(0,t.jsxs)(n.p,{children:["Interval to send pings to clients \u2013 see ",(0,t.jsx)(n.a,{href:"/docs/transports/overview#pingpong-behavior",children:"more about ping/pong"})]}),"\n",(0,t.jsx)(n.h3,{id:"clientpong_timeout",children:"client.pong_timeout"}),"\n",(0,t.jsxs)(n.p,{children:["Timeout to wait pong from clients after sending ping to them \u2013 see ",(0,t.jsx)(n.a,{href:"/docs/transports/overview#pingpong-behavior",children:"more about ping/pong"})]}),"\n",(0,t.jsx)(n.h3,{id:"clientqueue_max_size",children:"client.queue_max_size"}),"\n",(0,t.jsx)(n.p,{children:"Each client connection has individual message queue, this is the size of that queue in bytes. Default: 1048576 bytes (1MB)."}),"\n",(0,t.jsx)(n.h3,{id:"clienthistory_max_publication_limit",children:"client.history_max_publication_limit"}),"\n",(0,t.jsx)(n.p,{children:"Default: 300"}),"\n",(0,t.jsxs)(n.p,{children:["Limit for the max number of publications to be returned via client protocol. See more in ",(0,t.jsx)(n.a,{href:"/docs/server/history_and_recovery",children:"History and recovery"})]}),"\n",(0,t.jsx)(n.h3,{id:"clientrecovery_max_publication_limit",children:"client.recovery_max_publication_limit"}),"\n",(0,t.jsx)(n.p,{children:"Default: 300"}),"\n",(0,t.jsxs)(n.p,{children:["Limit for the max number of publications to be recovered via client protocol. See more in ",(0,t.jsx)(n.a,{href:"/docs/server/history_and_recovery",children:"History and recovery"})]}),"\n",(0,t.jsx)(n.h3,{id:"clientchannel_limit",children:"client.channel_limit"}),"\n",(0,t.jsx)(n.p,{children:"Default: 128"}),"\n",(0,t.jsx)(n.p,{children:"Sets the maximum number of different channel subscriptions a single client can have."}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"When designing an application avoid subscribing to an unlimited number of channels per one client. Keep number of subscriptions for each client reasonably small \u2013 this will help keeping handshake process lightweight and fast."})}),"\n",(0,t.jsx)(n.h3,{id:"clientuser_connection_limit",children:"client.user_connection_limit"}),"\n",(0,t.jsx)(n.p,{children:"Default: 0"}),"\n",(0,t.jsx)(n.p,{children:"The maximum number of connections from a user (with known user ID) to Centrifugo node. By default, unlimited."}),"\n",(0,t.jsxs)(n.p,{children:["The important thing to emphasize is that ",(0,t.jsx)(n.code,{children:"client_user_connection_limit"})," works only per one Centrifugo node and exists mostly to protect Centrifugo from many connections from a single user \u2013 but not for business logic limitations. This means that if you set this to 1 and scale nodes \u2013 say run 10 Centrifugo nodes \u2013 then a user will be able to create 10 connections (one to each node)."]}),"\n",(0,t.jsx)(n.h3,{id:"clientconnection_limit",children:"client.connection_limit"}),"\n",(0,t.jsx)(n.p,{children:"Default: 0"}),"\n",(0,t.jsxs)(n.p,{children:["When set to a value > 0 ",(0,t.jsx)(n.code,{children:"client.connection_limit"})," limits the max number of connections single Centrifugo node can handle. It acts on HTTP middleware level and stops processing request if the condition met. It logs a warning into logs in this case and increments ",(0,t.jsx)(n.code,{children:"centrifugo_node_client_connection_limit"})," Prometheus counter. Client SDKs will attempt reconnecting."]}),"\n",(0,t.jsxs)(n.p,{children:["Some motivation behind this option may be found in ",(0,t.jsx)(n.a,{href:"https://github.com/centrifugal/centrifugo/issues/544",children:"this issue"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Note, that at this point ",(0,t.jsx)(n.code,{children:"client.connection_limit"})," does not affect connections coming over GRPC unidirectional transport."]}),"\n",(0,t.jsx)(n.h3,{id:"clientconnection_rate_limit",children:"client.connection_rate_limit"}),"\n",(0,t.jsx)(n.p,{children:"Default: 0"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"client.connection_rate_limit"})," sets the maximum number of HTTP requests to establish a new real-time connection a single Centrifugo node will accept per second (on real-time transport endpoints). All requests outside the limit will get 503 Service Unavailable code in response. Our SDKs handle this with backoff reconnection."]}),"\n",(0,t.jsx)(n.p,{children:"By default, no limit is used."}),"\n",(0,t.jsxs)(n.p,{children:["Note, that at this point ",(0,t.jsx)(n.code,{children:"client.connection_rate_limit"})," does not affect connections coming over GRPC unidirectional transport."]}),"\n",(0,t.jsx)(n.h3,{id:"clientqueue_max_size-1",children:"client.queue_max_size"}),"\n",(0,t.jsx)(n.p,{children:"Default: 1048576"}),"\n",(0,t.jsx)(n.p,{children:"Maximum client message queue size in bytes to close slow reader connections. By default - 1mb."}),"\n",(0,t.jsx)(n.h3,{id:"clientconcurrency",children:"client.concurrency"}),"\n",(0,t.jsx)(n.p,{children:"Default: 0"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"client.concurrency"})," when set tells Centrifugo that commands from a client must be processed concurrently."]}),"\n",(0,t.jsxs)(n.p,{children:["By default, concurrency disabled \u2013 Centrifugo processes commands received from a client one by one. This means that if a client issues two RPC requests to a server then Centrifugo will process the first one, then the second one. If the first RPC call is slow then the client will wait for the second RPC response much longer than it could (even if the second RPC is very fast). If you set ",(0,t.jsx)(n.code,{children:"client.concurrency"})," to some value greater than 1 then commands will be processed concurrently (in parallel) in separate goroutines (with maximum concurrency level capped by ",(0,t.jsx)(n.code,{children:"client.concurrency"})," value). Thus, this option can effectively reduce the latency of individual requests. Since separate goroutines are involved in processing this mode adds some performance and memory overhead \u2013 though it should be pretty negligible in most cases. This option applies to all commands from a client (including subscribe, publish, presence, etc)."]}),"\n",(0,t.jsx)(n.h3,{id:"clientstale_close_delay",children:"client.stale_close_delay"}),"\n",(0,t.jsx)(n.p,{children:"Duration, default: 10s"}),"\n",(0,t.jsx)(n.p,{children:"This option allows tuning the maximum time Centrifugo will wait for the connect frame (which contains authentication information) from the client after establishing connection. Default value should be reasonable for most use cases."}),"\n",(0,t.jsx)(n.h3,{id:"clientuser_id_http_header",children:"client.user_id_http_header"}),"\n",(0,t.jsxs)(n.p,{children:["String, default: ",(0,t.jsx)(n.code,{children:'""'})]}),"\n",(0,t.jsxs)(n.p,{children:["Usually to authenticate client connections with Centrifugo you need to use ",(0,t.jsx)(n.a,{href:"/docs/server/authentication",children:"JWT authentication"})," or ",(0,t.jsx)(n.a,{href:"/docs/server/proxy#connect-proxy",children:"connect proxy"}),". Sometimes though it may be convenient to pass user ID information in incoming HTTP request headers. This is usually the case when application backend infrastructure has some authentication proxy (like Envoy, etc). This proxy may set authenticated user ID to some header and proxy requests further to Centrifugo."]}),"\n",(0,t.jsxs)(n.p,{children:["When ",(0,t.jsx)(n.code,{children:"client.user_id_http_header"})," is set to some non-empty header name Centrifugo will try to extract the authenticated user ID for client connections from that header. This mechanism works for all real-time transports based on HTTP (this also includes WebSocket since it starts with HTTP Upgrade request). Example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    "user_id_http_header": "X-User-Id"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"When using this way for user authentication \u2013 you can not set connection expiration and additional connection info which is possible to do using other authentication ways mentioned above."}),"\n",(0,t.jsx)(n.admonition,{title:"Security warning",type:"caution",children:(0,t.jsx)(n.p,{children:"When using authentication over proxy ensure your proxy strips the header you are using for auth if it comes from the client or forbids such requests to avoid malicious usage. Only your authentication proxy must set the header with user ID."})}),"\n",(0,t.jsx)(n.h3,{id:"clientconnect_include_server_time",children:"client.connect_include_server_time"}),"\n",(0,t.jsxs)(n.p,{children:["Boolean, default: ",(0,t.jsx)(n.code,{children:"false"})]}),"\n",(0,t.jsxs)(n.p,{children:["When enabled, Centrifugo attaches ",(0,t.jsx)(n.code,{children:"time"})," field to the connect reply (or connect push in the unidirectional transport case). This field contains current server time as Unix milliseconds. Ex. ",(0,t.jsx)(n.code,{children:"1716198604052"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"clientallow_anonymous_connect_without_token",children:"client.allow_anonymous_connect_without_token"}),"\n",(0,t.jsxs)(n.p,{children:["Boolean, default: ",(0,t.jsx)(n.code,{children:"false"})]}),"\n",(0,t.jsx)(n.p,{children:"Enable a mode when all clients can connect to Centrifugo without JWT. In this case, all connections without a token will be treated as anonymous (i.e. with empty user ID). Access to channel operations should be explicitly enabled for anonymous connections."}),"\n",(0,t.jsx)(n.h3,{id:"clientdisallow_anonymous_connection_tokens",children:"client.disallow_anonymous_connection_tokens"}),"\n",(0,t.jsxs)(n.p,{children:["Boolean, default: ",(0,t.jsx)(n.code,{children:"false"})]}),"\n",(0,t.jsxs)(n.p,{children:["When the option is set Centrifugo won't accept connections from anonymous users even if they provided a valid JWT. I.e. if token is valid, but ",(0,t.jsx)(n.code,{children:"sub"})," claim is empty \u2013 then Centrifugo closes connection with advice to not reconnect again."]}),"\n",(0,t.jsx)(n.h3,{id:"clientsubscribe_to_user_personal_channel",children:"client.subscribe_to_user_personal_channel"}),"\n",(0,t.jsxs)(n.p,{children:["An object to configure user personal channel subscription and optionally enable single connection from user. See ",(0,t.jsx)(n.a,{href:"/docs/server/server_subs#automatic-personal-channel-subscription",children:"dedicated description"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"channel-configuration",children:"Channel configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Let's describe some options for the ",(0,t.jsx)(n.code,{children:"channel"})," section."]}),"\n",(0,t.jsx)(n.h3,{id:"channelwithout_namespace",children:"channel.without_namespace"}),"\n",(0,t.jsxs)(n.p,{children:["This is an object with ",(0,t.jsx)(n.a,{href:"/docs/server/channels#channel-options",children:"channel options"})," which are applied to all channels which do not belong to any namespace."]}),"\n",(0,t.jsx)(n.h3,{id:"channelnamespaces",children:"channel.namespaces"}),"\n",(0,t.jsxs)(n.p,{children:["This is an array of objects with to configure ",(0,t.jsx)(n.a,{href:"/docs/server/channels#channel-namespaces",children:"channel namespaces"}),". Each object in the array represents a namespace. Namespaces allow you to apply specific options to a group of channels starting with a namespace name."]}),"\n",(0,t.jsx)(n.h3,{id:"channelhistory_meta_ttl",children:"channel.history_meta_ttl"}),"\n",(0,t.jsxs)(n.p,{children:["Duration, default ",(0,t.jsx)(n.code,{children:'"720h"'}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["This option is a time to keep history meta information for channels when publication history is used. This value must be bigger than max ",(0,t.jsx)(n.code,{children:"history_ttl"})," in all channel namespaces."]}),"\n",(0,t.jsx)(n.p,{children:"The motivation to have history meta information TTL is as follows. When using a history in a channel, Centrifugo keeps some metadata for each channel stream. Metadata includes the latest stream offset and its epoch value. In some cases, when channels are created for \u0430 short time and then not used anymore, created metadata can stay in memory while not useful. For example, you can have a personal user channel but after using your app for a while user left it forever. From a long-term perspective, this can be an unwanted memory growth. Setting a reasonable value to this option can help to expire metadata faster (or slower if you need it)."}),"\n",(0,t.jsxs)(n.p,{children:["It's possible to redefine ",(0,t.jsx)(n.code,{children:"history_meta_ttl"})," on channel namespace level."]}),"\n",(0,t.jsx)(n.h3,{id:"channelproxysubscribe",children:"channel.proxy.subscribe"}),"\n",(0,t.jsxs)(n.p,{children:["The configuration object for proxy to use for channel subscribe events. See how to configure ",(0,t.jsx)(n.a,{href:"/docs/server/proxy",children:"event proxies"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"channelproxypublish",children:"channel.proxy.publish"}),"\n",(0,t.jsxs)(n.p,{children:["The configuration object for proxy to use for channel publish events. See how to configure ",(0,t.jsx)(n.a,{href:"/docs/server/proxy",children:"event proxies"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"channelproxysub_refresh",children:"channel.proxy.sub_refresh"}),"\n",(0,t.jsxs)(n.p,{children:["The configuration object for proxy to use for channel sub refresh events. See how to configure ",(0,t.jsx)(n.a,{href:"/docs/server/proxy",children:"event proxies"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"channelproxysubscribe_stream",children:"channel.proxy.subscribe_stream"}),"\n",(0,t.jsxs)(n.p,{children:["The configuration object for proxy to use for channel subscribe stream. See how to configure in ",(0,t.jsx)(n.a,{href:"/docs/server/proxy_streams",children:"Proxy subscription streams"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"channelproxystate",children:"channel.proxy.state"}),"\n",(0,t.jsxs)(n.p,{children:["The configuration object for proxy to use for channel state events. Centrifugo PRO only \u2013 see ",(0,t.jsx)(n.a,{href:"/docs/pro/channel_state_events",children:"docs"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"chanelproxycache_empty",children:"chanel.proxy.cache_empty"}),"\n",(0,t.jsxs)(n.p,{children:["The configuration object for proxy to use for cache empty events. Centrifugo PRO only \u2013 see ",(0,t.jsx)(n.a,{href:"/docs/pro/channel_cache_empty",children:"docs"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"channelmax_length",children:"channel.max_length"}),"\n",(0,t.jsx)(n.p,{children:"Default: 255"}),"\n",(0,t.jsx)(n.p,{children:"Sets the maximum length of the channel name."}),"\n",(0,t.jsx)(n.h2,{id:"client-rpc-configuration",children:"Client RPC configuration"}),"\n",(0,t.jsxs)(n.p,{children:["The section ",(0,t.jsx)(n.code,{children:"rpc"})," of configuration file allows configuring options for client initiated RPC calls."]}),"\n",(0,t.jsx)(n.h3,{id:"rpcwithout_namespace",children:"rpc.without_namespace"}),"\n",(0,t.jsxs)(n.p,{children:["Analogous to ",(0,t.jsx)(n.code,{children:"channel.without_namespace"})," but for client RPC calls."]}),"\n",(0,t.jsx)(n.h3,{id:"rpcnamespaces",children:"rpc.namespaces"}),"\n",(0,t.jsxs)(n.p,{children:["Analogous to ",(0,t.jsx)(n.code,{children:"channel.namespaces"})," but for client RPC calls."]}),"\n",(0,t.jsx)(n.h3,{id:"rpcnamespace_boundary",children:"rpc.namespace_boundary"}),"\n",(0,t.jsxs)(n.p,{children:["String, default ",(0,t.jsx)(n.code,{children:'":"'}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Analogue to ",(0,t.jsx)(n.code,{children:"channel.namespace_boundary"})," but for client RPC calls."]}),"\n",(0,t.jsx)(n.h3,{id:"rpcping",children:"rpc.ping"}),"\n",(0,t.jsxs)(n.p,{children:["Sometimes you may need a way to just ping Centrifugo server from the client-side. For example, some Centrifugo users wanted this to show RTT time to server in UI. It's possible to enable RPC extension which simply returns an empty reply to RPC ",(0,t.jsx)(n.code,{children:"ping"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "rpc": {\n    "ping": {\n      "enabled": true\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"After that, on SDK side you can do sth like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const startTime = performance.now();\ncentrifuge.rpc('ping', {}).then(function() {\n  const endTime = performance.now();\n  console.log('rtt', ((endTime - startTime)).toFixed(2).toString(), 'ms');  // Output: rtt 0.90 ms\n})\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If you are not happy with method name ",(0,t.jsx)(n.code,{children:"ping"})," \u2013 you can use a different one by setting ",(0,t.jsx)(n.code,{children:"rpc.ping_method"})," option to a string you want:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "rpc": {\n    "ping": {\n      "enabled": true,\n      "method": "rtt"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"real-time-transports",children:"Real-time transports"}),"\n",(0,t.jsx)(n.p,{children:"Centrifugo supports various real-time transports for client connections. Each transport has specific configuration options."}),"\n",(0,t.jsx)(n.h3,{id:"websocket",children:"websocket"}),"\n",(0,t.jsxs)(n.p,{children:["WebSocket transport related options can be defined under ",(0,t.jsx)(n.code,{children:"websocket"})," section of config."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/transports/websocket",children:"WebSocket"})," chapter for all the configuration options."]}),"\n",(0,t.jsx)(n.h3,{id:"sse",children:"sse"}),"\n",(0,t.jsxs)(n.p,{children:["SSE transport related options can be defined under ",(0,t.jsx)(n.code,{children:"sse"})," section of config."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/transports/sse",children:"SSE (EventSource), with bidirectional emulation"})," chapter for all the configuration options."]}),"\n",(0,t.jsx)(n.h3,{id:"http_stream",children:"http_stream"}),"\n",(0,t.jsxs)(n.p,{children:["HTTP-streaming transport related options can be defined under ",(0,t.jsx)(n.code,{children:"http_stream"})," section of config."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/transports/http_stream",children:"HTTP streaming, with bidirectional emulation"})," chapter for all the configuration options."]}),"\n",(0,t.jsx)(n.h3,{id:"webtransport",children:"webtransport"}),"\n",(0,t.jsxs)(n.p,{children:["WebTransport transport related options can be defined under ",(0,t.jsx)(n.code,{children:"webtransport"})," section of config."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/transports/webtransport",children:"WebTransport"})," chapter for all the configuration options."]}),"\n",(0,t.jsx)(n.h3,{id:"uni_websocket",children:"uni_websocket"}),"\n",(0,t.jsxs)(n.p,{children:["Unidirectional WebSocket transport related options can be defined under ",(0,t.jsx)(n.code,{children:"uni_websocket"})," section of config."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/transports/uni_websocket",children:"unidirectional WebSocket"})," chapter for all the configuration options."]}),"\n",(0,t.jsx)(n.h3,{id:"uni_sse",children:"uni_sse"}),"\n",(0,t.jsxs)(n.p,{children:["Unidirectional SSE transport related options can be defined under ",(0,t.jsx)(n.code,{children:"uni_sse"})," section of config."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/transports/uni_sse",children:"Unidirectional SSE"})," chapter for all the configuration options."]}),"\n",(0,t.jsx)(n.h3,{id:"uni_http_stream",children:"uni_http_stream"}),"\n",(0,t.jsxs)(n.p,{children:["Unidirectional HTTP-streaming transport related options can be defined under ",(0,t.jsx)(n.code,{children:"uni_http_stream"})," section of config."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/transports/uni_http_stream",children:"Unidirectional HTTP-streaming"})," chapter for all the configuration options."]}),"\n",(0,t.jsx)(n.h3,{id:"uni_grpc",children:"uni_grpc"}),"\n",(0,t.jsxs)(n.p,{children:["Unidirectional GRPC transport related options can be defined under ",(0,t.jsx)(n.code,{children:"uni_grpc"})," section of config."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/transports/uni_grpc",children:"Unidirectional GRPC"})," chapter for all the configuration options."]}),"\n",(0,t.jsx)(n.h2,{id:"emulation-config",children:"Emulation config"}),"\n",(0,t.jsxs)(n.p,{children:["Emulation endpoint enables automatically as soon as ",(0,t.jsx)(n.code,{children:"http_stream.enabled"})," or ",(0,t.jsx)(n.code,{children:"sse.enabled"})," set to ",(0,t.jsx)(n.code,{children:"true"}),". It's required for\nbidirectional emulation over HTTP-streaming and SSE to handle client to server part of communication."]}),"\n",(0,t.jsx)(n.h3,{id:"emulationmax_request_body_size",children:"emulation.max_request_body_size"}),"\n",(0,t.jsx)(n.p,{children:"Default: 65536"}),"\n",(0,t.jsx)(n.p,{children:"Maximum size of POST request body in bytes for bidirectional emulation endpoint."}),"\n",(0,t.jsx)(n.h2,{id:"admin-ui-config",children:"Admin UI config"}),"\n",(0,t.jsxs)(n.p,{children:["Admin web UI endpoint works on root path by default, i.e. ",(0,t.jsx)(n.code,{children:"http://localhost:8000"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["For more details about admin web UI, refer to the ",(0,t.jsx)(n.a,{href:"/docs/server/admin_web",children:"Admin web UI documentation"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"adminenabled",children:"admin.enabled"}),"\n",(0,t.jsxs)(n.p,{children:["Boolean, default ",(0,t.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["When set to ",(0,t.jsx)(n.code,{children:"true"})," Centrifugo will serve an admin web interface. This interface is useful for monitoring and managing Centrifugo server. It's a single-page application built with ReactJS, it's embedded to Centrifugo binary \u2013 so you don't need to serve any additional files."]}),"\n",(0,t.jsx)(n.h2,{id:"debug-config",children:"Debug config"}),"\n",(0,t.jsxs)(n.p,{children:["Next, when Centrifugo started in debug mode some extra debug endpoints become available. To start in debug mode add ",(0,t.jsx)(n.code,{children:"debug"})," option to config:"]}),"\n",(0,t.jsx)(n.h3,{id:"debugenabled",children:"debug.enabled"}),"\n",(0,t.jsxs)(n.p,{children:["Boolean, default ",(0,t.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["When set to ",(0,t.jsx)(n.code,{children:"true"})," Centrifugo will serve debug endpoints. For example, with the following config:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  ...\n  "debug": {\n    "enabled": true\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u2013 the endpoint:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"http://localhost:8000/debug/pprof/\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u2013 will show useful information about the internal state of Centrifugo instance. This info is especially helpful when troubleshooting. See ",(0,t.jsx)(n.a,{href:"https://github.com/centrifugal/centrifugo/wiki/Investigating-performance-issues",children:"wiki page"})," for more info."]}),"\n",(0,t.jsx)(n.h2,{id:"health-config",children:"Health config"}),"\n",(0,t.jsx)(n.p,{children:"Health endpoint configuration \u2013 useful for K8S liveness and readiness probes."}),"\n",(0,t.jsx)(n.h3,{id:"healthenabled",children:"health.enabled"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"health.enabled"})," boolean option (by default ",(0,t.jsx)(n.code,{children:"false"}),") to enable the health check endpoint which will be available on path ",(0,t.jsx)(n.code,{children:"/health"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  ...\n  "health": {\n    "enabled": true\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"prometheus-config",children:"Prometheus config"}),"\n",(0,t.jsx)(n.p,{children:"Prometheus endpoint configuration \u2013 useful for monitoring Centrifugo with Prometheus."}),"\n",(0,t.jsx)(n.h3,{id:"prometheusenabled",children:"prometheus.enabled"}),"\n",(0,t.jsxs)(n.p,{children:["The option ",(0,t.jsx)(n.code,{children:"prometheus.enabled"})," (by default ",(0,t.jsx)(n.code,{children:"false"}),") allows enabling the Prometheus endpoint. Metrics are then available on path ",(0,t.jsx)(n.code,{children:"/metrics"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  ...\n  "prometheus": {\n    "enabled": true\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"prometheusinstrument_http_handlers",children:"prometheus.instrument_http_handlers"}),"\n",(0,t.jsxs)(n.p,{children:["Boolean, default ",(0,t.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["When set to ",(0,t.jsx)(n.code,{children:"true"})," Centrifugo will instrument HTTP handlers with additional Prometheus metrics \u2013 at this point only the number of requests to specific handler with status code resolution. This can be useful to get more detailed information about the number of HTTP requests to Centrifugo. Comes with a small overhead, thus disabled by default."]}),"\n",(0,t.jsx)(n.h2,{id:"swagger-ui-config",children:"Swagger UI config"}),"\n",(0,t.jsx)(n.h3,{id:"swaggerenabled",children:"swagger.enabled"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"swagger.enabled"})," boolean option (by default ",(0,t.jsx)(n.code,{children:"false"}),") to enable Swagger UI for ",(0,t.jsx)(n.a,{href:"/docs/server/server_api",children:"server HTTP API"}),". UI will be available on path ",(0,t.jsx)(n.code,{children:"/swagger"}),". Also available over command-line flag:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  ...\n  "swagger": {\n    "enabled": true\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"miscellaneous-options",children:"Miscellaneous options"}),"\n",(0,t.jsx)(n.h3,{id:"pid_file",children:"pid_file"}),"\n",(0,t.jsxs)(n.p,{children:["Path to a file where Centrifugo will write its PID (string, by default ",(0,t.jsx)(n.code,{children:'""'})," \u2013 not used)."]}),"\n",(0,t.jsx)(n.h2,{id:"insecure-options",children:"Insecure options"}),"\n",(0,t.jsx)(n.p,{children:"The following options may simplify integration with Centrifugo, but they are mostly intended for development. In case of using in production \u2013 please make sure you understand the possible security risks."}),"\n",(0,t.jsx)(n.h3,{id:"clientinsecure",children:"client.insecure"}),"\n",(0,t.jsxs)(n.p,{children:["The boolean option ",(0,t.jsx)(n.code,{children:"client.insecure"})," (default ",(0,t.jsx)(n.code,{children:"false"}),") allows connecting to Centrifugo without JWT token. In this mode, there is no user authentication involved. It also disables permission checks on client API level - for presence and history calls. This mode can be useful for demo projects based on Centrifugo, integration tests, local projects, or real-time application prototyping. Don't use it in production until you 100% know what you are doing."]}),"\n",(0,t.jsx)(n.h3,{id:"clientinsecure_skip_token_signature_verify",children:"client.insecure_skip_token_signature_verify"}),"\n",(0,t.jsxs)(n.p,{children:["The boolean option ",(0,t.jsx)(n.code,{children:"client.insecure_skip_token_signature_verify"})," (default ",(0,t.jsx)(n.code,{children:"false"}),"), if enabled \u2013 tells Centrifugo to skip JWT signature verification - for both connection and subscription tokens. This is absolutely ",(0,t.jsx)(n.strong,{children:"insecure"})," and must only be used for development and testing purposes. Token claims are parsed as usual - so token should still follow JWT format."]}),"\n",(0,t.jsx)(n.h3,{id:"http_apiinsecure",children:"http_api.insecure"}),"\n",(0,t.jsxs)(n.p,{children:["This mode can be enabled using the boolean option ",(0,t.jsx)(n.code,{children:"http_api.insecure"})," (default ",(0,t.jsx)(n.code,{children:"false"}),"). When on there is no need to provide API key in HTTP requests. When using this mode everyone that has access to ",(0,t.jsx)(n.code,{children:"/api"})," endpoint can send any command to server. Enabling this option can be reasonable if ",(0,t.jsx)(n.code,{children:"/api"})," endpoint is protected by firewall rules."]}),"\n",(0,t.jsxs)(n.p,{children:["The option is also useful in development to simplify sending API commands to Centrifugo using CURL for example without specifying ",(0,t.jsx)(n.code,{children:"Authorization"})," header in requests."]}),"\n",(0,t.jsx)(n.h3,{id:"admininsecure",children:"admin.insecure"}),"\n",(0,t.jsxs)(n.p,{children:["This mode can be enabled using the boolean option ",(0,t.jsx)(n.code,{children:"admin.insecure"})," (default ",(0,t.jsx)(n.code,{children:"false"}),"). When on there is no authentication in the admin web interface. Again - this is not secure but can be justified if you protected the admin interface by firewall rules or you want to use basic authentication for the Centrifugo admin interface (configured on proxy level)."]}),"\n",(0,t.jsx)(n.h2,{id:"custom-internal-port",children:"Custom internal port"}),"\n",(0,t.jsx)(n.p,{children:"We strongly recommend not expose API, admin, debug, health, and Prometheus endpoints to the Internet. The following Centrifugo endpoints are considered internal:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["HTTP API endpoint (",(0,t.jsx)(n.code,{children:"/api"}),") - for HTTP API requests"]}),"\n",(0,t.jsxs)(n.li,{children:["Admin web interface endpoints (",(0,t.jsx)(n.code,{children:"/"}),", ",(0,t.jsx)(n.code,{children:"/admin/auth"}),", ",(0,t.jsx)(n.code,{children:"/admin/api"}),") - used by web interface"]}),"\n",(0,t.jsxs)(n.li,{children:["Prometheus endpoint (",(0,t.jsx)(n.code,{children:"/metrics"}),") - used for exposing server metrics in Prometheus format"]}),"\n",(0,t.jsxs)(n.li,{children:["Health check endpoint (",(0,t.jsx)(n.code,{children:"/health"}),") - used to do health checks"]}),"\n",(0,t.jsxs)(n.li,{children:["Debug endpoints (",(0,t.jsx)(n.code,{children:"/debug/pprof"}),") - used to inspect internal server state"]}),"\n",(0,t.jsxs)(n.li,{children:["Swagger UI endpoint (",(0,t.jsx)(n.code,{children:"/swagger"}),") - used for showing embedded Swagger UI for server HTTP API"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["It's a good practice to protect all these endpoints with a firewall. For example, it's possible to configure in ",(0,t.jsx)(n.code,{children:"location"})," section of the Nginx configuration."]}),"\n",(0,t.jsx)(n.p,{children:"Though sometimes you don't have access to a per-location configuration in your proxy/load balancer software. For example when using Amazon ELB. In this case, you can change ports on which your internal endpoints work."}),"\n",(0,t.jsxs)(n.p,{children:["To run internal endpoints on custom port use ",(0,t.jsx)(n.code,{children:"internal_port"})," option:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n    ...\n    "internal_port": 9000\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"So admin web interface will work on address:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"http://localhost:9000\n"})}),"\n",(0,t.jsx)(n.p,{children:"Also, debug page will be available on a new custom port too:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"http://localhost:9000/debug/pprof/\n"})}),"\n",(0,t.jsx)(n.p,{children:"The same for API and Prometheus endpoints."}),"\n",(0,t.jsx)(n.h2,{id:"endpoint-management",children:"Endpoint management"}),"\n",(0,t.jsx)(n.p,{children:"This part is about Centrifugo endpoints and possibility to tweak them."}),"\n",(0,t.jsx)(n.h3,{id:"default-endpoints",children:"Default endpoints"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/transports/websocket",children:"Bidirectional WebSocket"})," default endpoint:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ws://localhost:8000/connection/websocket\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/transports/http_stream",children:"Bidirectional emulation with HTTP-streaming"})," (disabled by default):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ws://localhost:8000/connection/http_stream\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/transports/sse",children:"Bidirectional emulation with SSE"})," (EventSource) (disabled by default):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ws://localhost:8000/connection/sse\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/transports/uni_sse",children:"Unidirectional EventSource"})," endpoint (disabled by default):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"http://localhost:8000/connection/uni_sse\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/transports/uni_http_stream",children:"Unidirectional HTTP streaming"})," endpoint (disabled by default):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"http://localhost:8000/connection/uni_http_stream\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/transports/uni_websocket",children:"Unidirectional WebSocket"})," endpoint (disabled by default):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"http://localhost:8000/connection/uni_websocket\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/docs/server/server_api",children:"Server HTTP API"})," endpoint:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"http://localhost:8000/api\n"})}),"\n",(0,t.jsxs)(n.p,{children:["By default, all endpoints work on port ",(0,t.jsx)(n.code,{children:"8000"}),". This can be changed with ",(0,t.jsx)(n.a,{href:"#http_serverport",children:"port"})," option:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  ...\n  "port": 9000\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["In production setup, you may have a proper domain name in endpoint addresses above instead of ",(0,t.jsx)(n.code,{children:"localhost"}),". While domain name and port parts can differ depending on setup \u2013 URL paths stay the same: ",(0,t.jsx)(n.code,{children:"/connection/websocket"}),", ",(0,t.jsx)(n.code,{children:"/api"})," etc."]}),"\n",(0,t.jsxs)(n.p,{children:["It's possible to redefine endpoint HTTP path prefixes using ",(0,t.jsx)(n.a,{href:"#customize-handler-prefixes",children:"custom handler prefixes"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"customize-handler-prefixes",children:"Customize handler prefixes"}),"\n",(0,t.jsx)(n.p,{children:"It's possible to customize server HTTP handler endpoints. To do this Centrifugo supports several options:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"admin.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'""'}),") - to control Admin panel URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"websocket.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/connection/websocket"'}),") - to control WebSocket URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"http_stream.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/connection/http_stream"'}),") - to control HTTP-streaming URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sse.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/connection/sse"'}),") - to control SSE/EventSource URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"emulation.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/emulation"'}),") - to control emulation endpoint prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"uni_sse.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/connection/uni_sse"'}),") - to control unidirectional Eventsource URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"uni_http.stream_handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/connection/uni_http_stream"'}),") - to control unidirectional HTTP streaming URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"uni_websocket.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/connection/uni_websocket"'}),") - to control unidirectional WebSocket URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"http_api.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/api"'}),") - to control HTTP API URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"prometheus.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/metrics"'}),") - to control Prometheus URL prefix"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"health.handler_prefix"})," (default ",(0,t.jsx)(n.code,{children:'"/health"'}),") - to control health check URL prefix"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"disable-default-endpoints",children:"Disable default endpoints"}),"\n",(0,t.jsx)(n.p,{children:"Centrifugo starts with bidirectional WebSocket and HTTP API enabled."}),"\n",(0,t.jsxs)(n.p,{children:["To disable websocket endpoint set ",(0,t.jsx)(n.code,{children:"websocket.disabled"})," boolean option to ",(0,t.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["To disable API endpoint set ",(0,t.jsx)(n.code,{children:"http_api.disabled"})," boolean option to ",(0,t.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"proxies",children:"Proxies"}),"\n",(0,t.jsxs)(n.p,{children:["Sometimes you need more flexibility when configuring channel proxies. Centrifugo provides a way to define custom proxy on channel namespace and rpc namespace levels. In that case you can reference a proxy defined in ",(0,t.jsx)(n.code,{children:"proxies"})," array by name from a namespace."]}),"\n",(0,t.jsxs)(n.p,{children:["See the ",(0,t.jsx)(n.a,{href:"/docs/server/proxy",children:"dedicated chapter"})," for more details."]}),"\n",(0,t.jsx)(n.h2,{id:"consumers",children:"Consumers"}),"\n",(0,t.jsxs)(n.p,{children:["Centrifugo supports asynchronous reading of API commands from external queue systems, inclusing Kafka and PostgreSQL outbox table. It's possible to configure using ",(0,t.jsx)(n.code,{children:"consumers"})," array option. See the ",(0,t.jsx)(n.a,{href:"/docs/server/consumers",children:"dedicated chapter about consumers"})," for more details and configuration details."]}),"\n",(0,t.jsx)(n.h2,{id:"opentelemetry",children:"Opentelemetry"}),"\n",(0,t.jsx)(n.p,{children:"TBD"}),"\n",(0,t.jsx)(n.h2,{id:"graphite",children:"Graphite"}),"\n",(0,t.jsx)(n.p,{children:"TBD"}),"\n",(0,t.jsx)(n.h2,{id:"shutdown",children:"Shutdown"}),"\n",(0,t.jsx)(n.p,{children:"TBD"}),"\n",(0,t.jsx)(n.h2,{id:"signal-handling",children:"Signal handling"}),"\n",(0,t.jsx)(n.p,{children:"It's possible to send HUP signal to Centrifugo to reload a configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kill -HUP <PID>\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Though at moment ",(0,t.jsx)(n.strong,{children:"this will only reload token secrets and channel options (top-level and namespaces)"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Centrifugo tries to gracefully shut down client connections when SIGINT or SIGTERM signals are received. By default, the maximum graceful shutdown period is 30 seconds but can be changed using ",(0,t.jsx)(n.code,{children:"shutdown_timeout"})," (integer, in seconds) configuration option."]}),"\n",(0,t.jsx)(n.h2,{id:"anonymous-usage-stats",children:"Anonymous usage stats"}),"\n",(0,t.jsx)(n.p,{children:"Centrifugo periodically sends anonymous usage information (once in 24 hours). That information is impersonal and does not include sensitive data, passwords, IP addresses, hostnames, etc. Only counters to estimate version and installation size distribution, and feature usage."}),"\n",(0,t.jsx)(n.p,{children:"Please do not disable usage stats sending without reason. If you depend on Centrifugo \u2013 sure you are interested in further project improvements. Usage stats help us understand Centrifugo use cases better, concentrate on widely-used features, and be confident we are moving in the right direction. Developing in the dark is hard, and decisions may be non-optimal."}),"\n",(0,t.jsxs)(n.p,{children:["To disable sending usage stats set ",(0,t.jsx)(n.code,{children:"usage_stats_disable"})," option:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "usage_stats": {\n    "disabled": true\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"setting-time-duration-options",children:"Setting time duration options"}),"\n",(0,t.jsxs)(n.p,{children:["Time durations in Centrifugo can be set using strings where duration value and unit are both provided. For example, to set 5 seconds duration use ",(0,t.jsx)(n.code,{children:'"5s"'}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The minimal time resolution is 1ms. Some options of Centrifugo only support second precision (for example ",(0,t.jsx)(n.code,{children:"history_ttl"})," channel option)."]}),"\n",(0,t.jsxs)(n.p,{children:["Valid time units are ",(0,t.jsx)(n.code,{children:"ms"})," (milliseconds), ",(0,t.jsx)(n.code,{children:"s"})," (seconds), ",(0,t.jsx)(n.code,{children:"m"})," (minutes), ",(0,t.jsx)(n.code,{children:"h"})," (hours)."]}),"\n",(0,t.jsx)(n.p,{children:"Some examples:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'"1000ms" // 1000 milliseconds\n"1s"     // 1 second\n"12h"    // 12 hours\n"720h"   // 30 days\n'})}),"\n",(0,t.jsx)(n.h2,{id:"tls-config-object",children:"TLS config object"}),"\n",(0,t.jsx)(n.p,{children:"TLS configurations in Centrifugo can be set using the following TLS object:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field name"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"enabled"})}),(0,t.jsx)(n.td,{children:"bool"}),(0,t.jsx)(n.td,{children:"Turns on using TLS"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"cert_pem"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Certificate in PEM format. Raw string, base64 PEM encoded string or path to a PEM file supported as a value. See more details below."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"key_pem"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Key in PEM format. Same values as for ",(0,t.jsx)(n.code,{children:"cert_pem"})," supported."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"server_ca_pem"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Server root CA certificate in PEM format used by client to verify server's certificate during handshake. Same values as for ",(0,t.jsx)(n.code,{children:"cert_pem"})," supported."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"client_ca_pem"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Client CA certificate in PEM format used by server to verify client's certificate during handshake. Same values as for ",(0,t.jsx)(n.code,{children:"cert_pem"})," supported."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"insecure_skip_verify"})}),(0,t.jsx)(n.td,{children:"bool"}),(0,t.jsx)(n.td,{children:"Turns off server certificate verification."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"server_name"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Used to verify the hostname on the returned certificates."})]})]})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Source Priority:"})," The configuration allows specifying TLS settings from multiple sources: raw PEM string, base64 PEM encoded string, path to a PEM file. The sources are prioritized in the following order:","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Raw PEM"}),"\n",(0,t.jsx)(n.li,{children:"Base64 encoded PEM"}),"\n",(0,t.jsx)(n.li,{children:"PEM file path"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Insecure Option:"})," The ",(0,t.jsx)(n.code,{children:"insecure_skip_verify"})," option can be used to turn off server certificate verification, which is not recommended for production environments."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hostname Verification:"})," The ",(0,t.jsx)(n.code,{children:"server_name"})," is utilized to verify the hostname on the returned certificates, providing an additional layer of security."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"So in the configuration the usage of TLS config for HTTP server may be like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "http_server": {\n    "tls": {\n      "enabled": true,\n      "cert_pem": "/path/to/cert.pem",\n      "key_pem": "/path/to/key.pem"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"setting-namespaces-over-env",children:"Setting namespaces over env"}),"\n",(0,t.jsx)(n.p,{children:"While setting most options in Centrifugo over env is pretty straightforward. Setting namespaces is a bit special:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-console",children:'CENTRIFUGO_NAMESPACES=\'[{"name": "ns1"}, {"name": "ns2"}]\' ./centrifugo\n'})}),"\n",(0,t.jsxs)(n.p,{children:["I.e. ",(0,t.jsx)(n.code,{children:"CENTRIFUGO_NAMESPACES"})," environment variable should be a valid JSON string that represents namespaces array."]})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>l,a:()=>r});var t=i(67294);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);