"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[2318],{27929:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"pro/delta_at_most_once","title":"Delta compression for at most once scenario","description":"Centrifugo OSS supports delta compression only in channels with recovery and positioning on. To support delta compression for the case when subscribers do not use recovery and positioning Centrifugo PRO provides a boolean namespace option called keeplatest_publication. When it\'s on \u2013 Centrifugo saves latest publication in channels to node\'s memory and uses it to construct delta updates. The publication lives in node\'s memory while there are active channel subscribers. This allows dealing with at most once guarantee of Broker\'s PUB/SUB layer and send deltas properly. So you get efficient at most once broadcast and the reduced bandwidth (of course if delta compression makes sense for data in a channel).","source":"@site/docs/pro/delta_at_most_once.md","sourceDirName":"pro","slug":"/pro/delta_at_most_once","permalink":"/docs/pro/delta_at_most_once","draft":false,"unlisted":false,"editUrl":"https://github.com/centrifugal/centrifugal.dev/edit/main/docs/pro/delta_at_most_once.md","tags":[],"version":"current","frontMatter":{"id":"delta_at_most_once","sidebar_label":"Delta for at most once","title":"Delta compression for at most once scenario"},"sidebar":"Pro","previous":{"title":"Channel CEL expressions","permalink":"/docs/pro/cel_expressions"},"next":{"title":"Faster performance","permalink":"/docs/pro/performance"}}');var s=o(74848),a=o(28453);const r={id:"delta_at_most_once",sidebar_label:"Delta for at most once",title:"Delta compression for at most once scenario"},i=void 0,c={},l=[];function d(e){const n={a:"a",code:"code",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Centrifugo OSS supports ",(0,s.jsx)(n.a,{href:"/docs/server/delta_compression",children:"delta compression"})," only in channels with recovery and positioning on. To support delta compression for the case when subscribers do not use recovery and positioning Centrifugo PRO provides a boolean namespace option called ",(0,s.jsx)(n.code,{children:"keep_latest_publication"}),". When it's on \u2013 Centrifugo saves latest publication in channels to node's memory and uses it to construct delta updates. The publication lives in node's memory while there are active channel subscribers. This allows dealing with at most once guarantee of Broker's PUB/SUB layer and send deltas properly. So you get efficient at most once broadcast and the reduced bandwidth (of course if delta compression makes sense for data in a channel)."]}),"\n",(0,s.jsxs)(n.p,{children:["All you need to do is enable ",(0,s.jsx)(n.code,{children:"keep_latest_publication"})," for the desired namespace:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "channel": {\n    "namespaces": [\n      {\n        "name": "example",\n        "allowed_delta_types": [\n          "fossil"\n        ],\n        "keep_latest_publication": true\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Everything else stays the same as described in ",(0,s.jsx)(n.a,{href:"/docs/server/delta_compression",children:"delta compression"})," chapter:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"clients need to negotiate delta compression when subscribing"}),"\n",(0,s.jsxs)(n.li,{children:["publishers need to indicate the desire to use delta compression by using API ",(0,s.jsx)(n.code,{children:"delta"})," field, or by using ",(0,s.jsx)(n.code,{children:"delta_publish"})," channel namespace option."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>i});var t=o(96540);const s={},a=t.createContext(s);function r(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);