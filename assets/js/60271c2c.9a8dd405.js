"use strict";(self.webpackChunkcentrifugal_dev=self.webpackChunkcentrifugal_dev||[]).push([[9929],{28453:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>l});var i=o(96540);const c={},s=i.createContext(c);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),i.createElement(s.Provider,{value:n},e.children)}},74410:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"server/console_commands","title":"Helper CLI commands","description":"Here is a list of helpful built-in command-line commands that come with centrifugo executable.","source":"@site/docs/server/console_commands.md","sourceDirName":"server","slug":"/server/console_commands","permalink":"/docs/server/console_commands","draft":false,"unlisted":false,"editUrl":"https://github.com/centrifugal/centrifugal.dev/edit/main/docs/server/console_commands.md","tags":[],"version":"current","frontMatter":{"id":"console_commands","title":"Helper CLI commands"},"sidebar":"Guides","previous":{"title":"Client protocol codes","permalink":"/docs/server/codes"}}');var c=o(74848),s=o(28453);const r={id:"console_commands",title:"Helper CLI commands"},l=void 0,t={},d=[{value:"version",id:"version",level:2},{value:"genconfig",id:"genconfig",level:2},{value:"checkconfig",id:"checkconfig",level:2},{value:"defaultconfig",id:"defaultconfig",level:2},{value:"defaultenv",id:"defaultenv",level:2},{value:"configdoc",id:"configdoc",level:2},{value:"gentoken",id:"gentoken",level:2},{value:"gensubtoken",id:"gensubtoken",level:2},{value:"checktoken",id:"checktoken",level:2},{value:"checksubtoken",id:"checksubtoken",level:2}];function a(e){const n={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(n.p,{children:["Here is a list of helpful built-in command-line commands that come with ",(0,c.jsx)(n.code,{children:"centrifugo"})," executable."]}),"\n",(0,c.jsx)(n.h2,{id:"version",children:"version"}),"\n",(0,c.jsx)(n.p,{children:"To show Centrifugo version and exit run:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo version\n"})}),"\n",(0,c.jsx)(n.h2,{id:"genconfig",children:"genconfig"}),"\n",(0,c.jsxs)(n.p,{children:["Another command is ",(0,c.jsx)(n.code,{children:"genconfig"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo genconfig -c config.json\n"})}),"\n",(0,c.jsx)(n.p,{children:"It will automatically generate the configuration file with some frequently required options. This is mostly useful for development."}),"\n",(0,c.jsx)(n.p,{children:"If any errors happen \u2013 program will exit with error message and exit code 1."}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"genconfig"})," also supports generation of YAML and TOML configuration file formats - just provide an extension to a file:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo genconfig -c config.toml\n"})}),"\n",(0,c.jsx)(n.h2,{id:"checkconfig",children:"checkconfig"}),"\n",(0,c.jsxs)(n.p,{children:["Centrifugo has special command to check configuration file ",(0,c.jsx)(n.code,{children:"checkconfig"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"centrifugo checkconfig --config=config.json\n"})}),"\n",(0,c.jsx)(n.p,{children:"If any errors found during validation \u2013 program will exit with error message and exit code 1."}),"\n",(0,c.jsx)(n.h2,{id:"defaultconfig",children:"defaultconfig"}),"\n",(0,c.jsxs)(n.p,{children:["The ",(0,c.jsx)(n.code,{children:"defaultconfig"})," generates the configuration file with all defaults for all all available configuration options. See ",(0,c.jsx)(n.a,{href:"/docs/server/console_commands#defaultconfig",children:"docs"})]}),"\n",(0,c.jsx)(n.p,{children:"It supports all three config file formats which Centrifugo recognizes:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"centrifugo defaultconfig -c config.json\ncentrifugo defaultconfig -c config.yaml\ncentrifugo defaultconfig -c config.toml\n"})}),"\n",(0,c.jsx)(n.p,{children:"Also, in dry-run mode the output will be sent to STDOUT instead of file:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"centrifugo defaultconfig -c config.json --dry-run\n"})}),"\n",(0,c.jsx)(n.p,{children:"Finally, it's possible to provide this command a base configuration file - so the result will inherit option values from the base file and will extend it with defaults for everything else:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"centrifugo defaultconfig -c config.json --dry-run --base existing_config.json\n"})}),"\n",(0,c.jsx)(n.h2,{id:"defaultenv",children:"defaultenv"}),"\n",(0,c.jsxs)(n.p,{children:["In addition to ",(0,c.jsx)(n.code,{children:"defaultconfig"})," Centrifugo now has ",(0,c.jsx)(n.code,{children:"defaultenv"})," command (",(0,c.jsx)(n.a,{href:"/docs/server/console_commands#defaultconfig",children:"docs"}),"). The ",(0,c.jsx)(n.code,{children:"defaultenv"})," prints all config options as environment vars with default values to STDOUT. Run:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"centrifugo defaultenv\n"})}),"\n",(0,c.jsx)(n.p,{children:"It also supports the base config file to inherit values from:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"centrifugo defaultenv --base config.json\n"})}),"\n",(0,c.jsxs)(n.p,{children:["When using ",(0,c.jsx)(n.code,{children:"--base"}),", if you additionally provide ",(0,c.jsx)(n.code,{children:"--base-non-zero-only"})," flag \u2013 the output will contain only environment variables for keys which were set to non zero values in the base config file. For example, let's say you have Centrifugo v6 JSON configuration file:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-json",metastring:'title="config.json"',children:'{\n  "client": {\n    "allowed_origins": ["http://localhost:8000"]\n  },\n  "engine": {\n    "type": "redis",\n    "redis": {\n        "address": "redis://localhost:6379"\n    }\n  },\n  "admin": {\n    "enabled": false\n  }\n}\n'})}),"\n",(0,c.jsx)(n.p,{children:"Running:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"centrifugo defaultenv --base config.json --base-non-zero-only\n"})}),"\n",(0,c.jsxs)(n.p,{children:["Will output only variables set in config file with non zero value (",(0,c.jsx)(n.code,{children:"admin.enabled"})," skipped also):"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:'CENTRIFUGO_CLIENT_ALLOWED_ORIGINS="http://localhost:8000"\nCENTRIFUGO_ENGINE_REDIS_ADDRESS="redis://localhost:6379"\nCENTRIFUGO_ENGINE_TYPE="redis"\n'})}),"\n",(0,c.jsx)(n.h2,{id:"configdoc",children:"configdoc"}),"\n",(0,c.jsxs)(n.p,{children:["Another command is ",(0,c.jsx)(n.code,{children:"configdoc"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo configdoc\n"})}),"\n",(0,c.jsxs)(n.p,{children:["Once you run it, a web server will start on port ",(0,c.jsx)(n.code,{children:"6060"})," and you can open the following URL in your browser \u2013 ",(0,c.jsx)(n.a,{href:"http://localhost:6060",children:"http://localhost:6060"})," \u2013 to see the generated HTML page with all Centrifugo configuration options described, with default values, environment variable tips and description:"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"Centrifugo configdoc",src:o(93877).A+"",width:"2244",height:"1010"})}),"\n",(0,c.jsxs)(n.p,{children:["If you pass ",(0,c.jsx)(n.code,{children:"--markdown"})," flag, the output will be in Markdown format to stdout:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo configdoc --markdown\n"})}),"\n",(0,c.jsx)(n.p,{children:"Also supports filtering by top level configuration section:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo configdoc --section=consumers\n"})}),"\n",(0,c.jsx)(n.h2,{id:"gentoken",children:"gentoken"}),"\n",(0,c.jsxs)(n.p,{children:["Another command is ",(0,c.jsx)(n.code,{children:"gentoken"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo gentoken -c config.json -u 28282\n"})}),"\n",(0,c.jsxs)(n.p,{children:["It will automatically generate HMAC SHA-256 based token for user with ID ",(0,c.jsx)(n.code,{children:"28282"})," (which expires in 1 week)."]}),"\n",(0,c.jsxs)(n.p,{children:["You can change token TTL with ",(0,c.jsx)(n.code,{children:"-t"})," flag (number of seconds):"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo gentoken -c config.json -u 28282 -t 3600\n"})}),"\n",(0,c.jsx)(n.p,{children:"This way generated token will be valid for 1 hour."}),"\n",(0,c.jsx)(n.p,{children:"If any errors happen \u2013 program will exit with error message and exit code 1."}),"\n",(0,c.jsx)(n.p,{children:"This command is mostly useful for development."}),"\n",(0,c.jsx)(n.h2,{id:"gensubtoken",children:"gensubtoken"}),"\n",(0,c.jsxs)(n.p,{children:["Another command is ",(0,c.jsx)(n.code,{children:"gensubtoken"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo gensubtoken -c config.json -u 28282 -s channel\n"})}),"\n",(0,c.jsxs)(n.p,{children:["It will automatically generate HMAC SHA-256 based subscription token for channel ",(0,c.jsx)(n.code,{children:"channel"})," and user with ID ",(0,c.jsx)(n.code,{children:"28282"})," (which expires in 1 week)."]}),"\n",(0,c.jsxs)(n.p,{children:["You can change token TTL with ",(0,c.jsx)(n.code,{children:"-t"})," flag (number of seconds):"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo gentoken -c config.json -u 28282 -s channel -t 3600\n"})}),"\n",(0,c.jsx)(n.p,{children:"This way generated token will be valid for 1 hour."}),"\n",(0,c.jsx)(n.p,{children:"If any errors happen \u2013 program will exit with error message and exit code 1."}),"\n",(0,c.jsx)(n.p,{children:"This command is mostly useful for development."}),"\n",(0,c.jsx)(n.h2,{id:"checktoken",children:"checktoken"}),"\n",(0,c.jsxs)(n.p,{children:["One more command is ",(0,c.jsx)(n.code,{children:"checktoken"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo checktoken -c config.json <TOKEN>\n"})}),"\n",(0,c.jsx)(n.p,{children:"It will validate your connection JWT, so you can test it before using while developing application."}),"\n",(0,c.jsx)(n.p,{children:"If any errors happen or validation failed \u2013 program will exit with error message and exit code 1."}),"\n",(0,c.jsx)(n.p,{children:"This is mostly useful for development."}),"\n",(0,c.jsx)(n.h2,{id:"checksubtoken",children:"checksubtoken"}),"\n",(0,c.jsxs)(n.p,{children:["One more command is ",(0,c.jsx)(n.code,{children:"checksubtoken"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"centrifugo checksubtoken -c config.json <TOKEN>\n"})}),"\n",(0,c.jsx)(n.p,{children:"It will validate your subscription JWT, so you can test it before using while developing application."}),"\n",(0,c.jsx)(n.p,{children:"If any errors happen or validation failed \u2013 program will exit with error message and exit code 1."}),"\n",(0,c.jsx)(n.p,{children:"This is mostly useful for development."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}},93877:(e,n,o)=>{o.d(n,{A:()=>i});const i=o.p+"assets/images/configdoc-7f10d799d593bcfe1a904a8849558fa4.jpg"}}]);