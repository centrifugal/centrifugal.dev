<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-3 plugin-docs plugin-id-default docs-doc-id-faq/faq_index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Frequently Asked Questions | Centrifugo</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://centrifugal.dev/img/centrifugo_soc.png"><meta data-rh="true" name="twitter:image" content="https://centrifugal.dev/img/centrifugo_soc.png"><meta data-rh="true" property="og:url" content="https://centrifugal.dev/docs/3/faq"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="3"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3"><meta data-rh="true" name="docsearch:version" content="3"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3"><meta data-rh="true" property="og:title" content="Frequently Asked Questions | Centrifugo"><meta data-rh="true" name="description" content="Answers to popular questions here."><meta data-rh="true" property="og:description" content="Answers to popular questions here."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://centrifugal.dev/docs/3/faq"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/docs/3/faq" hreflang="en"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/docs/3/faq" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=" Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title=" JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZRQD92LEX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NZRQD92LEX",{anonymize_ip:!0})</script>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"><link rel="stylesheet" href="/assets/css/styles.8cd54235.css">
<link rel="preload" href="/assets/js/runtime~main.100e875f.js" as="script">
<link rel="preload" href="/assets/js/main.245bb4a4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Centrifugo</b></a><a class="navbar__item navbar__link" href="/docs/3/getting-started/introduction">Getting Started</a><a class="navbar__item navbar__link" href="/docs/3/server/configuration">Server guide</a><a class="navbar__item navbar__link" href="/docs/3/transports/overview">Transports</a><a class="navbar__item navbar__link" href="/docs/3/pro/overview">Centrifugo PRO</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/3/faq">FAQ</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/centrifugal/centrifugo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/3/getting-started/introduction">v3</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/faq">v4</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/3/faq">v3</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Centrifugo<!-- --> <b>v3</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/faq">latest version</a></b> (<!-- -->v4<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Frequently Asked Questions</h1></header><p>Answers to popular questions here.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-many-connections-can-one-centrifugo-instance-handle">How many connections can one Centrifugo instance handle?<a href="#how-many-connections-can-one-centrifugo-instance-handle" class="hash-link" aria-label="Direct link to How many connections can one Centrifugo instance handle?" title="Direct link to How many connections can one Centrifugo instance handle?">​</a></h3><p>This depends on many factors. Real-time transport choice, hardware, message rate, size of messages, Centrifugo features enabled, client distribution over channels, compression on/off, etc. So no certain answer to this question exists. Common sense, performance measurements, and monitoring can help here. </p><p>Generally, we suggest not put more than 50-100k clients on one node - but you should measure for your use case.</p><p>You can find a description of a test stand with million WebSocket connections in <a href="/blog/2020/02/10/million-connections-with-centrifugo">this blog post</a>. Though the point above is still valid – measure and <a href="/docs/3/server/monitoring">monitor</a> your setup.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="memory-usage-per-connection">Memory usage per connection?<a href="#memory-usage-per-connection" class="hash-link" aria-label="Direct link to Memory usage per connection?" title="Direct link to Memory usage per connection?">​</a></h3><p>Depending on transport used and features enabled the amount of RAM required per each connection can vary.</p><p>For example, you can expect that each WebSocket connection will cost about 30-50 KB of RAM, thus a server with 1 GB of RAM can handle about 20-30k connections.</p><p>For other real-time transports, the memory usage per connection can differ (for example, SockJS connections will cost ~ 2 times more RAM than pure WebSocket connections). So the best way is again – measure for your custom case since depending on Centrifugo transport/features memory usage can vary.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="can-centrifugo-scale-horizontally">Can Centrifugo scale horizontally?<a href="#can-centrifugo-scale-horizontally" class="hash-link" aria-label="Direct link to Can Centrifugo scale horizontally?" title="Direct link to Can Centrifugo scale horizontally?">​</a></h3><p>Yes, it can do this using built-in engines: Redis, KeyDB, Tarantool, or Nats broker.</p><p>See <a href="/docs/3/server/engines">engines</a> and <a href="/docs/3/getting-started/design#scalability-considerations">scalability considerations</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="message-delivery-model">Message delivery model<a href="#message-delivery-model" class="hash-link" aria-label="Direct link to Message delivery model" title="Direct link to Message delivery model">​</a></h3><p>See <a href="/docs/3/getting-started/design#message-delivery-model">design overview</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="message-order-guarantees">Message order guarantees<a href="#message-order-guarantees" class="hash-link" aria-label="Direct link to Message order guarantees" title="Direct link to Message order guarantees">​</a></h3><p>See <a href="/docs/3/getting-started/design#message-order-guarantees">design overview</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="should-i-create-channels-explicitly">Should I create channels explicitly?<a href="#should-i-create-channels-explicitly" class="hash-link" aria-label="Direct link to Should I create channels explicitly?" title="Direct link to Should I create channels explicitly?">​</a></h3><p>No. By default, channels are created automatically as soon as the first client subscribed to it. And destroyed automatically when the last client unsubscribes from a channel.</p><p>When history inside the channel is on then a window of last messages is kept automatically during the retention period. So a client that comes later and subscribes to a channel can retrieve those messages using the call to the history API (or maybe by using the automatic recovery feature which also uses a history internally).</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-about-best-practices-with-the-number-of-channels">What about best practices with the number of channels?<a href="#what-about-best-practices-with-the-number-of-channels" class="hash-link" aria-label="Direct link to What about best practices with the number of channels?" title="Direct link to What about best practices with the number of channels?">​</a></h3><p>Channel is a very lightweight ephemeral entity - Centrifugo can deal with lots of channels, don&#x27;t be afraid to have many channels in an application.</p><p>But keep in mind that one client should be subscribed to a reasonable number of channels at one moment. Client-side subscription to a channel requires a separate frame from client to server – more frames mean more heavy initial connection, more heavy reconnect, etc.</p><p>One example which may lead to channel misusing is a messenger app where user can be part of many groups. In this case, using a separate channel for each group/chat in a messenger may be a bad approach. The problem is that messenger app may have chat list screen – a view that displays all user groups (probably with pagination). If you are using separate channel for each group then this may lead to lots of subscriptions. Also, with pagination, to receive updates from older chats (not visible on a screen due to pagination) – user may need to subscribe on their channels too. In this case, using a single personal channel for each user is a preferred approach. As soon as you need to deliver a message to a group you can use Centrifugo <code>broadcast</code> API to send it to many users. If your chat groups are huge in size then you may also need additional queuing system between your application backend and Centrifugo to broadcast a message to many personal channels.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="any-way-to-exclude-message-publisher-from-receiving-a-message-from-a-channel">Any way to exclude message publisher from receiving a message from a channel?<a href="#any-way-to-exclude-message-publisher-from-receiving-a-message-from-a-channel" class="hash-link" aria-label="Direct link to Any way to exclude message publisher from receiving a message from a channel?" title="Direct link to Any way to exclude message publisher from receiving a message from a channel?">​</a></h3><p>Currently, no.</p><p>We know that services like Pusher provide a way to exclude current client by providing a client ID (socket ID) in publish request. A couple of problems with this:</p><ul><li>Client can reconnect while message travels over wire/Backend/Centrifugo – in this case client has a chance to receive a message unexpectedly since it will have another client ID (socket ID)</li><li>Client can call a history manually or message recovery process can run upon reconnect – in this case a message will present in a history</li></ul><p>Both cases may result in duplicate messages. These reasons prevent us adding such functionality into Centrifugo, the correct application architecture requires having some sort of idempotent identifier which allow dealing with message duplicates.</p><p>Once added nobody will think about idempotency and this can lead to hard to catch/fix problems in an application. This can also make enabling channel history harder at some point.</p><p>Centrifugo behaves similar to Kafka here – i.e. channel should be considered as immutable stream of events where each channel subscriber simply receives all messages published to a channel.</p><p>In the future releases Centrifugo may have some sort of server-side message filtering, but we are searching for a proper and safe way of adding it.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="can-i-have-both-binary-and-json-clients-in-one-channel">Can I have both binary and JSON clients in one channel?<a href="#can-i-have-both-binary-and-json-clients-in-one-channel" class="hash-link" aria-label="Direct link to Can I have both binary and JSON clients in one channel?" title="Direct link to Can I have both binary and JSON clients in one channel?">​</a></h3><p>No. It&#x27;s not possible to transparently encode binary data into JSON protocol (without converting binary to base64 for example which we don&#x27;t want to do due to increased complexity and performance penalties). So if you have clients in a channel which work with JSON – you need to use JSON payloads everywhere.</p><p>Most Centrifugo bidirectional connectors are using binary Protobuf protocol between a client and Centrifugo. But you can send JSON over Protobuf protocol just fine (since JSON is a UTF-8 encoded sequence of bytes in the end).</p><p>To summarize:</p><ul><li>if you are using binary Protobuf clients and binary payloads everywhere – you are fine.</li><li>if you are using binary or JSON clients and valid JSON payloads everywhere – you are fine.</li><li>if you try to send binary data to JSON protocol based clients – you will get errors from Centrifugo.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="online-presence-for-chat-apps---online-status-of-your-contacts">Online presence for chat apps - online status of your contacts<a href="#online-presence-for-chat-apps---online-status-of-your-contacts" class="hash-link" aria-label="Direct link to Online presence for chat apps - online status of your contacts" title="Direct link to Online presence for chat apps - online status of your contacts">​</a></h3><p>While online presence is a good feature it does not fit well for some apps. For example, if you make a chat app - you may probably use a single personal channel for each user. In this case, you cannot find who is online at moment using the built-in Centrifugo presence feature as users do not share a common channel.</p><p>You can solve this using a separate service that tracks the online status of your users (for example in Redis) and has a bulk API that returns online status approximation for a list of users. This way you will have an efficient scalable way to deal with online statuses. This is also available as <a href="/docs/3/pro/user_status">Centrifugo PRO feature</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="centrifugo-stops-accepting-new-connections-why">Centrifugo stops accepting new connections, why?<a href="#centrifugo-stops-accepting-new-connections-why" class="hash-link" aria-label="Direct link to Centrifugo stops accepting new connections, why?" title="Direct link to Centrifugo stops accepting new connections, why?">​</a></h3><p>The most popular reason behind this is reaching the open file limit. You can make it higher, we described how to do this <a href="/docs/3/server/infra_tuning">nearby in this doc</a>. Also, check out <a href="/blog/2020/11/12/scaling-websocket">an article in our blog</a> which mentions possible problems when dealing with many persistent connections like WebSocket.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="can-i-use-centrifugo-without-reverse-proxy-like-nginx-before-it">Can I use Centrifugo without reverse-proxy like Nginx before it?<a href="#can-i-use-centrifugo-without-reverse-proxy-like-nginx-before-it" class="hash-link" aria-label="Direct link to Can I use Centrifugo without reverse-proxy like Nginx before it?" title="Direct link to Can I use Centrifugo without reverse-proxy like Nginx before it?">​</a></h3><p>Yes, you can - Go standard library designed to allow this. Though proxy before Centrifugo can be very useful for load balancing clients.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="does-centrifugo-work-with-http2">Does Centrifugo work with HTTP/2?<a href="#does-centrifugo-work-with-http2" class="hash-link" aria-label="Direct link to Does Centrifugo work with HTTP/2?" title="Direct link to Does Centrifugo work with HTTP/2?">​</a></h3><p>Yes, Centrifugo works with HTTP/2.</p><p>You can disable HTTP/2 running Centrifugo server with <code>GODEBUG</code> environment variable:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GODEBUG=&quot;http2server=0&quot; centrifugo -c config.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Keep in mind that when using WebSocket you are working only over HTTP/1.1, so HTTP/2 support mostly makes sense for SockJS HTTP transports and unidirectional transports: like EventSource (SSE) and HTTP-streaming.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="is-there-a-way-to-use-a-single-connection-to-centrifugo-from-different-browser-tabs">Is there a way to use a single connection to Centrifugo from different browser tabs?<a href="#is-there-a-way-to-use-a-single-connection-to-centrifugo-from-different-browser-tabs" class="hash-link" aria-label="Direct link to Is there a way to use a single connection to Centrifugo from different browser tabs?" title="Direct link to Is there a way to use a single connection to Centrifugo from different browser tabs?">​</a></h3><p>If the underlying transport is HTTP-based, and you use HTTP/2 then this will work automatically. For WebSocket, each browser tab creates a new connection.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="what-if-i-need-to-send-push-notifications-to-mobile-or-web-applications">What if I need to send push notifications to mobile or web applications?<a href="#what-if-i-need-to-send-push-notifications-to-mobile-or-web-applications" class="hash-link" aria-label="Direct link to What if I need to send push notifications to mobile or web applications?" title="Direct link to What if I need to send push notifications to mobile or web applications?">​</a></h3><p>Sometimes it&#x27;s confusing to see a difference between real-time messages and push notifications. Centrifugo is a real-time messaging server. It can not send push notifications to devices - to Apple iOS devices via APNS, Android devices via GCM, or browsers over Web Push API. This is a goal for another software.</p><p>But the reasonable question here is how can you know when you need to send a real-time message to an online client or push notification to its device for an offline client. The solution is pretty simple. You can keep critical notifications for a client in the database. And when a client reads a message you should send an ack to your backend marking that notification as read by the client. Periodically you can check which notifications were sent to clients but they have not read it (no read ack received). For such notifications, you can send push notifications to its device using your own or another open-source solution. Look at Firebase for example.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-can-i-know-a-message-is-delivered-to-a-client">How can I know a message is delivered to a client?<a href="#how-can-i-know-a-message-is-delivered-to-a-client" class="hash-link" aria-label="Direct link to How can I know a message is delivered to a client?" title="Direct link to How can I know a message is delivered to a client?">​</a></h3><p>You can, but Centrifugo does not have such an API. What you have to do to ensure your client has received a message is sending confirmation ack from your client to your application backend as soon as the client processed the message coming from a Centrifugo channel.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="can-i-publish-new-messages-over-a-websocket-connection-from-a-client">Can I publish new messages over a WebSocket connection from a client?<a href="#can-i-publish-new-messages-over-a-websocket-connection-from-a-client" class="hash-link" aria-label="Direct link to Can I publish new messages over a WebSocket connection from a client?" title="Direct link to Can I publish new messages over a WebSocket connection from a client?">​</a></h3><p>It&#x27;s possible to publish messages into channels directly from a client (when <code>publish</code> channel option is enabled). But we strongly discourage this in production usage as those messages just go through Centrifugo without any additional control and validation from the application backend.</p><p>We suggest using one of the available approaches:</p><ul><li>When a user generates an event it must be first delivered to your app backend using a convenient way (for example AJAX POST request for a web application), processed on the backend (validated, saved into the main application database), and then published to Centrifugo using Centrifugo HTTP or GRPC API.</li><li>Utilize the <a href="/docs/3/server/proxy#rpc-proxy">RPC proxy feature</a> – in this case, you can call RPC over Centrifugo WebSocket which will be translated to an HTTP request to your backend. After receiving this request on the backend you can publish a message to Centrifugo server API. This way you can utilize WebSocket transport between the client and your server in a bidirectional way. HTTP traffic will be concentrated inside your private network.</li><li>Utilize the <a href="/docs/3/server/proxy#publish-proxy">publish proxy feature</a> – in this case client can call publish on the frontend, this publication request will be transformed into HTTP or GRPC call to the application backend. If your backend allows publishing - Centrifugo will pass the payload to the channel (i.e. will publish message to the channel itself). </li></ul><p>Sometimes publishing from a client directly into a channel (without any backend involved) can be useful though - for personal projects, for demonstrations (like we do in our <a href="https://github.com/centrifugal/examples" target="_blank" rel="noopener noreferrer">examples</a>) or if you trust your users and want to build an application without backend. In all cases when you don&#x27;t need any message control on your backend.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-to-create-a-secure-channel-for-two-users-only-private-chat-case">How to create a secure channel for two users only (private chat case)?<a href="#how-to-create-a-secure-channel-for-two-users-only-private-chat-case" class="hash-link" aria-label="Direct link to How to create a secure channel for two users only (private chat case)?" title="Direct link to How to create a secure channel for two users only (private chat case)?">​</a></h3><p>There are several ways to achieve it:</p><ul><li>use a private channel (starting with <code>$</code>) - every time a user subscribes to it your backend should provide a sign to confirm that subscription request. Read more in <a href="/docs/3/server/channels#private-channel-prefix">channels chapter</a></li><li>next is <a href="/docs/3/server/channels#user-channel-boundary">user limited channels</a> (with <code>#</code>) - you can create a channel with a name like <code>dialog#42,567</code> to limit subscribers only to the user with id <code>42</code> and user with ID <code>567</code>, this does not fit well for channels with many or dynamic possible subscribers</li><li>you can use subscribe proxy feature to validate subscriptions, see <a href="/docs/3/server/proxy">chapter about proxy</a></li><li>finally, you can create a hard-to-guess channel name (based on some secret key and user IDs or just generate and save this long unique name into your main app database) so other users won&#x27;t know this channel to subscribe on it. This is the simplest but not the safest way - but can be reasonable to consider in many situations</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="whats-the-best-way-to-organize-channel-configuration">What&#x27;s the best way to organize channel configuration?<a href="#whats-the-best-way-to-organize-channel-configuration" class="hash-link" aria-label="Direct link to What&#x27;s the best way to organize channel configuration?" title="Direct link to What&#x27;s the best way to organize channel configuration?">​</a></h3><p>In most situations, your application needs several different real-time features. We suggest using namespaces for every real-time feature if it requires some option enabled.</p><p>For example, if you need join/leave messages for a chat app - create a special channel namespace with this <code>join_leave</code> option enabled. Otherwise, your other channels will receive join/leave messages too - increasing load and traffic in the system but not used by clients.</p><p>The same relates to other channel options.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="does-centrifugo-support-webhooks">Does Centrifugo support webhooks?<a href="#does-centrifugo-support-webhooks" class="hash-link" aria-label="Direct link to Does Centrifugo support webhooks?" title="Direct link to Does Centrifugo support webhooks?">​</a></h3><p><a href="/docs/3/server/proxy">Proxy feature</a> allows integrating Centrifugo with your session mechanism (via connect proxy) and provides a way to react to connection events (rpc, subscribe, publish). Also, it opens a road for bidirectional communication with RPC calls. And periodic connection refresh hooks are also there.</p><p>Centrifugo does not support unsubscribe/disconnect hooks – see the reasoning below.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="why-centrifugo-does-not-have-disconnect-hooks">Why Centrifugo does not have disconnect hooks?<a href="#why-centrifugo-does-not-have-disconnect-hooks" class="hash-link" aria-label="Direct link to Why Centrifugo does not have disconnect hooks?" title="Direct link to Why Centrifugo does not have disconnect hooks?">​</a></h3><p>Centrifugo does not support disconnect hooks at this point.</p><p>First of all, there is no guarantee that the disconnect process will have a time to execute on the client-side (as the client can just switch off its device or simply lose internet connection). This means that a server may notice a connection loss with some delay (thanks to PING/PONG).</p><p>Also, Centrifugo node can be unexpectedly killed. So there is a chance that disconnect event won&#x27;t have a chance to be emitted to the backend.</p><p>One more reason is that Centrifugo designed to scale to many concurrent connections. Think millions of them. As we <a href="https://centrifugal.dev/blog/2020/11/12/scaling-websocket#massive-reconnect" target="_blank" rel="noopener noreferrer">mentioned in our blog</a> there are cases when all connections start reconnecting at the same time. In this case Centrifugo could potentially generate lots of disconnect events. To reduce the load during connect process Centrifugo has JWT authentication. Even if disconnect events were queued/rate-limited there could be situations when your app processes disconnect hook while user already reconnected and connect event processed. This is a racy situation which you will need to handle somehow (possibly based on unique client ID attached to each connection).</p><p>If you need to know that client disconnected and program your business logic around this fact then the reasonable approach could be periodically call your backend from the client-side and update user status somewhere on the backend (use Redis maybe). This is a pretty robust solution where you can&#x27;t occasionally miss disconnect events. You can also utilize Centrifugo refresh proxy for the task of periodic backend pinging. In this case you will notice that user (or particular client) left app with some delay – this may be a acceptable trade-off in many cases.</p><p>Having said that, processing disconnect events may be reasonable – as a best-effort solution while taking into account everything said above. <a href="https://github.com/centrifugal/centrifuge" target="_blank" rel="noopener noreferrer">Centrifuge</a> library for Go language (which is the core of Centrifugo) supports client disconnect callbacks on a server-side – so technically the possibility exists. If someone comes with a use case which definitely wins from having disconnect hooks in Centrifugo we are ready to discuss this and try to design a proper solution together.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="is-it-possible-to-listen-to-joinleave-events-on-the-app-backend-side">Is it possible to listen to join/leave events on the app backend side?<a href="#is-it-possible-to-listen-to-joinleave-events-on-the-app-backend-side" class="hash-link" aria-label="Direct link to Is it possible to listen to join/leave events on the app backend side?" title="Direct link to Is it possible to listen to join/leave events on the app backend side?">​</a></h3><p>No, join/leave events are only available in the client protocol. In most cases join event can be handled by using <a href="/docs/3/server/proxy#subscribe-proxy">subscribe proxy</a>. Leave events are harder – there is no unsubscribe hook available (mostly the same reasons as for disconnect hook described above). So the workaround here can be similar to one for disconnect – ping an app backend periodically while client is subscribed and thus know that client is currently in a channel with some approximation in time.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-scalable-is-the-online-presence-and-joinleave-features">How scalable is the online presence and join/leave features?<a href="#how-scalable-is-the-online-presence-and-joinleave-features" class="hash-link" aria-label="Direct link to How scalable is the online presence and join/leave features?" title="Direct link to How scalable is the online presence and join/leave features?">​</a></h3><p>Online presence is good for channels with a reasonably small number of active subscribers. As soon as there are tons of active subscribers, presence information becomes very expensive in terms of bandwidth (as it contains full information about all clients in a channel).</p><p>There is <code>presence_stats</code> API method that can be helpful if you only need to know the number of clients (or unique users) in a channel. But in the case of the Redis engine even <code>presence_stats</code> call is not optimized for channels with more than several thousand active subscribers.</p><p>You may consider using a separate service to deal with presence status information that provides information in near real-time maybe with some reasonable approximation. Centrifugo PRO provides a <a href="/docs/3/pro/user_status">user status</a> feature which may fit your needs.</p><p>The same is true for join/leave messages - as soon as you turn on join/leave events for a channel with many active subscribers each subscriber starts generating indiviaual join/leave events. This may result in many messages sent to each subscriber in a channel, drastically multiplying amount of messages traveling through the system. Especially when all clients reconnect simulteniously. So be careful and estimate the possible load. There is no magic, unfortunately.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="i-have-not-found-an-answer-to-my-question-here">I have not found an answer to my question here:<a href="#i-have-not-found-an-answer-to-my-question-here" class="hash-link" aria-label="Direct link to I have not found an answer to my question here:" title="Direct link to I have not found an answer to my question here:">​</a></h3><p>Ask in our community rooms:</p><p><a href="https://t.me/joinchat/ABFVWBE0AhkyyhREoaboXQ" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://img.shields.io/badge/Telegram-Group-orange?style=flat&amp;logo=telegram" alt="Join the chat at https://t.me/joinchat/ABFVWBE0AhkyyhREoaboXQ" class="img_ev3q"></a> <!-- --> <a href="https://discord.gg/tYgADKx" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://img.shields.io/discord/719186998686122046?style=flat&amp;label=Discord&amp;logo=discord" alt="Join the chat at https://discord.gg/tYgADKx" class="img_ev3q"></a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/centrifugal/centrifugal.dev/edit/main/versioned_docs/version-3/faq/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-many-connections-can-one-centrifugo-instance-handle" class="table-of-contents__link toc-highlight">How many connections can one Centrifugo instance handle?</a></li><li><a href="#memory-usage-per-connection" class="table-of-contents__link toc-highlight">Memory usage per connection?</a></li><li><a href="#can-centrifugo-scale-horizontally" class="table-of-contents__link toc-highlight">Can Centrifugo scale horizontally?</a></li><li><a href="#message-delivery-model" class="table-of-contents__link toc-highlight">Message delivery model</a></li><li><a href="#message-order-guarantees" class="table-of-contents__link toc-highlight">Message order guarantees</a></li><li><a href="#should-i-create-channels-explicitly" class="table-of-contents__link toc-highlight">Should I create channels explicitly?</a></li><li><a href="#what-about-best-practices-with-the-number-of-channels" class="table-of-contents__link toc-highlight">What about best practices with the number of channels?</a></li><li><a href="#any-way-to-exclude-message-publisher-from-receiving-a-message-from-a-channel" class="table-of-contents__link toc-highlight">Any way to exclude message publisher from receiving a message from a channel?</a></li><li><a href="#can-i-have-both-binary-and-json-clients-in-one-channel" class="table-of-contents__link toc-highlight">Can I have both binary and JSON clients in one channel?</a></li><li><a href="#online-presence-for-chat-apps---online-status-of-your-contacts" class="table-of-contents__link toc-highlight">Online presence for chat apps - online status of your contacts</a></li><li><a href="#centrifugo-stops-accepting-new-connections-why" class="table-of-contents__link toc-highlight">Centrifugo stops accepting new connections, why?</a></li><li><a href="#can-i-use-centrifugo-without-reverse-proxy-like-nginx-before-it" class="table-of-contents__link toc-highlight">Can I use Centrifugo without reverse-proxy like Nginx before it?</a></li><li><a href="#does-centrifugo-work-with-http2" class="table-of-contents__link toc-highlight">Does Centrifugo work with HTTP/2?</a></li><li><a href="#is-there-a-way-to-use-a-single-connection-to-centrifugo-from-different-browser-tabs" class="table-of-contents__link toc-highlight">Is there a way to use a single connection to Centrifugo from different browser tabs?</a></li><li><a href="#what-if-i-need-to-send-push-notifications-to-mobile-or-web-applications" class="table-of-contents__link toc-highlight">What if I need to send push notifications to mobile or web applications?</a></li><li><a href="#how-can-i-know-a-message-is-delivered-to-a-client" class="table-of-contents__link toc-highlight">How can I know a message is delivered to a client?</a></li><li><a href="#can-i-publish-new-messages-over-a-websocket-connection-from-a-client" class="table-of-contents__link toc-highlight">Can I publish new messages over a WebSocket connection from a client?</a></li><li><a href="#how-to-create-a-secure-channel-for-two-users-only-private-chat-case" class="table-of-contents__link toc-highlight">How to create a secure channel for two users only (private chat case)?</a></li><li><a href="#whats-the-best-way-to-organize-channel-configuration" class="table-of-contents__link toc-highlight">What&#39;s the best way to organize channel configuration?</a></li><li><a href="#does-centrifugo-support-webhooks" class="table-of-contents__link toc-highlight">Does Centrifugo support webhooks?</a></li><li><a href="#why-centrifugo-does-not-have-disconnect-hooks" class="table-of-contents__link toc-highlight">Why Centrifugo does not have disconnect hooks?</a></li><li><a href="#is-it-possible-to-listen-to-joinleave-events-on-the-app-backend-side" class="table-of-contents__link toc-highlight">Is it possible to listen to join/leave events on the app backend side?</a></li><li><a href="#how-scalable-is-the-online-presence-and-joinleave-features" class="table-of-contents__link toc-highlight">How scalable is the online presence and join/leave features?</a></li><li><a href="#i-have-not-found-an-answer-to-my-question-here" class="table-of-contents__link toc-highlight">I have not found an answer to my question here:</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact us</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:centrifugal.dev@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Send e-mail</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/joinchat/U57MI8Lam9mhpuhd" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/tYgADKx" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/centrifugal_dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/attributions">Attributions</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Centrifugal Labs LTD</div></div></div></footer></div>
<script src="/assets/js/runtime~main.100e875f.js"></script>
<script src="/assets/js/main.245bb4a4.js"></script>
</body>
</html>