<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-server/consumers" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Built-in API command async consumers | Centrifugo</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://centrifugal.dev/img/centrifugo_soc.png"><meta data-rh="true" name="twitter:image" content="https://centrifugal.dev/img/centrifugo_soc.png"><meta data-rh="true" property="og:url" content="https://centrifugal.dev/docs/server/consumers"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="centrifugo, real-time messaging, websocket server, pub/sub, push notifications, server-sent events, real-time API, scalable messaging, self-hosted, open source, AI streaming, LLM response streaming, stream GPT responses, real-time AI chat, AI websocket"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:site" content="@centrifugalabs"><meta data-rh="true" property="og:type" content="website"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Built-in API command async consumers | Centrifugo"><meta data-rh="true" name="description" content="Centrifugo built-in async consumers for reliable API command delivery from PostgreSQL, Kafka, Nats JetStream, Redis Streams, SQS, and more."><meta data-rh="true" property="og:description" content="Centrifugo built-in async consumers for reliable API command delivery from PostgreSQL, Kafka, Nats JetStream, Redis Streams, SQS, and more."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://centrifugal.dev/docs/server/consumers"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/docs/server/consumers" hreflang="en"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/docs/server/consumers" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EPXZ1LXJ33-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=" Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title=" JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZRQD92LEX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NZRQD92LEX",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Centrifugo" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"><link rel="stylesheet" href="/assets/css/styles.73de1eb4.css">
<script src="/assets/js/runtime~main.9d0ad8be.js" defer="defer"></script>
<script src="/assets/js/main.c9e365e3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Centrifugo</b></a><a class="navbar__item navbar__link" href="/docs/getting-started/introduction">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/server/configuration">Server guide</a><a class="navbar__item navbar__link" href="/docs/transports/overview">Real-time transports / SDK</a><a class="navbar__item navbar__link" href="/pro">Centrifugo PRO ♻️</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a class="navbar__item navbar__link" href="/docs/tutorial/intro">Grand tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/centrifugal/centrifugo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/server/consumers">v6</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/server/consumers">v6</a></li><li><a class="dropdown__link" href="/docs/5/server/consumers">v5</a></li><li><a class="dropdown__link" href="/docs/4/getting-started/introduction">v4</a></li><li><a class="dropdown__link" href="/docs/3/getting-started/introduction">v3</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Centrifugo</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/configuration"><span title="Configure Centrifugo" class="linkLabel_WmDU">Configure Centrifugo</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/server_api"><span title="Server API walkthrough" class="linkLabel_WmDU">Server API walkthrough</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/authentication"><span title="Client JWT authentication" class="linkLabel_WmDU">Client JWT authentication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/channels"><span title="Channels and namespaces" class="linkLabel_WmDU">Channels and namespaces</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/channel_permissions"><span title="Channel permission model" class="linkLabel_WmDU">Channel permission model</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/channel_token_auth"><span title="Channel JWT authorization" class="linkLabel_WmDU">Channel JWT authorization</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/server_subs"><span title="Server-side subscriptions" class="linkLabel_WmDU">Server-side subscriptions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/engines"><span title="Engines and scalability" class="linkLabel_WmDU">Engines and scalability</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/server/consumers"><span title="Async consumers" class="linkLabel_WmDU">Async consumers</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/history_and_recovery"><span title="History and stream recovery" class="linkLabel_WmDU">History and stream recovery</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/cache_recovery"><span title="Cache recovery mode" class="linkLabel_WmDU">Cache recovery mode</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/delta_compression"><span title="Delta compression" class="linkLabel_WmDU">Delta compression</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/publication_filtering"><span title="Publication filtering" class="linkLabel_WmDU">Publication filtering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/presence"><span title="Online presence" class="linkLabel_WmDU">Online presence</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/proxy"><span title="Proxy events to the backend" class="linkLabel_WmDU">Proxy events to the backend</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/proxy_streams"><span title="Proxy subscription streams" class="linkLabel_WmDU">Proxy subscription streams</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/admin_web"><span title="Admin web UI" class="linkLabel_WmDU">Admin web UI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/observability"><span title="Server observability" class="linkLabel_WmDU">Server observability</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/infra_tuning"><span title="Infrastructure tuning" class="linkLabel_WmDU">Infrastructure tuning</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/load_balancing"><span title="Load balancing" class="linkLabel_WmDU">Load balancing</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/codes"><span title="Client protocol codes" class="linkLabel_WmDU">Client protocol codes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/server/console_commands"><span title="Helper CLI commands" class="linkLabel_WmDU">Helper CLI commands</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Built-in API command async consumers</h1></header><p>In <a class="" href="/docs/server/server_api">server API</a> chapter we&#x27;ve shown how to execute various Centrifugo server API commands (publish, broadcast, etc.) over HTTP or GRPC. In many cases you will call those APIs from your application business logic synchronously. But to deal with temporary network and availability issues, and achieve reliable execution of API commands upon changes in your primary application database you may want to use queuing techniques and call Centrifugo API asynchronously.</p>
<p>Asynchronous delivery of real-time events upon changes in primary database may be done is several ways. Some companies use transactional outbox pattern, some using techniques like Kafka Connect with CDC (Change Data Capture) approach. The fact Centrifugo provides API allows users to implement any of those techniques and build worker which will send API commands to Centrifugo reliably.</p>
<p>But Centrifugo also provides some built-in asynchronous consumers to simplify the integration process.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="supported-consumers">Supported consumers<a href="#supported-consumers" class="hash-link" aria-label="Direct link to Supported consumers" title="Direct link to Supported consumers" translate="no">​</a></h2>
<p>The following built-in async consumers are available at this point:</p>
<ul>
<li class=""><a href="#postgresql-outbox-consumer" class="">from PostgreSQL outbox table</a></li>
<li class=""><a href="#kafka-consumer" class="">from Kafka topics</a></li>
<li class=""><a href="#nats-jetstream" class="">from Nats Jetstream</a></li>
<li class=""><a href="#redis-stream" class="">from Redis Streams</a></li>
<li class=""><a href="#google-cloud-pubsub" class="">from Google Cloud PUB/SUB</a></li>
<li class=""><a href="#aws-sqs" class="">from AWS SQS</a></li>
<li class=""><a href="#azure-service-bus" class="">from Azure Service Bus</a></li>
</ul>
<p>Again, while built-in consumers can simplify integration, you still can use whatever queue system you need and integrate your own consumer with Centrifugo sending requests to <a class="" href="/docs/server/server_api">server API</a>.</p>
<p>We also recommend looking at <a class="" href="/blog/2023/08/19/asynchronous-message-streaming-to-centrifugo-with-benthos#pitfalls-of-async-publishing">Pitfalls of async publishing</a> part in our previous blog post – while in many cases you get reliable at least once processing, you may come across some pitfalls in the process, being prepared and understanding them is important. Then depending on the real-time feature you can decide which approach is better – synchronous publishing or asynchronous integration.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="how-consumers-work">How consumers work<a href="#how-consumers-work" class="hash-link" aria-label="Direct link to How consumers work" title="Direct link to How consumers work" translate="no">​</a></h2>
<p>By default, consumers expect to consume messages which represent Centrifugo <a class="" href="/docs/server/server_api">server API commands</a>. I.e. while in synchronous server API you are using HTTP or GRPC to send commands – with asynchronous consumers you are inserting API command to PostgreSQL outbox table, or delivering to Kafka topic – and it will be soon consumed and processed asynchronously by Centrifugo.</p>
<p>Async consumers only process commands which modify state – such as <a class="" href="/docs/server/server_api#publish">publish</a>, <a class="" href="/docs/server/server_api#broadcast">broadcast</a>, <a class="" href="/docs/server/server_api#unsubscribe">unsubscribe</a>, <a class="" href="/docs/server/server_api#disconnect">disconnect</a>, etc. Sending read commands for async execution simply does not make any sense, and they will be ignored. Also, <a class="" href="/docs/server/server_api#batch">batch</a> method is not supported.</p>
<p>Centrifugo <strong>only supports JSON payloads for asynchronous commands coming to consumers for now</strong>. If you need binary format – reach out with your use case.</p>
<p>If Centrifugo encounters an error while processing consumed messages – then internal errors will be retried, all other errors logged on <code>error</code> level – and the message will be marked as processed. The processing logic for <a class="" href="/docs/server/server_api#broadcast">broadcast</a> API is special: if any of the publications to any channel from broadcast <code>channels</code> array failed – then the entire broadcast command will be retried. To prevent duplicate messages being published during such retries – consider using <code>idempotency_key</code> in the broadcast command.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Our <a class="" href="/docs/tutorial/outbox_cdc">Chat/Messenger tutorial</a> shows PostgreSQL outbox and Kafka consumer in action. It also shows techniques to avoid duplicate messages (idempotent publications) and deal with late message delivery (idempotent processing on client side). Whether you need those techniques – depends on the nature of app. Various real-time features may require different ways of sending real-time events. Both synchronous API calls and async calls have its own advantages and trade-offs. We also talk about this in <a class="" href="/blog/2023/08/19/asynchronous-message-streaming-to-centrifugo-with-benthos">Asynchronous message streaming to Centrifugo with Benthos</a> blog post.</p></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="publication-data-mode">Publication data mode<a href="#publication-data-mode" class="hash-link" aria-label="Direct link to Publication data mode" title="Direct link to Publication data mode" translate="no">​</a></h2>
<p>As mentioned, Centrifugo expects server API commands in received message content. Once the command consumed – it&#x27;s processed in the same way as HTTP or GRPC server APIs process the request.</p>
<p>Sometimes though, you may have a system that already produces messages in a format ready to be published into Centrifugo channels. Most Centrifugo async consumers have a special mode to consume publications – called <strong>Publication Data Mode</strong>. In that case, payload of message must contain a data ready to be published into Centrifugo channels. Users can provide Centrifugo-specific publication fields like a list of channels to publish into in message headers/attributes. See documentation of each specific consumer to figure out exact option names. For example, Kafka consumer <a href="#publication-data-mode" class="">has publication data mode</a>. And similar for other consumers.</p>
<p>Note, since you can provide many consumers in Centrifugo configuration - it&#x27;s totally possible to have consumers working in different modes.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="ordering-guarantees">Ordering guarantees<a href="#ordering-guarantees" class="hash-link" aria-label="Direct link to Ordering guarantees" title="Direct link to Ordering guarantees" translate="no">​</a></h2>
<p>Carefully read specific consumer documentation for understanding message processing ordering properties – ordered processing can be achieved with some of them, and can not with others.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="how-to-enable">How to enable<a href="#how-to-enable" class="hash-link" aria-label="Direct link to How to enable" title="Direct link to How to enable" translate="no">​</a></h2>
<p>Consumers can be set in the configuration using <code>consumers</code> array:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_OeMC">config.json</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;consumers&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;enabled&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;xxx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;postgresql&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;postgresql&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;enabled&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;yyy&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kafka&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;kafka&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumers"><code>consumers[]</code><a href="#consumers" class="hash-link" aria-label="Direct link to consumers" title="Direct link to consumers" translate="no">​</a></h2>
<p>So consumers may be configured using <code>consumers</code> array on configuration top level.</p>
<p>On top level each consumer object in the <code>consumers</code> array has the following configuration options.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersenabled"><code>consumers[].enabled</code><a href="#consumersenabled" class="hash-link" aria-label="Direct link to consumersenabled" title="Direct link to consumersenabled" translate="no">​</a></h3>
<p>Boolean. Default: <code>false</code>.</p>
<p>When set to <code>true</code> allows enabling the configured consumer.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersname"><code>consumers[].name</code><a href="#consumersname" class="hash-link" aria-label="Direct link to consumersname" title="Direct link to consumersname" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>. Required.</p>
<p>Describes name of consumer. Must be unique for each consumer and match the regex <code>^[a-zA-Z0-9_]{2,}</code> - i.e. latin symbols, digits and underscores and be at least 2 symbols. This name will be used for logging purposes, metrics, also to override some options with environment variables.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerstype"><code>consumers[].type</code><a href="#consumerstype" class="hash-link" aria-label="Direct link to consumerstype" title="Direct link to consumerstype" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>. Required.</p>
<p>Type of consumer. At this point can be:</p>
<ul>
<li class=""><code>postgresql</code></li>
<li class=""><code>kafka</code></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="configure-via-env-vars">Configure via env vars<a href="#configure-via-env-vars" class="hash-link" aria-label="Direct link to Configure via env vars" title="Direct link to Configure via env vars" translate="no">​</a></h2>
<p>To provide <code>consumers</code> over environment variable provide <code>CENTRIFUGO_CONSUMERS</code> var with JSON array serialized to string.</p>
<p>It&#x27;s also possible to override consumer options over environment variables by using the name of consumer. For example:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CENTRIFUGO_CONSUMERS_&lt;CONSUMER_NAME&gt;_&lt;OPTION_NAME&gt;=&quot;???&quot;</span><br></span></code></pre></div></div>
<p>Or for specific type configuration:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CENTRIFUGO_CONSUMERS_&lt;CONSUMER_NAME&gt;_POSTGRESQL_&lt;OPTION_NAME2&gt;=&quot;???&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="postgresql-outbox-consumer">PostgreSQL outbox consumer<a href="#postgresql-outbox-consumer" class="hash-link" aria-label="Direct link to PostgreSQL outbox consumer" title="Direct link to PostgreSQL outbox consumer" translate="no">​</a></h2>
<p>Centrifugo can natively integrate with PostgreSQL table for <a href="https://microservices.io/patterns/data/transactional-outbox.html" target="_blank" rel="noopener noreferrer" class="">Transactional outbox</a> pattern. The table in PostgreSQL must have predefined format Centrifugo expects:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TABLE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">IF</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">EXISTS</span><span class="token plain"> centrifugo_outbox </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	id BIGSERIAL </span><span class="token keyword" style="font-style:italic">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">KEY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	method </span><span class="token keyword" style="font-style:italic">text</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	payload JSONB </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><span class="token keyword" style="font-style:italic">partition</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INTEGER</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">default</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	created_at </span><span class="token keyword" style="font-style:italic">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">WITH</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TIME</span><span class="token plain"> ZONE </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">now</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre></div></div>
<p>Then configure consumer of <code>postgresql</code> type in Centrifugo config:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;consumers&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;enabled&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my_postgresql_consumer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;postgresql&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;postgresql&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;dsn&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;postgresql://user:password@localhost:5432/db&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;outbox_table_name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;centrifugo_outbox&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;num_partitions&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;partition_select_limit&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;partition_poll_interval&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;300ms&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<p>Here is how you can insert row in outbox table to publish into Centrifugo channel:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">INSERT</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INTO</span><span class="token plain"> centrifugo_outbox </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">method</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">partition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;publish&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{&quot;channel&quot;: &quot;updates&quot;, &quot;data&quot;: {&quot;text&quot;: &quot;Hello, world!&quot;}}&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre></div></div>
<p>Centrifugo supports LISTEN/NOTIFY mechanism of PostgreSQL to be notified about new data in the outbox table. To enable it you need first create a trigger in PostgreSQL:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">CREATE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">REPLACE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">FUNCTION</span><span class="token plain"> centrifugo_notify_partition_change</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">RETURNS</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TRIGGER</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">AS</span><span class="token plain"> $$</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PERFORM pg_notify</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;centrifugo_partition_change&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> NEW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="font-style:italic">partition</span><span class="token plain">::</span><span class="token keyword" style="font-style:italic">text</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">RETURN</span><span class="token plain"> NEW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">END</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$$ </span><span class="token keyword" style="font-style:italic">LANGUAGE</span><span class="token plain"> plpgsql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">CREATE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">REPLACE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TRIGGER</span><span class="token plain"> centrifugo_notify_partition_trigger</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">AFTER</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INSERT</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">ON</span><span class="token plain"> chat_outbox</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">FOR EACH ROW</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">EXECUTE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">FUNCTION</span><span class="token plain"> centrifugo_notify_partition_change</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre></div></div>
<p>And then update consumer config – add <code>&quot;partition_notification_channel&quot;</code> option to it:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;consumers&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;enabled&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my_postgresql_consumer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;postgresql&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;postgresql&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;partition_notification_channel&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;centrifugo_partition_change&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresql"><code>consumers[].postgresql</code><a href="#consumerspostgresql" class="hash-link" aria-label="Direct link to consumerspostgresql" title="Direct link to consumerspostgresql" translate="no">​</a></h2>
<p>Options for consumer of <code>postgresql</code> type.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresqldsn"><code>consumers[].postgresql.dsn</code><a href="#consumerspostgresqldsn" class="hash-link" aria-label="Direct link to consumerspostgresqldsn" title="Direct link to consumerspostgresqldsn" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>. Required.</p>
<p>DSN to PostgreSQL database, ex. <code>&quot;postgresql://user:password@localhost:5432/db&quot;</code>. To override <code>dsn</code> over environment variables use <code>CENTRIFUGO_CONSUMERS_&lt;CONSUMER_NAME&gt;_POSTGRESQL_DSN</code>.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresqloutbox_table_name"><code>consumers[].postgresql.outbox_table_name</code><a href="#consumerspostgresqloutbox_table_name" class="hash-link" aria-label="Direct link to consumerspostgresqloutbox_table_name" title="Direct link to consumerspostgresqloutbox_table_name" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>. Required.</p>
<p>The name of outbox table in selected database, ex. <code>&quot;centrifugo_outbox&quot;</code>.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresqlnum_partitions"><code>consumers[].postgresql.num_partitions</code><a href="#consumerspostgresqlnum_partitions" class="hash-link" aria-label="Direct link to consumerspostgresqlnum_partitions" title="Direct link to consumerspostgresqlnum_partitions" translate="no">​</a></h3>
<p>Integer. Default: <code>1</code>.</p>
<p>The number of partitions to use. Centrifugo keeps strict order of commands per-partition by default. This option provides a way to create concurrent consumers each consuming from different partition of outbox table. Note, that partition numbers in start with <code>0</code>, so when using <code>1</code> as <code>num_partitions</code> insert data with <code>partition</code> == <code>0</code> to the outbox table.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresqlpartition_select_limit"><code>consumers[].postgresql.partition_select_limit</code><a href="#consumerspostgresqlpartition_select_limit" class="hash-link" aria-label="Direct link to consumerspostgresqlpartition_select_limit" title="Direct link to consumerspostgresqlpartition_select_limit" translate="no">​</a></h3>
<p>Integer. Default: <code>100</code>.</p>
<p>Max number of commands to select in one query to outbox table.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresqlpartition_poll_interval"><code>consumers[].postgresql.partition_poll_interval</code><a href="#consumerspostgresqlpartition_poll_interval" class="hash-link" aria-label="Direct link to consumerspostgresqlpartition_poll_interval" title="Direct link to consumerspostgresqlpartition_poll_interval" translate="no">​</a></h3>
<p><a class="" href="/docs/server/configuration#duration-type">Duration</a>. Default: <code>&quot;300ms&quot;</code>.</p>
<p>Polling interval for each partition.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresqlpartition_notification_channel"><code>consumers[].postgresql.partition_notification_channel</code><a href="#consumerspostgresqlpartition_notification_channel" class="hash-link" aria-label="Direct link to consumerspostgresqlpartition_notification_channel" title="Direct link to consumerspostgresqlpartition_notification_channel" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>.</p>
<p>Optional name of LISTEN/NOTIFY channel to trigger consuming upon data added to outbox partition.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresqltls"><code>consumers[].postgresql.tls</code><a href="#consumerspostgresqltls" class="hash-link" aria-label="Direct link to consumerspostgresqltls" title="Direct link to consumerspostgresqltls" translate="no">​</a></h3>
<p><a class="" href="/docs/server/configuration#tls-config-object">TLS object</a>. By default, no TLS is used.</p>
<p>Client TLS configuration for PostgreSQL connection.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerspostgresqluse_try_lock"><code>consumers[].postgresql.use_try_lock</code><a href="#consumerspostgresqluse_try_lock" class="hash-link" aria-label="Direct link to consumerspostgresqluse_try_lock" title="Direct link to consumerspostgresqluse_try_lock" translate="no">​</a></h3>
<p>Boolean. Default: <code>false</code>.</p>
<p>Use <code>pg_try_advisory_xact_lock</code> instead of <code>pg_advisory_xact_lock</code> for locking outbox table. This may help to reduce the number of longer-running transactions on PG side.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="kafka-consumer">Kafka consumer<a href="#kafka-consumer" class="hash-link" aria-label="Direct link to Kafka consumer" title="Direct link to Kafka consumer" translate="no">​</a></h2>
<p>Another built-in consumer – is Kafka topics consumer. To configure Centrifugo to consume Kafka topic:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_OeMC">config.json</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;consumers&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;enabled&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my_kafka_consumer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kafka&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;kafka&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;brokers&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;localhost:9092&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;topics&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;postgres.public.chat_cdc&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;consumer_group&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;centrifugo&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<p>Then simply put message in the following format to Kafka topic:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;method&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;publish&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;payload&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;channel&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mychannel&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;data&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<p>– and it will be consumed by Centrifugo and reliably processed.</p>
<p>Centrifugo preserves processing order within Kafka partitions.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafka"><code>consumers[].kafka</code><a href="#consumerskafka" class="hash-link" aria-label="Direct link to consumerskafka" title="Direct link to consumerskafka" translate="no">​</a></h2>
<p>Options for consumer of <code>kafka</code> type.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkabrokers"><code>consumers[].kafka.brokers</code><a href="#consumerskafkabrokers" class="hash-link" aria-label="Direct link to consumerskafkabrokers" title="Direct link to consumerskafkabrokers" translate="no">​</a></h3>
<p>Array of string. Required.</p>
<p>Points Centrifugo to Kafka brokers. To override <code>brokers</code> over environment variables use <code>CENTRIFUGO_CONSUMERS_&lt;CONSUMER_NAME&gt;_KAFKA_BROKERS</code> – string with broker addresses separated by space.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkatopics"><code>consumers[].kafka.topics</code><a href="#consumerskafkatopics" class="hash-link" aria-label="Direct link to consumerskafkatopics" title="Direct link to consumerskafkatopics" translate="no">​</a></h3>
<p>Array of string. Required.</p>
<p>Tells which topics to consume.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkaconsumer_group"><code>consumers[].kafka.consumer_group</code><a href="#consumerskafkaconsumer_group" class="hash-link" aria-label="Direct link to consumerskafkaconsumer_group" title="Direct link to consumerskafkaconsumer_group" translate="no">​</a></h3>
<p>String. Required.</p>
<p>Sets the name of consumer group to use.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkamax_poll_records"><code>consumers[].kafka.max_poll_records</code><a href="#consumerskafkamax_poll_records" class="hash-link" aria-label="Direct link to consumerskafkamax_poll_records" title="Direct link to consumerskafkamax_poll_records" translate="no">​</a></h3>
<p>Integer. Default: <code>100</code>.</p>
<p>Sets the maximum number of records to fetch from Kafka during a single poll operation.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkafetch_max_bytes"><code>consumers[].kafka.fetch_max_bytes</code><a href="#consumerskafkafetch_max_bytes" class="hash-link" aria-label="Direct link to consumerskafkafetch_max_bytes" title="Direct link to consumerskafkafetch_max_bytes" translate="no">​</a></h3>
<p>Integer. Default: <code>52428800</code> (50MB).</p>
<p>Sets the maximum number of bytes to fetch from Kafka in a single request. In many cases setting this to lower value can help with aggressive Kafka client memory usage under load.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkafetch_max_wait"><code>consumers[].kafka.fetch_max_wait</code><a href="#consumerskafkafetch_max_wait" class="hash-link" aria-label="Direct link to consumerskafkafetch_max_wait" title="Direct link to consumerskafkafetch_max_wait" translate="no">​</a></h3>
<p>Type: <code>Duration</code>. Default: <code>500ms</code>. New in Centrifugo v6.2.3</p>
<p>Sets the maximum time to wait for records when polling.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkafetch_read_uncommitted"><code>consumers[].kafka.fetch_read_uncommitted</code><a href="#consumerskafkafetch_read_uncommitted" class="hash-link" aria-label="Direct link to consumerskafkafetch_read_uncommitted" title="Direct link to consumerskafkafetch_read_uncommitted" translate="no">​</a></h3>
<p>Boolean. Default: <code>false</code>. New in Centrifugo v6.2.3</p>
<p>If set to <code>true</code>, the consumer will read uncommitted messages from Kafka. By default, it uses <code>ReadCommitted</code> mode.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkasasl_mechanism"><code>consumers[].kafka.sasl_mechanism</code><a href="#consumerskafkasasl_mechanism" class="hash-link" aria-label="Direct link to consumerskafkasasl_mechanism" title="Direct link to consumerskafkasasl_mechanism" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>.</p>
<p>SASL mechanism to use: <code>&quot;plain&quot;</code>, <code>&quot;scram-sha-256&quot;</code>, <code>&quot;scram-sha-512&quot;</code>, <code>&quot;aws-msk-iam&quot;</code> are supported. Note, in case of <code>&quot;aws-msk-iam&quot;</code> Centrifugo uses <code>sasl_user</code> and <code>sasl_password</code> options as <code>access key</code> and <code>secret key</code> when configuring AWS auth.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkasasl_user"><code>consumers[].kafka.sasl_user</code><a href="#consumerskafkasasl_user" class="hash-link" aria-label="Direct link to consumerskafkasasl_user" title="Direct link to consumerskafkasasl_user" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>.</p>
<p>User for plain SASL auth. To override <code>sasl_user</code> over environment variables use <code>CENTRIFUGO_CONSUMERS_&lt;CONSUMER_NAME&gt;_KAFKA_SASL_USER</code>.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkasasl_password"><code>consumers[].kafka.sasl_password</code><a href="#consumerskafkasasl_password" class="hash-link" aria-label="Direct link to consumerskafkasasl_password" title="Direct link to consumerskafkasasl_password" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>.</p>
<p>Password for plain SASL auth. To override <code>sasl_password</code> over environment variables use <code>CENTRIFUGO_CONSUMERS_&lt;CONSUMER_NAME&gt;_KAFKA_SASL_PASSWORD</code>.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkatls"><code>consumers[].kafka.tls</code><a href="#consumerskafkatls" class="hash-link" aria-label="Direct link to consumerskafkatls" title="Direct link to consumerskafkatls" translate="no">​</a></h3>
<p><a class="" href="/docs/server/tls#unified-tls-config-object">TLSConfig</a> to configure Kafka client TLS.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkapublication_data_mode"><code>consumers[].kafka.publication_data_mode</code><a href="#consumerskafkapublication_data_mode" class="hash-link" aria-label="Direct link to consumerskafkapublication_data_mode" title="Direct link to consumerskafkapublication_data_mode" translate="no">​</a></h3>
<p>Publication data mode for Kafka consumer simplifies integrating Centrifugo with existing Kafka topics. By default, Centrifugo can integrate with Kafka topics but requires a special payload format, where each message in the topic represented a Centrifugo API command. This approach works well for Kafka topics specifically set up for Centrifugo.</p>
<p>When <strong>Publication Data Mode</strong> is enabled, Centrifugo expects messages in Kafka topics to contain data ready for direct publication, rather than server API commands. It is also possible to use special Kafka headers to specify the channels to which the data should be published.</p>
<p>The primary goal of this mode is to simplify Centrifugo&#x27;s integration with existing Kafka topics, making it easier to deliver real-time messages to clients without needing to restructure the topic&#x27;s payload format.</p>
<p>BTW, don&#x27;t forget that since Centrifugo allows configuring an array of asynchronous consumers, it is possible to use Kafka consumers in different modes simultaneously.</p>
<p>To enable publication data mode:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_OeMC">config.json</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;consumers&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;enabled&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my_kafka_consumer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kafka&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;kafka&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;brokers&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;localhost:9092&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;topics&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my_topic&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;consumer_group&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;centrifugo&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;publication_data_mode&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;enabled&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;channels_header&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;x-centrifugo-channels&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;idempotency_key_header&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;x-centrifugo-idempotency-key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<p>As you can see, channels to forward publication to may be provided as a value of a configured header. So you don&#x27;t need to change payloads in topic to transform them to real-time messages with Centrifugo.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkapublication_data_modeenabled"><code>consumers[].kafka.publication_data_mode.enabled</code><a href="#consumerskafkapublication_data_modeenabled" class="hash-link" aria-label="Direct link to consumerskafkapublication_data_modeenabled" title="Direct link to consumerskafkapublication_data_modeenabled" translate="no">​</a></h3>
<p>Boolean. Default: <code>false</code>.</p>
<p>Enables Kafka publication data mode for the Kafka consumer.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkapublication_data_modechannels_header"><code>consumers[].kafka.publication_data_mode.channels_header</code><a href="#consumerskafkapublication_data_modechannels_header" class="hash-link" aria-label="Direct link to consumerskafkapublication_data_modechannels_header" title="Direct link to consumerskafkapublication_data_modechannels_header" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>.</p>
<p>Header name to extract channels to publish data into (channels must be comma-separated). Ex. of value: <code>&quot;channel1,channel2&quot;</code>.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkapublication_data_modeidempotency_key_header"><code>consumers[].kafka.publication_data_mode.idempotency_key_header</code><a href="#consumerskafkapublication_data_modeidempotency_key_header" class="hash-link" aria-label="Direct link to consumerskafkapublication_data_modeidempotency_key_header" title="Direct link to consumerskafkapublication_data_modeidempotency_key_header" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>.</p>
<p>Header name to extract Publication idempotency key from Kafka message. See <a class="" href="/docs/server/server_api#publishrequest">PublishRequest</a>.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumerskafkapublication_data_modedelta_header"><code>consumers[].kafka.publication_data_mode.delta_header</code><a href="#consumerskafkapublication_data_modedelta_header" class="hash-link" aria-label="Direct link to consumerskafkapublication_data_modedelta_header" title="Direct link to consumerskafkapublication_data_modedelta_header" translate="no">​</a></h3>
<p>String. Default: <code>&quot;&quot;</code>.</p>
<p>Header name to extract Publication delta flag from Kafka message which tells Centrifugo whether to use delta compression for message or not. See <a class="" href="/docs/server/delta_compression">delta compression</a> and <a class="" href="/docs/server/server_api#publishrequest">PublishRequest</a>.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="compatibility-with-redpanda">Compatibility with Redpanda<a href="#compatibility-with-redpanda" class="hash-link" aria-label="Direct link to Compatibility with Redpanda" title="Direct link to Compatibility with Redpanda" translate="no">​</a></h3>
<p>Our local test suite for Kafka consumer passed with <a href="https://www.redpanda.com/" target="_blank" rel="noopener noreferrer" class="">Redpanda</a> v24.3.6, so it&#x27;s generally compatible.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="nats-jetstream">Nats Jetstream<a href="#nats-jetstream" class="hash-link" aria-label="Direct link to Nats Jetstream" title="Direct link to Nats Jetstream" translate="no">​</a></h2>
<p>Consumer from <a href="https://docs.nats.io/nats-concepts/jetstream" target="_blank" rel="noopener noreferrer" class="">Nats Jetstream</a>.</p>
<p>Note, message processing is unordered in case you have multiple Centrifugo instances consuming from Nats Jetstream (but possible if only one instance of Centrifugo consumes).</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Keep in mind, that Centrifugo does not create Nats Jetstream streams, it consumes from pre-created streams. Pay attention to a situation when Nats Jetstream streams are created in-memory or inside temporary directory of operating system. In such cases Nats streams may be unexpectedly lost at some point – this is a common mistake when working with Nats Jetstream.</p></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstream"><code>consumers[].nats_jetstream</code><a href="#consumersnats_jetstream" class="hash-link" aria-label="Direct link to consumersnats_jetstream" title="Direct link to consumersnats_jetstream" translate="no">​</a></h2>
<p>Type: <code>NatsJetStreamConsumerConfig</code> object</p>
<p><code>nats_jetstream</code> allows defining options for consumer of <code>nats_jetstream</code> type.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamurl"><code>consumers[].nats_jetstream.url</code><a href="#consumersnats_jetstreamurl" class="hash-link" aria-label="Direct link to consumersnats_jetstreamurl" title="Direct link to consumersnats_jetstreamurl" translate="no">​</a></h3>
<p>Type: <code>string</code>. Default: <code>nats://127.0.0.1:4222</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_URL</code></p>
<p><code>url</code> is the address of the NATS server.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamcredentials_file"><code>consumers[].nats_jetstream.credentials_file</code><a href="#consumersnats_jetstreamcredentials_file" class="hash-link" aria-label="Direct link to consumersnats_jetstreamcredentials_file" title="Direct link to consumersnats_jetstreamcredentials_file" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_CREDENTIALS_FILE</code></p>
<p><code>credentials_file</code> is the path to a NATS credentials file used for authentication (nats.UserCredentials).
If provided, it overrides username/password and token.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamusername"><code>consumers[].nats_jetstream.username</code><a href="#consumersnats_jetstreamusername" class="hash-link" aria-label="Direct link to consumersnats_jetstreamusername" title="Direct link to consumersnats_jetstreamusername" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_USERNAME</code></p>
<p><code>username</code> is used for basic authentication (along with Password) if CredentialsFile is not provided.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampassword"><code>consumers[].nats_jetstream.password</code><a href="#consumersnats_jetstreampassword" class="hash-link" aria-label="Direct link to consumersnats_jetstreampassword" title="Direct link to consumersnats_jetstreampassword" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_PASSWORD</code></p>
<p><code>password</code> is used with Username for basic authentication.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamtoken"><code>consumers[].nats_jetstream.token</code><a href="#consumersnats_jetstreamtoken" class="hash-link" aria-label="Direct link to consumersnats_jetstreamtoken" title="Direct link to consumersnats_jetstreamtoken" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_TOKEN</code></p>
<p><code>token</code> is an alternative authentication mechanism if CredentialsFile and Username are not provided.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamstream_name"><code>consumers[].nats_jetstream.stream_name</code><a href="#consumersnats_jetstreamstream_name" class="hash-link" aria-label="Direct link to consumersnats_jetstreamstream_name" title="Direct link to consumersnats_jetstreamstream_name" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_STREAM_NAME</code></p>
<p><code>stream_name</code> is the name of the NATS JetStream stream to use.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamsubjects"><code>consumers[].nats_jetstream.subjects</code><a href="#consumersnats_jetstreamsubjects" class="hash-link" aria-label="Direct link to consumersnats_jetstreamsubjects" title="Direct link to consumersnats_jetstreamsubjects" translate="no">​</a></h3>
<p>Type: <code>[]string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_SUBJECTS</code></p>
<p><code>subjects</code> is the list of NATS subjects (topics) to filter.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamdurable_consumer_name"><code>consumers[].nats_jetstream.durable_consumer_name</code><a href="#consumersnats_jetstreamdurable_consumer_name" class="hash-link" aria-label="Direct link to consumersnats_jetstreamdurable_consumer_name" title="Direct link to consumersnats_jetstreamdurable_consumer_name" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_DURABLE_CONSUMER_NAME</code></p>
<p><code>durable_consumer_name</code> sets the name of the durable JetStream consumer to use.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamdeliver_policy"><code>consumers[].nats_jetstream.deliver_policy</code><a href="#consumersnats_jetstreamdeliver_policy" class="hash-link" aria-label="Direct link to consumersnats_jetstreamdeliver_policy" title="Direct link to consumersnats_jetstreamdeliver_policy" translate="no">​</a></h3>
<p>Type: <code>string</code>. Default: <code>new</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_DELIVER_POLICY</code></p>
<p><code>deliver_policy</code> is the NATS JetStream delivery policy for the consumer. By default, it is set to &quot;new&quot;. Possible values: <code>new</code>, <code>all</code>.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreammax_ack_pending"><code>consumers[].nats_jetstream.max_ack_pending</code><a href="#consumersnats_jetstreammax_ack_pending" class="hash-link" aria-label="Direct link to consumersnats_jetstreammax_ack_pending" title="Direct link to consumersnats_jetstreammax_ack_pending" translate="no">​</a></h3>
<p>Type: <code>int</code>. Default: <code>100</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_MAX_ACK_PENDING</code></p>
<p><code>max_ack_pending</code> is the maximum number of unacknowledged messages that can be pending for the consumer.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreammethod_header"><code>consumers[].nats_jetstream.method_header</code><a href="#consumersnats_jetstreammethod_header" class="hash-link" aria-label="Direct link to consumersnats_jetstreammethod_header" title="Direct link to consumersnats_jetstreammethod_header" translate="no">​</a></h3>
<p>Type: <code>string</code>. Default: <code>centrifugo-method</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_METHOD_HEADER</code></p>
<p><code>method_header</code> is the NATS message header used to extract the method name for dispatching commands.
If provided in message, then payload must be just a serialized API request object.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamuse_existing_consumer"><code>consumers[].nats_jetstream.use_existing_consumer</code><a href="#consumersnats_jetstreamuse_existing_consumer" class="hash-link" aria-label="Direct link to consumersnats_jetstreamuse_existing_consumer" title="Direct link to consumersnats_jetstreamuse_existing_consumer" translate="no">​</a></h3>
<p>Type: <code>bool</code>. Default: <code>false</code></p>
<p>New in Centrifugo v6.5.2</p>
<p><code>use_existing_consumer</code> when enabled tells Centrifugo to use an existing consumer with durable_consumer_name instead of creating a new one. When on, these fields are ignored: deliver_policy, subjects, max_ack_pending, and all other consumer-creation-related options which may be added later (like ack wait, etc.). The existing consumer&#x27;s configuration defines all behavior, and Centrifugo will fail to start if the consumer does not already exist.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampublication_data_mode"><code>consumers[].nats_jetstream.publication_data_mode</code><a href="#consumersnats_jetstreampublication_data_mode" class="hash-link" aria-label="Direct link to consumersnats_jetstreampublication_data_mode" title="Direct link to consumersnats_jetstreampublication_data_mode" translate="no">​</a></h3>
<p>Type: <code>NatsJetStreamPublicationDataModeConfig</code> object</p>
<p><code>publication_data_mode</code> configures extraction of pre-formatted publication data from message headers.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampublication_data_modeenabled"><code>consumers[].nats_jetstream.publication_data_mode.enabled</code><a href="#consumersnats_jetstreampublication_data_modeenabled" class="hash-link" aria-label="Direct link to consumersnats_jetstreampublication_data_modeenabled" title="Direct link to consumersnats_jetstreampublication_data_modeenabled" translate="no">​</a></h4>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_PUBLICATION_DATA_MODE_ENABLED</code></p>
<p><code>enabled</code> toggles publication data mode.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampublication_data_modechannels_header"><code>consumers[].nats_jetstream.publication_data_mode.channels_header</code><a href="#consumersnats_jetstreampublication_data_modechannels_header" class="hash-link" aria-label="Direct link to consumersnats_jetstreampublication_data_modechannels_header" title="Direct link to consumersnats_jetstreampublication_data_modechannels_header" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-channels</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_PUBLICATION_DATA_MODE_CHANNELS_HEADER</code></p>
<p><code>channels_header</code> is the name of the header that contains comma-separated channel names.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampublication_data_modeidempotency_key_header"><code>consumers[].nats_jetstream.publication_data_mode.idempotency_key_header</code><a href="#consumersnats_jetstreampublication_data_modeidempotency_key_header" class="hash-link" aria-label="Direct link to consumersnats_jetstreampublication_data_modeidempotency_key_header" title="Direct link to consumersnats_jetstreampublication_data_modeidempotency_key_header" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-idempotency-key</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_PUBLICATION_DATA_MODE_IDEMPOTENCY_KEY_HEADER</code></p>
<p><code>idempotency_key_header</code> is the name of the header that contains an idempotency key for deduplication.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampublication_data_modedelta_header"><code>consumers[].nats_jetstream.publication_data_mode.delta_header</code><a href="#consumersnats_jetstreampublication_data_modedelta_header" class="hash-link" aria-label="Direct link to consumersnats_jetstreampublication_data_modedelta_header" title="Direct link to consumersnats_jetstreampublication_data_modedelta_header" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-delta</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_PUBLICATION_DATA_MODE_DELTA_HEADER</code></p>
<p><code>delta_header</code> is the name of the header indicating whether the message represents a delta (partial update).</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampublication_data_modeversion_header"><code>consumers[].nats_jetstream.publication_data_mode.version_header</code><a href="#consumersnats_jetstreampublication_data_modeversion_header" class="hash-link" aria-label="Direct link to consumersnats_jetstreampublication_data_modeversion_header" title="Direct link to consumersnats_jetstreampublication_data_modeversion_header" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_PUBLICATION_DATA_MODE_VERSION_HEADER</code></p>
<p><code>version_header</code> is the name of the header that contains the version of the message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampublication_data_modeversion_epoch_header"><code>consumers[].nats_jetstream.publication_data_mode.version_epoch_header</code><a href="#consumersnats_jetstreampublication_data_modeversion_epoch_header" class="hash-link" aria-label="Direct link to consumersnats_jetstreampublication_data_modeversion_epoch_header" title="Direct link to consumersnats_jetstreampublication_data_modeversion_epoch_header" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version-epoch</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_PUBLICATION_DATA_MODE_VERSION_EPOCH_HEADER</code></p>
<p><code>version_epoch_header</code> is the name of the header that contains the version epoch of the message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreampublication_data_modetags_header_prefix"><code>consumers[].nats_jetstream.publication_data_mode.tags_header_prefix</code><a href="#consumersnats_jetstreampublication_data_modetags_header_prefix" class="hash-link" aria-label="Direct link to consumersnats_jetstreampublication_data_modetags_header_prefix" title="Direct link to consumersnats_jetstreampublication_data_modetags_header_prefix" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-tag-</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_NATS_JETSTREAM_PUBLICATION_DATA_MODE_TAGS_HEADER_PREFIX</code></p>
<p><code>tags_header_prefix</code> is the prefix used to extract dynamic tags from message headers.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersnats_jetstreamtls"><code>consumers[].nats_jetstream.tls</code><a href="#consumersnats_jetstreamtls" class="hash-link" aria-label="Direct link to consumersnats_jetstreamtls" title="Direct link to consumersnats_jetstreamtls" translate="no">​</a></h3>
<p>Type: <code>TLSConfig</code> object</p>
<p><a class="" href="/docs/server/configuration#tls-config-object">TLS object</a>. By default, no TLS is used.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="redis-stream">Redis Stream<a href="#redis-stream" class="hash-link" aria-label="Direct link to Redis Stream" title="Direct link to Redis Stream" translate="no">​</a></h2>
<p>Note, message processing is unordered in case you have multiple Centrifugo instances consuming from Redis Stream (but possible if only one instance of Centrifugo consumes and <code>num_workers</code> is <code>1</code>).</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_stream"><code>consumers[].redis_stream</code><a href="#consumersredis_stream" class="hash-link" aria-label="Direct link to consumersredis_stream" title="Direct link to consumersredis_stream" translate="no">​</a></h2>
<p>Type: <code>RedisStreamConsumerConfig</code> object</p>
<p><code>redis_stream</code> allows defining options for consumer of redis_stream type.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamaddress"><code>consumers[].redis_stream.address</code><a href="#consumersredis_streamaddress" class="hash-link" aria-label="Direct link to consumersredis_streamaddress" title="Direct link to consumersredis_streamaddress" translate="no">​</a></h3>
<p>Type: <code>[]string</code>. Default: <code>redis://127.0.0.1:6379</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_ADDRESS</code></p>
<p><code>address</code> is a list of Redis shard addresses. In most cases a single shard is used. But when many
addresses provided Centrifugo will distribute keys between shards using consistent hashing.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamconnect_timeout"><code>consumers[].redis_stream.connect_timeout</code><a href="#consumersredis_streamconnect_timeout" class="hash-link" aria-label="Direct link to consumersredis_streamconnect_timeout" title="Direct link to consumersredis_streamconnect_timeout" translate="no">​</a></h3>
<p>Type: <code>Duration</code>. Default: <code>1s</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_CONNECT_TIMEOUT</code></p>
<p><code>connect_timeout</code> is a timeout for establishing connection to Redis.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamio_timeout"><code>consumers[].redis_stream.io_timeout</code><a href="#consumersredis_streamio_timeout" class="hash-link" aria-label="Direct link to consumersredis_streamio_timeout" title="Direct link to consumersredis_streamio_timeout" translate="no">​</a></h3>
<p>Type: <code>Duration</code>. Default: <code>4s</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_IO_TIMEOUT</code></p>
<p><code>io_timeout</code> is a timeout for all read/write operations against Redis (can be considered as a request timeout).</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamdb"><code>consumers[].redis_stream.db</code><a href="#consumersredis_streamdb" class="hash-link" aria-label="Direct link to consumersredis_streamdb" title="Direct link to consumersredis_streamdb" translate="no">​</a></h3>
<p>Type: <code>int</code>. Default: <code>0</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_DB</code></p>
<p><code>db</code> is a Redis database to use. Generally it&#x27;s not recommended to use non-zero DB. Note, that Redis
PUB/SUB is global for all databases in a single Redis instance. So when using non-zero DB make sure
that different Centrifugo setups use different prefixes.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamuser"><code>consumers[].redis_stream.user</code><a href="#consumersredis_streamuser" class="hash-link" aria-label="Direct link to consumersredis_streamuser" title="Direct link to consumersredis_streamuser" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_USER</code></p>
<p><code>user</code> is a Redis user.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampassword"><code>consumers[].redis_stream.password</code><a href="#consumersredis_streampassword" class="hash-link" aria-label="Direct link to consumersredis_streampassword" title="Direct link to consumersredis_streampassword" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PASSWORD</code></p>
<p><code>password</code> is a Redis password.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamclient_name"><code>consumers[].redis_stream.client_name</code><a href="#consumersredis_streamclient_name" class="hash-link" aria-label="Direct link to consumersredis_streamclient_name" title="Direct link to consumersredis_streamclient_name" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_CLIENT_NAME</code></p>
<p><code>client_name</code> allows changing a Redis client name used when connecting.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamforce_resp2"><code>consumers[].redis_stream.force_resp2</code><a href="#consumersredis_streamforce_resp2" class="hash-link" aria-label="Direct link to consumersredis_streamforce_resp2" title="Direct link to consumersredis_streamforce_resp2" translate="no">​</a></h3>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_FORCE_RESP2</code></p>
<p><code>force_resp2</code> forces use of Redis Resp2 protocol for communication.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamcluster_address"><code>consumers[].redis_stream.cluster_address</code><a href="#consumersredis_streamcluster_address" class="hash-link" aria-label="Direct link to consumersredis_streamcluster_address" title="Direct link to consumersredis_streamcluster_address" translate="no">​</a></h3>
<p>Type: <code>[]string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_CLUSTER_ADDRESS</code></p>
<p><code>cluster_address</code> is a list of Redis cluster addresses. When several provided - data will be sharded
between them using consistent hashing. Several Cluster addresses within one shard may be passed
comma-separated.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamtls"><code>consumers[].redis_stream.tls</code><a href="#consumersredis_streamtls" class="hash-link" aria-label="Direct link to consumersredis_streamtls" title="Direct link to consumersredis_streamtls" translate="no">​</a></h3>
<p>Type: <code>TLSConfig</code> object</p>
<p><a class="" href="/docs/server/configuration#tls-config-object">TLS object</a>. By default, no TLS is used.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamsentinel_address"><code>consumers[].redis_stream.sentinel_address</code><a href="#consumersredis_streamsentinel_address" class="hash-link" aria-label="Direct link to consumersredis_streamsentinel_address" title="Direct link to consumersredis_streamsentinel_address" translate="no">​</a></h3>
<p>Type: <code>[]string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_SENTINEL_ADDRESS</code></p>
<p><code>sentinel_address</code> allows setting Redis Sentinel addresses. When provided - Sentinel will be used.
When multiple addresses provided - data will be sharded between them using consistent hashing.
Several Sentinel addresses within one shard may be passed comma-separated.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamsentinel_user"><code>consumers[].redis_stream.sentinel_user</code><a href="#consumersredis_streamsentinel_user" class="hash-link" aria-label="Direct link to consumersredis_streamsentinel_user" title="Direct link to consumersredis_streamsentinel_user" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_SENTINEL_USER</code></p>
<p><code>sentinel_user</code> is a Redis Sentinel user.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamsentinel_password"><code>consumers[].redis_stream.sentinel_password</code><a href="#consumersredis_streamsentinel_password" class="hash-link" aria-label="Direct link to consumersredis_streamsentinel_password" title="Direct link to consumersredis_streamsentinel_password" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_SENTINEL_PASSWORD</code></p>
<p><code>sentinel_password</code> is a Redis Sentinel password.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamsentinel_master_name"><code>consumers[].redis_stream.sentinel_master_name</code><a href="#consumersredis_streamsentinel_master_name" class="hash-link" aria-label="Direct link to consumersredis_streamsentinel_master_name" title="Direct link to consumersredis_streamsentinel_master_name" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_SENTINEL_MASTER_NAME</code></p>
<p><code>sentinel_master_name</code> is a Redis master name in Sentinel setup.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamsentinel_client_name"><code>consumers[].redis_stream.sentinel_client_name</code><a href="#consumersredis_streamsentinel_client_name" class="hash-link" aria-label="Direct link to consumersredis_streamsentinel_client_name" title="Direct link to consumersredis_streamsentinel_client_name" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_SENTINEL_CLIENT_NAME</code></p>
<p><code>sentinel_client_name</code> is a Redis Sentinel client name used when connecting.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamsentinel_tls"><code>consumers[].redis_stream.sentinel_tls</code><a href="#consumersredis_streamsentinel_tls" class="hash-link" aria-label="Direct link to consumersredis_streamsentinel_tls" title="Direct link to consumersredis_streamsentinel_tls" translate="no">​</a></h3>
<p>Type: <code>TLSConfig</code> object</p>
<p><a class="" href="/docs/server/configuration#tls-config-object">TLS object</a>. By default, no TLS is used.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamstreams"><code>consumers[].redis_stream.streams</code><a href="#consumersredis_streamstreams" class="hash-link" aria-label="Direct link to consumersredis_streamstreams" title="Direct link to consumersredis_streamstreams" translate="no">​</a></h3>
<p>Type: <code>[]string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_STREAMS</code></p>
<p><code>streams</code> to consume.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamconsumer_group"><code>consumers[].redis_stream.consumer_group</code><a href="#consumersredis_streamconsumer_group" class="hash-link" aria-label="Direct link to consumersredis_streamconsumer_group" title="Direct link to consumersredis_streamconsumer_group" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_CONSUMER_GROUP</code></p>
<p><code>consumer_group</code> name to use.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamvisibility_timeout"><code>consumers[].redis_stream.visibility_timeout</code><a href="#consumersredis_streamvisibility_timeout" class="hash-link" aria-label="Direct link to consumersredis_streamvisibility_timeout" title="Direct link to consumersredis_streamvisibility_timeout" translate="no">​</a></h3>
<p>Type: <code>Duration</code>. Default: <code>30s</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_VISIBILITY_TIMEOUT</code></p>
<p><code>visibility_timeout</code> is the time to wait for a message to be processed before it is re-queued.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streamnum_workers"><code>consumers[].redis_stream.num_workers</code><a href="#consumersredis_streamnum_workers" class="hash-link" aria-label="Direct link to consumersredis_streamnum_workers" title="Direct link to consumersredis_streamnum_workers" translate="no">​</a></h3>
<p>Type: <code>int</code>. Default: <code>1</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_NUM_WORKERS</code></p>
<p><code>num_workers</code> is the number of message workers to use for processing for each stream.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampayload_value"><code>consumers[].redis_stream.payload_value</code><a href="#consumersredis_streampayload_value" class="hash-link" aria-label="Direct link to consumersredis_streampayload_value" title="Direct link to consumersredis_streampayload_value" translate="no">​</a></h3>
<p>Type: <code>string</code>. Default: <code>payload</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PAYLOAD_VALUE</code></p>
<p><code>payload_value</code> is used to extract data from Redis Stream message.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streammethod_value"><code>consumers[].redis_stream.method_value</code><a href="#consumersredis_streammethod_value" class="hash-link" aria-label="Direct link to consumersredis_streammethod_value" title="Direct link to consumersredis_streammethod_value" translate="no">​</a></h3>
<p>Type: <code>string</code>. Default: <code>method</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_METHOD_VALUE</code></p>
<p><code>method_value</code> is used to extract a method for command messages.
If provided in message, then payload must be just a serialized API request object.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampublication_data_mode"><code>consumers[].redis_stream.publication_data_mode</code><a href="#consumersredis_streampublication_data_mode" class="hash-link" aria-label="Direct link to consumersredis_streampublication_data_mode" title="Direct link to consumersredis_streampublication_data_mode" translate="no">​</a></h3>
<p>Type: <code>RedisStreamPublicationDataModeConfig</code> object</p>
<p><code>publication_data_mode</code> configures publication data mode.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampublication_data_modeenabled"><code>consumers[].redis_stream.publication_data_mode.enabled</code><a href="#consumersredis_streampublication_data_modeenabled" class="hash-link" aria-label="Direct link to consumersredis_streampublication_data_modeenabled" title="Direct link to consumersredis_streampublication_data_modeenabled" translate="no">​</a></h4>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PUBLICATION_DATA_MODE_ENABLED</code></p>
<p><code>enabled</code> toggles publication data mode.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampublication_data_modechannels_value"><code>consumers[].redis_stream.publication_data_mode.channels_value</code><a href="#consumersredis_streampublication_data_modechannels_value" class="hash-link" aria-label="Direct link to consumersredis_streampublication_data_modechannels_value" title="Direct link to consumersredis_streampublication_data_modechannels_value" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-channels</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PUBLICATION_DATA_MODE_CHANNELS_VALUE</code></p>
<p><code>channels_value</code> is used to extract channels to publish data into (channels must be comma-separated).</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampublication_data_modeidempotency_key_value"><code>consumers[].redis_stream.publication_data_mode.idempotency_key_value</code><a href="#consumersredis_streampublication_data_modeidempotency_key_value" class="hash-link" aria-label="Direct link to consumersredis_streampublication_data_modeidempotency_key_value" title="Direct link to consumersredis_streampublication_data_modeidempotency_key_value" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-idempotency-key</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PUBLICATION_DATA_MODE_IDEMPOTENCY_KEY_VALUE</code></p>
<p><code>idempotency_key_value</code> is used to extract Publication idempotency key from Redis Stream message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampublication_data_modedelta_value"><code>consumers[].redis_stream.publication_data_mode.delta_value</code><a href="#consumersredis_streampublication_data_modedelta_value" class="hash-link" aria-label="Direct link to consumersredis_streampublication_data_modedelta_value" title="Direct link to consumersredis_streampublication_data_modedelta_value" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-delta</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PUBLICATION_DATA_MODE_DELTA_VALUE</code></p>
<p><code>delta_value</code> is used to extract Publication delta flag from Redis Stream message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampublication_data_modeversion_value"><code>consumers[].redis_stream.publication_data_mode.version_value</code><a href="#consumersredis_streampublication_data_modeversion_value" class="hash-link" aria-label="Direct link to consumersredis_streampublication_data_modeversion_value" title="Direct link to consumersredis_streampublication_data_modeversion_value" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PUBLICATION_DATA_MODE_VERSION_VALUE</code></p>
<p><code>version_value</code> is used to extract Publication version from Redis Stream message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampublication_data_modeversion_epoch_value"><code>consumers[].redis_stream.publication_data_mode.version_epoch_value</code><a href="#consumersredis_streampublication_data_modeversion_epoch_value" class="hash-link" aria-label="Direct link to consumersredis_streampublication_data_modeversion_epoch_value" title="Direct link to consumersredis_streampublication_data_modeversion_epoch_value" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version-epoch</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PUBLICATION_DATA_MODE_VERSION_EPOCH_VALUE</code></p>
<p><code>version_epoch_value</code> is used to extract Publication version epoch from Redis Stream message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersredis_streampublication_data_modetags_value_prefix"><code>consumers[].redis_stream.publication_data_mode.tags_value_prefix</code><a href="#consumersredis_streampublication_data_modetags_value_prefix" class="hash-link" aria-label="Direct link to consumersredis_streampublication_data_modetags_value_prefix" title="Direct link to consumersredis_streampublication_data_modetags_value_prefix" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-tag-</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_REDIS_STREAM_PUBLICATION_DATA_MODE_TAGS_VALUE_PREFIX</code></p>
<p><code>tags_value_prefix</code> is used to extract Publication tags from Redis Stream message.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="google-cloud-pubsub">Google Cloud PUB/SUB<a href="#google-cloud-pubsub" class="hash-link" aria-label="Direct link to Google Cloud PUB/SUB" title="Direct link to Google Cloud PUB/SUB" translate="no">​</a></h2>
<p>Consumer from <a href="https://cloud.google.com/pubsub/docs" target="_blank" rel="noopener noreferrer" class="">Google Cloud PUB/SUB</a>.</p>
<p>Ordered processing is possible if OrderingKey is used and subscription created with ordering enabled. See in <a href="https://cloud.google.com/pubsub/docs/ordering" target="_blank" rel="noopener noreferrer" class="">Google PUB/SUB docs</a></p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_sub"><code>consumers[].google_pub_sub</code><a href="#consumersgoogle_pub_sub" class="hash-link" aria-label="Direct link to consumersgoogle_pub_sub" title="Direct link to consumersgoogle_pub_sub" translate="no">​</a></h2>
<p>Type: <code>GooglePubSubConsumerConfig</code> object</p>
<p><code>google_pub_sub</code> allows defining options for consumer of google_pub_sub type.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subproject_id"><code>consumers[].google_pub_sub.project_id</code><a href="#consumersgoogle_pub_subproject_id" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subproject_id" title="Direct link to consumersgoogle_pub_subproject_id" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_PROJECT_ID</code></p>
<p>Google Cloud project ID.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subsubscriptions"><code>consumers[].google_pub_sub.subscriptions</code><a href="#consumersgoogle_pub_subsubscriptions" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subsubscriptions" title="Direct link to consumersgoogle_pub_subsubscriptions" translate="no">​</a></h3>
<p>Type: <code>[]string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_SUBSCRIPTIONS</code></p>
<p><code>subscriptions</code> is the list of Pub/Sub subscription ids to consume from.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_submax_outstanding_messages"><code>consumers[].google_pub_sub.max_outstanding_messages</code><a href="#consumersgoogle_pub_submax_outstanding_messages" class="hash-link" aria-label="Direct link to consumersgoogle_pub_submax_outstanding_messages" title="Direct link to consumersgoogle_pub_submax_outstanding_messages" translate="no">​</a></h3>
<p>Type: <code>int</code>. Default: <code>100</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_MAX_OUTSTANDING_MESSAGES</code></p>
<p><code>max_outstanding_messages</code> controls the maximum number of unprocessed messages.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_submax_outstanding_bytes"><code>consumers[].google_pub_sub.max_outstanding_bytes</code><a href="#consumersgoogle_pub_submax_outstanding_bytes" class="hash-link" aria-label="Direct link to consumersgoogle_pub_submax_outstanding_bytes" title="Direct link to consumersgoogle_pub_submax_outstanding_bytes" translate="no">​</a></h3>
<p>Type: <code>int</code>. Default: <code>1000000</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_MAX_OUTSTANDING_BYTES</code></p>
<p><code>max_outstanding_bytes</code> controls the maximum number of unprocessed bytes.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subauth_mechanism"><code>consumers[].google_pub_sub.auth_mechanism</code><a href="#consumersgoogle_pub_subauth_mechanism" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subauth_mechanism" title="Direct link to consumersgoogle_pub_subauth_mechanism" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_AUTH_MECHANISM</code></p>
<p><code>auth_mechanism</code> specifies which authentication mechanism to use:
&quot;default&quot;, &quot;service_account&quot;.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subcredentials_file"><code>consumers[].google_pub_sub.credentials_file</code><a href="#consumersgoogle_pub_subcredentials_file" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subcredentials_file" title="Direct link to consumersgoogle_pub_subcredentials_file" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_CREDENTIALS_FILE</code></p>
<p><code>credentials_file</code> is the path to the service account JSON file if required.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_submethod_attribute"><code>consumers[].google_pub_sub.method_attribute</code><a href="#consumersgoogle_pub_submethod_attribute" class="hash-link" aria-label="Direct link to consumersgoogle_pub_submethod_attribute" title="Direct link to consumersgoogle_pub_submethod_attribute" translate="no">​</a></h3>
<p>Type: <code>string</code>. Default: <code>centrifugo-method</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_METHOD_ATTRIBUTE</code></p>
<p><code>method_attribute</code> is an attribute name to extract a method name from the message.
If provided in message, then payload must be just a serialized API request object.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subpublication_data_mode"><code>consumers[].google_pub_sub.publication_data_mode</code><a href="#consumersgoogle_pub_subpublication_data_mode" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subpublication_data_mode" title="Direct link to consumersgoogle_pub_subpublication_data_mode" translate="no">​</a></h3>
<p>Type: <code>GooglePubSubPublicationDataModeConfig</code> object</p>
<p><code>publication_data_mode</code> holds settings for the mode where message payload already contains data
ready to publish into channels.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subpublication_data_modeenabled"><code>consumers[].google_pub_sub.publication_data_mode.enabled</code><a href="#consumersgoogle_pub_subpublication_data_modeenabled" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subpublication_data_modeenabled" title="Direct link to consumersgoogle_pub_subpublication_data_modeenabled" translate="no">​</a></h4>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_PUBLICATION_DATA_MODE_ENABLED</code></p>
<p><code>enabled</code> enables publication data mode.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subpublication_data_modechannels_attribute"><code>consumers[].google_pub_sub.publication_data_mode.channels_attribute</code><a href="#consumersgoogle_pub_subpublication_data_modechannels_attribute" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subpublication_data_modechannels_attribute" title="Direct link to consumersgoogle_pub_subpublication_data_modechannels_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-channels</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_PUBLICATION_DATA_MODE_CHANNELS_ATTRIBUTE</code></p>
<p><code>channels_attribute</code> is the attribute name containing comma-separated channel names.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subpublication_data_modeidempotency_key_attribute"><code>consumers[].google_pub_sub.publication_data_mode.idempotency_key_attribute</code><a href="#consumersgoogle_pub_subpublication_data_modeidempotency_key_attribute" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subpublication_data_modeidempotency_key_attribute" title="Direct link to consumersgoogle_pub_subpublication_data_modeidempotency_key_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-idempotency-key</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_PUBLICATION_DATA_MODE_IDEMPOTENCY_KEY_ATTRIBUTE</code></p>
<p><code>idempotency_key_attribute</code> is the attribute name for an idempotency key.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subpublication_data_modedelta_attribute"><code>consumers[].google_pub_sub.publication_data_mode.delta_attribute</code><a href="#consumersgoogle_pub_subpublication_data_modedelta_attribute" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subpublication_data_modedelta_attribute" title="Direct link to consumersgoogle_pub_subpublication_data_modedelta_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-delta</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_PUBLICATION_DATA_MODE_DELTA_ATTRIBUTE</code></p>
<p><code>delta_attribute</code> is the attribute name for a delta flag.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subpublication_data_modeversion_attribute"><code>consumers[].google_pub_sub.publication_data_mode.version_attribute</code><a href="#consumersgoogle_pub_subpublication_data_modeversion_attribute" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subpublication_data_modeversion_attribute" title="Direct link to consumersgoogle_pub_subpublication_data_modeversion_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_PUBLICATION_DATA_MODE_VERSION_ATTRIBUTE</code></p>
<p><code>version_attribute</code> is the attribute name for a version.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subpublication_data_modeversion_epoch_attribute"><code>consumers[].google_pub_sub.publication_data_mode.version_epoch_attribute</code><a href="#consumersgoogle_pub_subpublication_data_modeversion_epoch_attribute" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subpublication_data_modeversion_epoch_attribute" title="Direct link to consumersgoogle_pub_subpublication_data_modeversion_epoch_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version-epoch</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_PUBLICATION_DATA_MODE_VERSION_EPOCH_ATTRIBUTE</code></p>
<p><code>version_epoch_attribute</code> is the attribute name for a version epoch.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersgoogle_pub_subpublication_data_modetags_attribute_prefix"><code>consumers[].google_pub_sub.publication_data_mode.tags_attribute_prefix</code><a href="#consumersgoogle_pub_subpublication_data_modetags_attribute_prefix" class="hash-link" aria-label="Direct link to consumersgoogle_pub_subpublication_data_modetags_attribute_prefix" title="Direct link to consumersgoogle_pub_subpublication_data_modetags_attribute_prefix" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-tag-</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_GOOGLE_PUB_SUB_PUBLICATION_DATA_MODE_TAGS_ATTRIBUTE_PREFIX</code></p>
<p><code>tags_attribute_prefix</code> is the prefix for attributes containing tags.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="aws-sqs">AWS SQS<a href="#aws-sqs" class="hash-link" aria-label="Direct link to AWS SQS" title="Direct link to AWS SQS" translate="no">​</a></h2>
<p>Consumer from Amazon <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/welcome.html" target="_blank" rel="noopener noreferrer" class="">Simple Queue Service</a>.</p>
<p>Ordered processing is possible with FIFO queue and when using group IDs. See <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/FIFO-queues-understanding-logic.html" target="_blank" rel="noopener noreferrer" class="">in AWS docs</a>.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqs"><code>consumers[].aws_sqs</code><a href="#consumersaws_sqs" class="hash-link" aria-label="Direct link to consumersaws_sqs" title="Direct link to consumersaws_sqs" translate="no">​</a></h2>
<p>Type: <code>AwsSqsConsumerConfig</code> object</p>
<p><code>aws_sqs</code> allows defining options for consumer of aws_sqs type.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqsqueues"><code>consumers[].aws_sqs.queues</code><a href="#consumersaws_sqsqueues" class="hash-link" aria-label="Direct link to consumersaws_sqsqueues" title="Direct link to consumersaws_sqsqueues" translate="no">​</a></h3>
<p>Type: <code>[]string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_QUEUES</code></p>
<p><code>queues</code> is a list of SQS queue URLs to consume.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqssns_envelope"><code>consumers[].aws_sqs.sns_envelope</code><a href="#consumersaws_sqssns_envelope" class="hash-link" aria-label="Direct link to consumersaws_sqssns_envelope" title="Direct link to consumersaws_sqssns_envelope" translate="no">​</a></h3>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_SNS_ENVELOPE</code></p>
<p><code>sns_envelope</code>, when true, expects messages to be wrapped in an SNS envelope – this is required when
consuming from SNS topics with SQS subscriptions.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqsregion"><code>consumers[].aws_sqs.region</code><a href="#consumersaws_sqsregion" class="hash-link" aria-label="Direct link to consumersaws_sqsregion" title="Direct link to consumersaws_sqsregion" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_REGION</code></p>
<p><code>region</code> is the AWS region.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqsmax_number_of_messages"><code>consumers[].aws_sqs.max_number_of_messages</code><a href="#consumersaws_sqsmax_number_of_messages" class="hash-link" aria-label="Direct link to consumersaws_sqsmax_number_of_messages" title="Direct link to consumersaws_sqsmax_number_of_messages" translate="no">​</a></h3>
<p>Type: <code>int32</code>. Default: <code>10</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_MAX_NUMBER_OF_MESSAGES</code></p>
<p><code>max_number_of_messages</code> is the maximum number of messages to receive per poll.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqswait_time_time"><code>consumers[].aws_sqs.wait_time_time</code><a href="#consumersaws_sqswait_time_time" class="hash-link" aria-label="Direct link to consumersaws_sqswait_time_time" title="Direct link to consumersaws_sqswait_time_time" translate="no">​</a></h3>
<p>Type: <code>Duration</code>. Default: <code>20s</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_WAIT_TIME_TIME</code></p>
<p><code>wait_time_time</code> is the long-poll wait time. Rounded to seconds internally.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqsvisibility_timeout"><code>consumers[].aws_sqs.visibility_timeout</code><a href="#consumersaws_sqsvisibility_timeout" class="hash-link" aria-label="Direct link to consumersaws_sqsvisibility_timeout" title="Direct link to consumersaws_sqsvisibility_timeout" translate="no">​</a></h3>
<p>Type: <code>Duration</code>. Default: <code>30s</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_VISIBILITY_TIMEOUT</code></p>
<p><code>visibility_timeout</code> is the time a message is hidden from other consumers. Rounded to seconds internally.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqsmax_concurrency"><code>consumers[].aws_sqs.max_concurrency</code><a href="#consumersaws_sqsmax_concurrency" class="hash-link" aria-label="Direct link to consumersaws_sqsmax_concurrency" title="Direct link to consumersaws_sqsmax_concurrency" translate="no">​</a></h3>
<p>Type: <code>int</code>. Default: <code>1</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_MAX_CONCURRENCY</code></p>
<p><code>max_concurrency</code> defines max concurrency during message batch processing.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqscredentials_profile"><code>consumers[].aws_sqs.credentials_profile</code><a href="#consumersaws_sqscredentials_profile" class="hash-link" aria-label="Direct link to consumersaws_sqscredentials_profile" title="Direct link to consumersaws_sqscredentials_profile" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_CREDENTIALS_PROFILE</code></p>
<p><code>credentials_profile</code> is a shared credentials profile to use.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqsassume_role_arn"><code>consumers[].aws_sqs.assume_role_arn</code><a href="#consumersaws_sqsassume_role_arn" class="hash-link" aria-label="Direct link to consumersaws_sqsassume_role_arn" title="Direct link to consumersaws_sqsassume_role_arn" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_ASSUME_ROLE_ARN</code></p>
<p><code>assume_role_arn</code>, if provided, will cause the consumer to assume the given IAM role.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqsmethod_attribute"><code>consumers[].aws_sqs.method_attribute</code><a href="#consumersaws_sqsmethod_attribute" class="hash-link" aria-label="Direct link to consumersaws_sqsmethod_attribute" title="Direct link to consumersaws_sqsmethod_attribute" translate="no">​</a></h3>
<p>Type: <code>string</code>. Default: <code>centrifugo-method</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_METHOD_ATTRIBUTE</code></p>
<p><code>method_attribute</code> is the attribute name to extract a method for command messages.
If provided in message, then payload must be just a serialized API request object.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqslocalstack_endpoint"><code>consumers[].aws_sqs.localstack_endpoint</code><a href="#consumersaws_sqslocalstack_endpoint" class="hash-link" aria-label="Direct link to consumersaws_sqslocalstack_endpoint" title="Direct link to consumersaws_sqslocalstack_endpoint" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_LOCALSTACK_ENDPOINT</code></p>
<p><code>localstack_endpoint</code> if set enables using localstack with provided URL.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqspublication_data_mode"><code>consumers[].aws_sqs.publication_data_mode</code><a href="#consumersaws_sqspublication_data_mode" class="hash-link" aria-label="Direct link to consumersaws_sqspublication_data_mode" title="Direct link to consumersaws_sqspublication_data_mode" translate="no">​</a></h3>
<p>Type: <code>AWSPublicationDataModeConfig</code> object</p>
<p><code>publication_data_mode</code> holds settings for the mode where message payload already contains data
ready to publish into channels.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqspublication_data_modeenabled"><code>consumers[].aws_sqs.publication_data_mode.enabled</code><a href="#consumersaws_sqspublication_data_modeenabled" class="hash-link" aria-label="Direct link to consumersaws_sqspublication_data_modeenabled" title="Direct link to consumersaws_sqspublication_data_modeenabled" translate="no">​</a></h4>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_PUBLICATION_DATA_MODE_ENABLED</code></p>
<p><code>enabled</code> enables publication data mode.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqspublication_data_modechannels_attribute"><code>consumers[].aws_sqs.publication_data_mode.channels_attribute</code><a href="#consumersaws_sqspublication_data_modechannels_attribute" class="hash-link" aria-label="Direct link to consumersaws_sqspublication_data_modechannels_attribute" title="Direct link to consumersaws_sqspublication_data_modechannels_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-channels</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_PUBLICATION_DATA_MODE_CHANNELS_ATTRIBUTE</code></p>
<p><code>channels_attribute</code> is the attribute name containing comma-separated channel names.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqspublication_data_modeidempotency_key_attribute"><code>consumers[].aws_sqs.publication_data_mode.idempotency_key_attribute</code><a href="#consumersaws_sqspublication_data_modeidempotency_key_attribute" class="hash-link" aria-label="Direct link to consumersaws_sqspublication_data_modeidempotency_key_attribute" title="Direct link to consumersaws_sqspublication_data_modeidempotency_key_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-idempotency-key</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_PUBLICATION_DATA_MODE_IDEMPOTENCY_KEY_ATTRIBUTE</code></p>
<p><code>idempotency_key_attribute</code> is the attribute name for an idempotency key.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqspublication_data_modedelta_attribute"><code>consumers[].aws_sqs.publication_data_mode.delta_attribute</code><a href="#consumersaws_sqspublication_data_modedelta_attribute" class="hash-link" aria-label="Direct link to consumersaws_sqspublication_data_modedelta_attribute" title="Direct link to consumersaws_sqspublication_data_modedelta_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-delta</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_PUBLICATION_DATA_MODE_DELTA_ATTRIBUTE</code></p>
<p><code>delta_attribute</code> is the attribute name for a delta flag.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqspublication_data_modeversion_attribute"><code>consumers[].aws_sqs.publication_data_mode.version_attribute</code><a href="#consumersaws_sqspublication_data_modeversion_attribute" class="hash-link" aria-label="Direct link to consumersaws_sqspublication_data_modeversion_attribute" title="Direct link to consumersaws_sqspublication_data_modeversion_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_PUBLICATION_DATA_MODE_VERSION_ATTRIBUTE</code></p>
<p><code>version_attribute</code> is the attribute name for a version of publication.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqspublication_data_modeversion_epoch_attribute"><code>consumers[].aws_sqs.publication_data_mode.version_epoch_attribute</code><a href="#consumersaws_sqspublication_data_modeversion_epoch_attribute" class="hash-link" aria-label="Direct link to consumersaws_sqspublication_data_modeversion_epoch_attribute" title="Direct link to consumersaws_sqspublication_data_modeversion_epoch_attribute" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version-epoch</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_PUBLICATION_DATA_MODE_VERSION_EPOCH_ATTRIBUTE</code></p>
<p><code>version_epoch_attribute</code> is the attribute name for a version epoch of publication.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersaws_sqspublication_data_modetags_attribute_prefix"><code>consumers[].aws_sqs.publication_data_mode.tags_attribute_prefix</code><a href="#consumersaws_sqspublication_data_modetags_attribute_prefix" class="hash-link" aria-label="Direct link to consumersaws_sqspublication_data_modetags_attribute_prefix" title="Direct link to consumersaws_sqspublication_data_modetags_attribute_prefix" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-tag-</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AWS_SQS_PUBLICATION_DATA_MODE_TAGS_ATTRIBUTE_PREFIX</code></p>
<p><code>tags_attribute_prefix</code> is the prefix for attributes containing tags.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="azure-service-bus">Azure Service Bus<a href="#azure-service-bus" class="hash-link" aria-label="Direct link to Azure Service Bus" title="Direct link to Azure Service Bus" translate="no">​</a></h2>
<p>Consumer from <a href="https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview" target="_blank" rel="noopener noreferrer" class="">Azure Service Bus</a>.</p>
<p>Ordered processing is possible when using message sessions.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_bus"><code>consumers[].azure_service_bus</code><a href="#consumersazure_service_bus" class="hash-link" aria-label="Direct link to consumersazure_service_bus" title="Direct link to consumersazure_service_bus" translate="no">​</a></h2>
<p>Type: <code>AzureServiceBusConsumerConfig</code> object</p>
<p><code>azure_service_bus</code> allows defining options for consumer of <code>azure_service_bus</code> type.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_busconnection_string"><code>consumers[].azure_service_bus.connection_string</code><a href="#consumersazure_service_busconnection_string" class="hash-link" aria-label="Direct link to consumersazure_service_busconnection_string" title="Direct link to consumersazure_service_busconnection_string" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_CONNECTION_STRING</code></p>
<p><code>connection_string</code> is the full connection string used for connection-string–based authentication.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_bususe_azure_identity"><code>consumers[].azure_service_bus.use_azure_identity</code><a href="#consumersazure_service_bususe_azure_identity" class="hash-link" aria-label="Direct link to consumersazure_service_bususe_azure_identity" title="Direct link to consumersazure_service_bususe_azure_identity" translate="no">​</a></h3>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_USE_AZURE_IDENTITY</code></p>
<p><code>use_azure_identity</code> toggles Azure Identity (AAD) authentication instead of connection strings.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_busfully_qualified_namespace"><code>consumers[].azure_service_bus.fully_qualified_namespace</code><a href="#consumersazure_service_busfully_qualified_namespace" class="hash-link" aria-label="Direct link to consumersazure_service_busfully_qualified_namespace" title="Direct link to consumersazure_service_busfully_qualified_namespace" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_FULLY_QUALIFIED_NAMESPACE</code></p>
<p><code>fully_qualified_namespace</code> is the Service Bus namespace, e.g. &quot;your-namespace.servicebus.windows.net&quot;.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_bustenant_id"><code>consumers[].azure_service_bus.tenant_id</code><a href="#consumersazure_service_bustenant_id" class="hash-link" aria-label="Direct link to consumersazure_service_bustenant_id" title="Direct link to consumersazure_service_bustenant_id" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_TENANT_ID</code></p>
<p><code>tenant_id</code> is the Azure Active Directory tenant ID used with Azure Identity.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_busclient_id"><code>consumers[].azure_service_bus.client_id</code><a href="#consumersazure_service_busclient_id" class="hash-link" aria-label="Direct link to consumersazure_service_busclient_id" title="Direct link to consumersazure_service_busclient_id" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_CLIENT_ID</code></p>
<p><code>client_id</code> is the Azure AD application (client) ID used for authentication.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_busclient_secret"><code>consumers[].azure_service_bus.client_secret</code><a href="#consumersazure_service_busclient_secret" class="hash-link" aria-label="Direct link to consumersazure_service_busclient_secret" title="Direct link to consumersazure_service_busclient_secret" translate="no">​</a></h3>
<p>Type: <code>string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_CLIENT_SECRET</code></p>
<p><code>client_secret</code> is the secret associated with the Azure AD application.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_busqueues"><code>consumers[].azure_service_bus.queues</code><a href="#consumersazure_service_busqueues" class="hash-link" aria-label="Direct link to consumersazure_service_busqueues" title="Direct link to consumersazure_service_busqueues" translate="no">​</a></h3>
<p>Type: <code>[]string</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_QUEUES</code></p>
<p><code>queues</code> is the list of the Azure Service Bus queues to consume from.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_bususe_sessions"><code>consumers[].azure_service_bus.use_sessions</code><a href="#consumersazure_service_bususe_sessions" class="hash-link" aria-label="Direct link to consumersazure_service_bususe_sessions" title="Direct link to consumersazure_service_bususe_sessions" translate="no">​</a></h3>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_USE_SESSIONS</code></p>
<p><code>use_sessions</code> enables session-aware message handling.
All messages must include a SessionID; messages within the same session will be processed in order.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_busmax_concurrent_calls"><code>consumers[].azure_service_bus.max_concurrent_calls</code><a href="#consumersazure_service_busmax_concurrent_calls" class="hash-link" aria-label="Direct link to consumersazure_service_busmax_concurrent_calls" title="Direct link to consumersazure_service_busmax_concurrent_calls" translate="no">​</a></h3>
<p>Type: <code>int</code>. Default: <code>1</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_MAX_CONCURRENT_CALLS</code></p>
<p><code>max_concurrent_calls</code> controls the maximum number of messages processed concurrently.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_busmax_receive_messages"><code>consumers[].azure_service_bus.max_receive_messages</code><a href="#consumersazure_service_busmax_receive_messages" class="hash-link" aria-label="Direct link to consumersazure_service_busmax_receive_messages" title="Direct link to consumersazure_service_busmax_receive_messages" translate="no">​</a></h3>
<p>Type: <code>int</code>. Default: <code>1</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_MAX_RECEIVE_MESSAGES</code></p>
<p><code>max_receive_messages</code> sets the batch size when receiving messages from the queue.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_busmethod_property"><code>consumers[].azure_service_bus.method_property</code><a href="#consumersazure_service_busmethod_property" class="hash-link" aria-label="Direct link to consumersazure_service_busmethod_property" title="Direct link to consumersazure_service_busmethod_property" translate="no">​</a></h3>
<p>Type: <code>string</code>. Default: <code>centrifugo-method</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_METHOD_PROPERTY</code></p>
<p><code>method_property</code> is the name of the message property used to extract the method (for API command).
If provided in message, then payload must be just a serialized API request object.</p>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_buspublication_data_mode"><code>consumers[].azure_service_bus.publication_data_mode</code><a href="#consumersazure_service_buspublication_data_mode" class="hash-link" aria-label="Direct link to consumersazure_service_buspublication_data_mode" title="Direct link to consumersazure_service_buspublication_data_mode" translate="no">​</a></h3>
<p>Type: <code>AzureServiceBusPublicationDataModeConfig</code> object</p>
<p><code>publication_data_mode</code> configures how structured publication-ready data is extracted from the message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_buspublication_data_modeenabled"><code>consumers[].azure_service_bus.publication_data_mode.enabled</code><a href="#consumersazure_service_buspublication_data_modeenabled" class="hash-link" aria-label="Direct link to consumersazure_service_buspublication_data_modeenabled" title="Direct link to consumersazure_service_buspublication_data_modeenabled" translate="no">​</a></h4>
<p>Type: <code>bool</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_PUBLICATION_DATA_MODE_ENABLED</code></p>
<p><code>enabled</code> toggles the publication data mode.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_buspublication_data_modechannels_property"><code>consumers[].azure_service_bus.publication_data_mode.channels_property</code><a href="#consumersazure_service_buspublication_data_modechannels_property" class="hash-link" aria-label="Direct link to consumersazure_service_buspublication_data_modechannels_property" title="Direct link to consumersazure_service_buspublication_data_modechannels_property" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-channels</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_PUBLICATION_DATA_MODE_CHANNELS_PROPERTY</code></p>
<p><code>channels_property</code> is the name of the message property that contains the list of target channels.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_buspublication_data_modeidempotency_key_property"><code>consumers[].azure_service_bus.publication_data_mode.idempotency_key_property</code><a href="#consumersazure_service_buspublication_data_modeidempotency_key_property" class="hash-link" aria-label="Direct link to consumersazure_service_buspublication_data_modeidempotency_key_property" title="Direct link to consumersazure_service_buspublication_data_modeidempotency_key_property" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-idempotency-key</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_PUBLICATION_DATA_MODE_IDEMPOTENCY_KEY_PROPERTY</code></p>
<p><code>idempotency_key_property</code> is the property that holds an idempotency key for deduplication.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_buspublication_data_modedelta_property"><code>consumers[].azure_service_bus.publication_data_mode.delta_property</code><a href="#consumersazure_service_buspublication_data_modedelta_property" class="hash-link" aria-label="Direct link to consumersazure_service_buspublication_data_modedelta_property" title="Direct link to consumersazure_service_buspublication_data_modedelta_property" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-delta</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_PUBLICATION_DATA_MODE_DELTA_PROPERTY</code></p>
<p><code>delta_property</code> is the property that represents changes or deltas in the payload.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_buspublication_data_modeversion_property"><code>consumers[].azure_service_bus.publication_data_mode.version_property</code><a href="#consumersazure_service_buspublication_data_modeversion_property" class="hash-link" aria-label="Direct link to consumersazure_service_buspublication_data_modeversion_property" title="Direct link to consumersazure_service_buspublication_data_modeversion_property" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_PUBLICATION_DATA_MODE_VERSION_PROPERTY</code></p>
<p><code>version_property</code> is the property that holds the version of the message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_buspublication_data_modeversion_epoch_property"><code>consumers[].azure_service_bus.publication_data_mode.version_epoch_property</code><a href="#consumersazure_service_buspublication_data_modeversion_epoch_property" class="hash-link" aria-label="Direct link to consumersazure_service_buspublication_data_modeversion_epoch_property" title="Direct link to consumersazure_service_buspublication_data_modeversion_epoch_property" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-version-epoch</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_PUBLICATION_DATA_MODE_VERSION_EPOCH_PROPERTY</code></p>
<p><code>version_epoch_property</code> is the property that holds the version epoch of the message.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="consumersazure_service_buspublication_data_modetags_property_prefix"><code>consumers[].azure_service_bus.publication_data_mode.tags_property_prefix</code><a href="#consumersazure_service_buspublication_data_modetags_property_prefix" class="hash-link" aria-label="Direct link to consumersazure_service_buspublication_data_modetags_property_prefix" title="Direct link to consumersazure_service_buspublication_data_modetags_property_prefix" translate="no">​</a></h4>
<p>Type: <code>string</code>. Default: <code>centrifugo-tag-</code></p>
<p>Env: <code>CENTRIFUGO_CONSUMERS_&lt;NAME&gt;_AZURE_SERVICE_BUS_PUBLICATION_DATA_MODE_TAGS_PROPERTY_PREFIX</code></p>
<p><code>tags_property_prefix</code> defines the prefix used to extract dynamic tags from message properties.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/centrifugal/centrifugal.dev/edit/main/docs/server/consumers.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/server/engines"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Engines and scalability</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/server/history_and_recovery"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">History and stream recovery</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#supported-consumers" class="table-of-contents__link toc-highlight">Supported consumers</a></li><li><a href="#how-consumers-work" class="table-of-contents__link toc-highlight">How consumers work</a></li><li><a href="#publication-data-mode" class="table-of-contents__link toc-highlight">Publication data mode</a></li><li><a href="#ordering-guarantees" class="table-of-contents__link toc-highlight">Ordering guarantees</a></li><li><a href="#how-to-enable" class="table-of-contents__link toc-highlight">How to enable</a></li><li><a href="#consumers" class="table-of-contents__link toc-highlight"><code>consumers[]</code></a><ul><li><a href="#consumersenabled" class="table-of-contents__link toc-highlight"><code>consumers[].enabled</code></a></li><li><a href="#consumersname" class="table-of-contents__link toc-highlight"><code>consumers[].name</code></a></li><li><a href="#consumerstype" class="table-of-contents__link toc-highlight"><code>consumers[].type</code></a></li></ul></li><li><a href="#configure-via-env-vars" class="table-of-contents__link toc-highlight">Configure via env vars</a></li><li><a href="#postgresql-outbox-consumer" class="table-of-contents__link toc-highlight">PostgreSQL outbox consumer</a></li><li><a href="#consumerspostgresql" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql</code></a><ul><li><a href="#consumerspostgresqldsn" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql.dsn</code></a></li><li><a href="#consumerspostgresqloutbox_table_name" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql.outbox_table_name</code></a></li><li><a href="#consumerspostgresqlnum_partitions" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql.num_partitions</code></a></li><li><a href="#consumerspostgresqlpartition_select_limit" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql.partition_select_limit</code></a></li><li><a href="#consumerspostgresqlpartition_poll_interval" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql.partition_poll_interval</code></a></li><li><a href="#consumerspostgresqlpartition_notification_channel" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql.partition_notification_channel</code></a></li><li><a href="#consumerspostgresqltls" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql.tls</code></a></li><li><a href="#consumerspostgresqluse_try_lock" class="table-of-contents__link toc-highlight"><code>consumers[].postgresql.use_try_lock</code></a></li></ul></li><li><a href="#kafka-consumer" class="table-of-contents__link toc-highlight">Kafka consumer</a></li><li><a href="#consumerskafka" class="table-of-contents__link toc-highlight"><code>consumers[].kafka</code></a><ul><li><a href="#consumerskafkabrokers" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.brokers</code></a></li><li><a href="#consumerskafkatopics" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.topics</code></a></li><li><a href="#consumerskafkaconsumer_group" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.consumer_group</code></a></li><li><a href="#consumerskafkamax_poll_records" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.max_poll_records</code></a></li><li><a href="#consumerskafkafetch_max_bytes" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.fetch_max_bytes</code></a></li><li><a href="#consumerskafkafetch_max_wait" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.fetch_max_wait</code></a></li><li><a href="#consumerskafkafetch_read_uncommitted" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.fetch_read_uncommitted</code></a></li><li><a href="#consumerskafkasasl_mechanism" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.sasl_mechanism</code></a></li><li><a href="#consumerskafkasasl_user" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.sasl_user</code></a></li><li><a href="#consumerskafkasasl_password" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.sasl_password</code></a></li><li><a href="#consumerskafkatls" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.tls</code></a></li><li><a href="#consumerskafkapublication_data_mode" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.publication_data_mode</code></a></li><li><a href="#consumerskafkapublication_data_modeenabled" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.publication_data_mode.enabled</code></a></li><li><a href="#consumerskafkapublication_data_modechannels_header" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.publication_data_mode.channels_header</code></a></li><li><a href="#consumerskafkapublication_data_modeidempotency_key_header" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.publication_data_mode.idempotency_key_header</code></a></li><li><a href="#consumerskafkapublication_data_modedelta_header" class="table-of-contents__link toc-highlight"><code>consumers[].kafka.publication_data_mode.delta_header</code></a></li><li><a href="#compatibility-with-redpanda" class="table-of-contents__link toc-highlight">Compatibility with Redpanda</a></li></ul></li><li><a href="#nats-jetstream" class="table-of-contents__link toc-highlight">Nats Jetstream</a></li><li><a href="#consumersnats_jetstream" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream</code></a><ul><li><a href="#consumersnats_jetstreamurl" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.url</code></a></li><li><a href="#consumersnats_jetstreamcredentials_file" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.credentials_file</code></a></li><li><a href="#consumersnats_jetstreamusername" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.username</code></a></li><li><a href="#consumersnats_jetstreampassword" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.password</code></a></li><li><a href="#consumersnats_jetstreamtoken" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.token</code></a></li><li><a href="#consumersnats_jetstreamstream_name" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.stream_name</code></a></li><li><a href="#consumersnats_jetstreamsubjects" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.subjects</code></a></li><li><a href="#consumersnats_jetstreamdurable_consumer_name" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.durable_consumer_name</code></a></li><li><a href="#consumersnats_jetstreamdeliver_policy" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.deliver_policy</code></a></li><li><a href="#consumersnats_jetstreammax_ack_pending" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.max_ack_pending</code></a></li><li><a href="#consumersnats_jetstreammethod_header" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.method_header</code></a></li><li><a href="#consumersnats_jetstreamuse_existing_consumer" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.use_existing_consumer</code></a></li><li><a href="#consumersnats_jetstreampublication_data_mode" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.publication_data_mode</code></a></li><li><a href="#consumersnats_jetstreamtls" class="table-of-contents__link toc-highlight"><code>consumers[].nats_jetstream.tls</code></a></li></ul></li><li><a href="#redis-stream" class="table-of-contents__link toc-highlight">Redis Stream</a></li><li><a href="#consumersredis_stream" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream</code></a><ul><li><a href="#consumersredis_streamaddress" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.address</code></a></li><li><a href="#consumersredis_streamconnect_timeout" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.connect_timeout</code></a></li><li><a href="#consumersredis_streamio_timeout" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.io_timeout</code></a></li><li><a href="#consumersredis_streamdb" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.db</code></a></li><li><a href="#consumersredis_streamuser" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.user</code></a></li><li><a href="#consumersredis_streampassword" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.password</code></a></li><li><a href="#consumersredis_streamclient_name" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.client_name</code></a></li><li><a href="#consumersredis_streamforce_resp2" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.force_resp2</code></a></li><li><a href="#consumersredis_streamcluster_address" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.cluster_address</code></a></li><li><a href="#consumersredis_streamtls" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.tls</code></a></li><li><a href="#consumersredis_streamsentinel_address" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.sentinel_address</code></a></li><li><a href="#consumersredis_streamsentinel_user" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.sentinel_user</code></a></li><li><a href="#consumersredis_streamsentinel_password" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.sentinel_password</code></a></li><li><a href="#consumersredis_streamsentinel_master_name" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.sentinel_master_name</code></a></li><li><a href="#consumersredis_streamsentinel_client_name" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.sentinel_client_name</code></a></li><li><a href="#consumersredis_streamsentinel_tls" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.sentinel_tls</code></a></li><li><a href="#consumersredis_streamstreams" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.streams</code></a></li><li><a href="#consumersredis_streamconsumer_group" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.consumer_group</code></a></li><li><a href="#consumersredis_streamvisibility_timeout" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.visibility_timeout</code></a></li><li><a href="#consumersredis_streamnum_workers" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.num_workers</code></a></li><li><a href="#consumersredis_streampayload_value" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.payload_value</code></a></li><li><a href="#consumersredis_streammethod_value" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.method_value</code></a></li><li><a href="#consumersredis_streampublication_data_mode" class="table-of-contents__link toc-highlight"><code>consumers[].redis_stream.publication_data_mode</code></a></li></ul></li><li><a href="#google-cloud-pubsub" class="table-of-contents__link toc-highlight">Google Cloud PUB/SUB</a></li><li><a href="#consumersgoogle_pub_sub" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub</code></a><ul><li><a href="#consumersgoogle_pub_subproject_id" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub.project_id</code></a></li><li><a href="#consumersgoogle_pub_subsubscriptions" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub.subscriptions</code></a></li><li><a href="#consumersgoogle_pub_submax_outstanding_messages" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub.max_outstanding_messages</code></a></li><li><a href="#consumersgoogle_pub_submax_outstanding_bytes" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub.max_outstanding_bytes</code></a></li><li><a href="#consumersgoogle_pub_subauth_mechanism" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub.auth_mechanism</code></a></li><li><a href="#consumersgoogle_pub_subcredentials_file" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub.credentials_file</code></a></li><li><a href="#consumersgoogle_pub_submethod_attribute" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub.method_attribute</code></a></li><li><a href="#consumersgoogle_pub_subpublication_data_mode" class="table-of-contents__link toc-highlight"><code>consumers[].google_pub_sub.publication_data_mode</code></a></li></ul></li><li><a href="#aws-sqs" class="table-of-contents__link toc-highlight">AWS SQS</a></li><li><a href="#consumersaws_sqs" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs</code></a><ul><li><a href="#consumersaws_sqsqueues" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.queues</code></a></li><li><a href="#consumersaws_sqssns_envelope" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.sns_envelope</code></a></li><li><a href="#consumersaws_sqsregion" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.region</code></a></li><li><a href="#consumersaws_sqsmax_number_of_messages" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.max_number_of_messages</code></a></li><li><a href="#consumersaws_sqswait_time_time" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.wait_time_time</code></a></li><li><a href="#consumersaws_sqsvisibility_timeout" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.visibility_timeout</code></a></li><li><a href="#consumersaws_sqsmax_concurrency" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.max_concurrency</code></a></li><li><a href="#consumersaws_sqscredentials_profile" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.credentials_profile</code></a></li><li><a href="#consumersaws_sqsassume_role_arn" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.assume_role_arn</code></a></li><li><a href="#consumersaws_sqsmethod_attribute" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.method_attribute</code></a></li><li><a href="#consumersaws_sqslocalstack_endpoint" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.localstack_endpoint</code></a></li><li><a href="#consumersaws_sqspublication_data_mode" class="table-of-contents__link toc-highlight"><code>consumers[].aws_sqs.publication_data_mode</code></a></li></ul></li><li><a href="#azure-service-bus" class="table-of-contents__link toc-highlight">Azure Service Bus</a></li><li><a href="#consumersazure_service_bus" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus</code></a><ul><li><a href="#consumersazure_service_busconnection_string" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.connection_string</code></a></li><li><a href="#consumersazure_service_bususe_azure_identity" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.use_azure_identity</code></a></li><li><a href="#consumersazure_service_busfully_qualified_namespace" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.fully_qualified_namespace</code></a></li><li><a href="#consumersazure_service_bustenant_id" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.tenant_id</code></a></li><li><a href="#consumersazure_service_busclient_id" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.client_id</code></a></li><li><a href="#consumersazure_service_busclient_secret" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.client_secret</code></a></li><li><a href="#consumersazure_service_busqueues" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.queues</code></a></li><li><a href="#consumersazure_service_bususe_sessions" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.use_sessions</code></a></li><li><a href="#consumersazure_service_busmax_concurrent_calls" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.max_concurrent_calls</code></a></li><li><a href="#consumersazure_service_busmax_receive_messages" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.max_receive_messages</code></a></li><li><a href="#consumersazure_service_busmethod_property" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.method_property</code></a></li><li><a href="#consumersazure_service_buspublication_data_mode" class="table-of-contents__link toc-highlight"><code>consumers[].azure_service_bus.publication_data_mode</code></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Contacts</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/company">About us</a></li><li class="footer__item"><a href="mailto:hello@centrifugal.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Send e-mail</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/joinchat/U57MI8Lam9mhpuhd" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.gg/tYgADKx" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/centrifugalabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/attributions">Attributions</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Centrifugal Labs LTD</div></div></div></footer></div>
</body>
</html>