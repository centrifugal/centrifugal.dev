<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-pro/push_notifications" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Push notification API | Centrifugo</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://centrifugal.dev/img/centrifugo_soc.png"><meta data-rh="true" name="twitter:image" content="https://centrifugal.dev/img/centrifugo_soc.png"><meta data-rh="true" property="og:url" content="https://centrifugal.dev/docs/pro/push_notifications"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Push notification API | Centrifugo"><meta data-rh="true" name="description" content="Centrifugo excels in delivering real-time in-app messages to online users. Sometimes though you need a way to engage offline users to come back to your app. Or trigger some update in the app while it&#x27;s running in the background. That&#x27;s where push notifications may be used. Push notifications delivered over battery-efficient platform-dependent transport."><meta data-rh="true" property="og:description" content="Centrifugo excels in delivering real-time in-app messages to online users. Sometimes though you need a way to engage offline users to come back to your app. Or trigger some update in the app while it&#x27;s running in the background. That&#x27;s where push notifications may be used. Push notifications delivered over battery-efficient platform-dependent transport."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://centrifugal.dev/docs/pro/push_notifications"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/docs/pro/push_notifications" hreflang="en"><link data-rh="true" rel="alternate" href="https://centrifugal.dev/docs/pro/push_notifications" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EPXZ1LXJ33-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=" Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title=" JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NZRQD92LEX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NZRQD92LEX",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Centrifugo" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"><link rel="stylesheet" href="/assets/css/styles.34438583.css">
<script src="/assets/js/runtime~main.e8a16342.js" defer="defer"></script>
<script src="/assets/js/main.72a8d166.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Centrifugo</b></a><a class="navbar__item navbar__link" href="/docs/getting-started/introduction">Getting Started</a><a class="navbar__item navbar__link" href="/docs/tutorial/intro">Grand tutorial</a><a class="navbar__item navbar__link" href="/docs/server/configuration">Server guide</a><a class="navbar__item navbar__link" href="/docs/transports/overview">Real-time transports / SDK</a><a class="navbar__item navbar__link" href="/docs/faq">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/pro/overview">Centrifugo PRO</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/centrifugal/centrifugo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/getting-started/introduction">v5</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/pro/push_notifications">v5</a></li><li><a class="dropdown__link" href="/docs/4/pro/push_notifications">v4</a></li><li><a class="dropdown__link" href="/docs/3/getting-started/introduction">v3</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Centrifugo Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Centrifugo</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/pro/overview">Centrifugo PRO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/pro/install_and_run">Install and run PRO version</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/pro/tracing">PRO version features</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/tracing">User and channel tracing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/analytics">Analytics with ClickHouse</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/rate_limiting">Operation rate limits</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pro/push_notifications">Push notification API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/admin_idp_auth">SSO for admin UI (OIDC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/user_status">User status API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/connections">Connections API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/user_block">User blocking API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/token_revocation">Token revocation API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/channel_state_events">Channel state events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/capabilities">Channel capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/channel_patterns">Channel patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/cel_expressions">Channel CEL expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/performance">Faster performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/singleflight">Singleflight</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/client_message_batching">Message batching control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/observability_enhancements">Observability enhancements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pro/process_stats">CPU and RSS stats</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Push notification API</h1></header><p>Centrifugo excels in delivering real-time in-app messages to online users. Sometimes though you need a way to engage offline users to come back to your app. Or trigger some update in the app while it&#x27;s running in the background. That&#x27;s where push notifications may be used. Push notifications delivered over battery-efficient platform-dependent transport.</p>
<p>With Centrifugo PRO push notifications may be delivered to all popular application platforms:</p>
<ul>
<li><i class="bi bi-android2" style="color:yellowgreen"></i> Android devices</li>
<li><i class="bi bi-apple" style="color:cornflowerblue"></i> iOS devices</li>
<li><i class="bi bi-globe" style="color:orange"></i> Web browsers which support Web Push API (Chrome, Firefox, see <a href="https://caniuse.com/push-api">this matrix</a>)</li>
</ul>
<p>Centrifugo PRO provides API to manage user device tokens, device topic subscriptions and API to send push notifications towards registered devices and group of devices (subscribed to a topic). API also supports timezone-aware push notifications, push localizations, templating and per user device push rate limiting.</p>
<p><img decoding="async" loading="lazy" alt="Push" src="/assets/images/push_notifications-c1af39fb6bbb1da727bd940368acd4f8.png" width="2879" height="1195" class="img_ev3q"></p>
<p>To deliver push notifications to devices Centrifugo PRO integrates with the following providers:</p>
<ul>
<li><a href="https://firebase.google.com/docs/cloud-messaging" target="_blank" rel="noopener noreferrer">Firebase Cloud Messaging (FCM)</a> <i class="bi bi-android2" style="color:yellowgreen"></i> <i class="bi bi-apple" style="color:cornflowerblue"></i> <i class="bi bi-globe" style="color:orange"></i></li>
<li><a href="https://developer.huawei.com/consumer/en/hms/huawei-pushkit/" target="_blank" rel="noopener noreferrer">Huawei Messaging Service (HMS) Push Kit</a> <i class="bi bi-android2" style="color:yellowgreen"></i> <i class="bi bi-apple" style="color:cornflowerblue"></i> <i class="bi bi-globe" style="color:orange"></i></li>
<li><a href="https://developer.apple.com/documentation/usernotifications" target="_blank" rel="noopener noreferrer">Apple Push Notification service (APNs) </a> <i class="bi bi-apple" style="color:cornflowerblue"></i></li>
</ul>
<p>FCM, HMS, APNs handle the frontend and transport aspects of notification delivery. Device token storage, management and efficient push notification broadcasting is managed by Centrifugo PRO. Tokens are stored in a PostgreSQL database. To facilitate efficient push notification broadcasting towards devices, Centrifugo PRO includes worker queues based on Redis streams (and also provides and option to use PostgreSQL-based queue).</p>
<p>Integration with FCM means that you can use existing Firebase messaging SDKs to extract push notification token for a device on different platforms (iOS, Android, Flutter, web browser) and setting up push notification listeners. The same for HMS and APNs - just use existing native SDKs and best practices on the frontend. Only a couple of additional steps required to integrate frontend with Centrifugo PRO device token and device topic storage. After doing that you will be able to send push notification towards single device, or towards group of devices subscribed to a topic. For example, with a simple Centrifugo API call like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -X POST http://localhost:8000/api/send_push_notification \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-H &quot;Authorization: apikey &lt;KEY&gt;&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-d @- &lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;recipient&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;filter&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;topics&quot;: [&quot;test&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;notification&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;fcm&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;message&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;notification&quot;: {&quot;title&quot;: &quot;Hello&quot;, &quot;body&quot;: &quot;How are you?&quot;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In addition, Centrifugo PRO includes a helpful web UI for inspecting registered devices and sending push notifications:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/push_ui-01989161306e71d882a064b605395dcb.png" width="2728" height="1094" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="motivation-and-design-choices">Motivation and design choices<a href="#motivation-and-design-choices" class="hash-link" aria-label="Direct link to Motivation and design choices" title="Direct link to Motivation and design choices">​</a></h2>
<p>We tried to be practical with our Push Notification API, let&#x27;s look at its design choices and implementation properties we were able to achieve.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="storage-for-tokens">Storage for tokens<a href="#storage-for-tokens" class="hash-link" aria-label="Direct link to Storage for tokens" title="Direct link to Storage for tokens">​</a></h3>
<p>To start delivering push notifications in the application, developers usually need to integrate with providers such as FCM, HMS, and APNs. This integration typically requires the storage of device tokens in the application database and the implementation of sending push messages to provider push services.</p>
<p>Centrifugo PRO simplifies the process by providing a backend for device token storage, following best practices in token management. It reacts to errors and periodically removes stale devices/tokens to maintain a working set of device tokens based on provider recommendations.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="efficient-queuing">Efficient queuing<a href="#efficient-queuing" class="hash-link" aria-label="Direct link to Efficient queuing" title="Direct link to Efficient queuing">​</a></h3>
<p>Additionally, Centrifugo PRO provides an efficient, scalable queuing mechanism for sending push notifications. Developers can send notifications from the app backend to Centrifugo API with minimal latency and let Centrifugo process sending to FCM, HMS, APNs concurrently using built-in workers. In our tests, we achieved several millions pushes per minute.</p>
<p>Centrifugo PRO also supports delayed push notifications feature – to queue push for a later delivery, so for example you can send notification based on user time zone and let Centrifugo PRO send it when needed.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="unified-secure-topics">Unified secure topics<a href="#unified-secure-topics" class="hash-link" aria-label="Direct link to Unified secure topics" title="Direct link to Unified secure topics">​</a></h3>
<p>FCM and HMS have a built-in way of sending notification to large groups of devices over <a href="https://firebase.google.com/docs/cloud-messaging/android/topic-messaging" target="_blank" rel="noopener noreferrer">topics</a> mechanism (<a href="https://developer.huawei.com/consumer/en/doc/development/HMS-Plugin-Guides-V1/subscribetopic-0000001056797545-V1" target="_blank" rel="noopener noreferrer">the same for HMS</a>). Topics are great since you can create segments and groups of devices and target specific ones with your notifications.</p>
<p>One problem with native FCM or HMS topics though is that client can subscribe to any topic from the frontend side without any permission check. In today&#x27;s world this is usually not desired. So Centrifugo PRO re-implements FCM, HMS topics by introducing an additional API to manage device subscriptions to topics.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>In some cases you may have real-time channels and device subscription topics with matching names – to send messages to both online and offline users. Though it&#x27;s up to you.</p></div></div>
<p>Centrifugo PRO device topic subscriptions also add a way to introduce the missing topic semantics for APNs.</p>
<p>Centrifugo PRO additionally provides an API to create persistent bindings of user to notification topics. Then – as soon as user registers a device – it will be automatically subscribed to its own topics. As soon as user logs out from the app and you update user ID of the device - user topics binded to the device automatically removed/switched. This design solves one of the issues with FCM – if two different users use the same device it&#x27;s becoming problematic to unsubscribe the device from large number of topics upon logout. Also, as soon as user to topic binding added (using <code>user_topic_update</code> API) – it will be synchronized across all user active devices. You can still manage such persistent subscriptions on the application backend side if you prefer and provide the full list inside <code>device_register</code> call.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="push-personalization">Push personalization<a href="#push-personalization" class="hash-link" aria-label="Direct link to Push personalization" title="Direct link to Push personalization">​</a></h3>
<p>Centrifugo PRO provides several ways to make push notifications individual and take care about better user experience with notifications. This includes:</p>
<ul>
<li><a href="#timezone-aware-push">Timezone-aware</a> push notifications</li>
<li>Notification <a href="#templating">templating</a></li>
<li>Notification <a href="#localizations">localizations</a></li>
<li>Per user device <a href="#push-rate-limits">rate limiting</a></li>
</ul>
<p>All these features may be used on individual request basis.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="non-obtrusive-proxying">Non-obtrusive proxying<a href="#non-obtrusive-proxying" class="hash-link" aria-label="Direct link to Non-obtrusive proxying" title="Direct link to Non-obtrusive proxying">​</a></h3>
<p>Unlike other solutions that combine different provider push sending APIs into a unified API, Centrifugo PRO provides a non-obtrusive proxy for all the mentioned providers. Developers can send notification payloads in a format defined by each provider.</p>
<p>It&#x27;s also possible to send notifications into native FCM, HMS topics or send to raw FCM, HMS, APNs tokens using Centrifugo PRO&#x27;s push API, allowing them to combine native provider primitives with those added by Centrifugo (i.e., sending to a list of device IDs or to a list of topics).</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="builtin-analytics">Builtin analytics<a href="#builtin-analytics" class="hash-link" aria-label="Direct link to Builtin analytics" title="Direct link to Builtin analytics">​</a></h3>
<p>Furthermore, Centrifugo PRO offers the ability to inspect sent push notifications using <a href="/docs/pro/analytics#notifications-table">ClickHouse analytics</a>. Providers may also offer their own analytics, <a href="https://firebase.google.com/docs/cloud-messaging/understand-delivery?platform=web" target="_blank" rel="noopener noreferrer">such as FCM</a>, which provides insight into push notification delivery. Centrifugo PRO also offers a way to analyze push notification delivery and interaction using the <code>update_push_status</code> API.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="steps-to-integrate">Steps to integrate<a href="#steps-to-integrate" class="hash-link" aria-label="Direct link to Steps to integrate" title="Direct link to Steps to integrate">​</a></h2>
<ol>
<li>Add provider SDK on the frontend side, follow provider instructions for your platform to obtain a push token for a device. For example, for FCM see instructions for <a href="https://firebase.google.com/docs/cloud-messaging/ios/client" target="_blank" rel="noopener noreferrer">iOS</a>, <a href="https://firebase.google.com/docs/cloud-messaging/android/client" target="_blank" rel="noopener noreferrer">Android</a>, <a href="https://firebase.google.com/docs/cloud-messaging/flutter/client" target="_blank" rel="noopener noreferrer">Flutter</a>, <a href="https://firebase.google.com/docs/cloud-messaging/js/client" target="_blank" rel="noopener noreferrer">Web Browser</a>). The same for HMS or APNs – frontend part should be handled by their native SDKs.</li>
<li>Call Centrifugo PRO backend API with the obtained token. From the application backend call Centrifugo <code>device_register</code> API to register the device in Centrifugo PRO storage. Optionally provide list of topics to subscribe device to.</li>
<li>Centrifugo returns a registered device object. Pass a generated device ID to the frontend and save it on the frontend together with a token received from FCM.</li>
<li>Call Centrifugo <code>send_push_notification</code> API whenever it&#x27;s time to deliver a push notification.</li>
</ol>
<p>At any moment you can inspect device storage by calling <code>device_list</code> API.</p>
<p>Once user logs out from the app, you can detach user ID from device by using <code>device_update</code> or remove device with <code>device_remove</code> API.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2>
<p>In Centrifugo PRO you can configure one push provider or use all of them – this choice is up to you.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="fcm">FCM<a href="#fcm" class="hash-link" aria-label="Direct link to FCM" title="Direct link to FCM">​</a></h3>
<p>As mentioned above Centrifigo uses PostgreSQL for token storage. To enable push notifications make sure <code>database</code> section defined in the configration and <code>fcm</code> is in the <code>push_notifications.enabled_providers</code> list. Centrifugo PRO uses Redis for queuing push notification requests, so Redis address should be configured also. Finally, to integrate with FCM a path to the credentials file must be provided (see how to create one <a href="https://github.com/Catapush/catapush-docs/blob/master/AndroidSDK/DOCUMENTATION_PLATFORM_GMS_FCM.md" target="_blank" rel="noopener noreferrer">in this instruction</a>). So the full configuration to start sending push notifications over FCM may look like this:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;database&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;dsn&quot;: &quot;postgresql://postgres:pass@127.0.0.1:5432/postgres&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;push_notifications&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;redis_address&quot;: &quot;localhost:6379&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;enabled_providers&quot;: [&quot;fcm&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;fcm_credentials_file_path&quot;: &quot;/path/to/service/account/credentials.json&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Actually, PostgreSQL database configuration is optional here – you can use push notifications API without it. In this case you will be able to send notifications to FCM, HMS, APNs raw tokens, FCM and HMS native topics and conditions. I.e. using Centrifugo as an efficient proxy for push notifications (for example if you already keep tokens in your database). But sending to device ids and topics, and token/topic management APIs won&#x27;t be available for usage.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hms">HMS<a href="#hms" class="hash-link" aria-label="Direct link to HMS" title="Direct link to HMS">​</a></h3>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;database&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;dsn&quot;: &quot;postgresql://postgres:pass@127.0.0.1:5432/postgres&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;push_notifications&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;redis_address&quot;: &quot;localhost:6379&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;enabled_providers&quot;: [&quot;hms&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;hms_app_id&quot;: &quot;&lt;your_app_id&gt;&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;hms_app_secret&quot;: &quot;&lt;your_app_secret&gt;&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>See example how to get app id and app secret <a href="https://github.com/Catapush/catapush-docs/blob/master/AndroidSDK/DOCUMENTATION_PLATFORM_HMS_PUSHKIT.md" target="_blank" rel="noopener noreferrer">here</a>.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="apns">APNs<a href="#apns" class="hash-link" aria-label="Direct link to APNs" title="Direct link to APNs">​</a></h3>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;database&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;dsn&quot;: &quot;postgresql://postgres:pass@127.0.0.1:5432/postgres&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;push_notifications&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;redis_address&quot;: &quot;localhost:6379&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;enabled_providers&quot;: [&quot;apns&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;apns_endpoint&quot;: &quot;development&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;apns_bundle_id&quot;: &quot;com.example.your_app&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;apns_auth&quot;: &quot;token&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;apns_token_auth_key_path&quot;: &quot;/path/to/auth/key/file.p8&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;apns_token_key_id&quot;: &quot;&lt;your_key_id&gt;&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;apns_token_team_id&quot;: &quot;your_team_id&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We also support auth over p12 certificates with the following options:</p>
<ul>
<li><code>push_notifications.apns_cert_p12_path</code></li>
<li><code>push_notifications.apns_cert_p12_b64</code></li>
<li><code>push_notifications.apns_cert_p12_password</code></li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="other-options">Other options<a href="#other-options" class="hash-link" aria-label="Direct link to Other options" title="Direct link to Other options">​</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="push_notificationsmax_inactive_device_days">push_notifications.max_inactive_device_days<a href="#push_notificationsmax_inactive_device_days" class="hash-link" aria-label="Direct link to push_notifications.max_inactive_device_days" title="Direct link to push_notifications.max_inactive_device_days">​</a></h4>
<p>This integer option configures the number of days to keep device without updates. By default Centrifugo does not remove inactive devices.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="push_notificationsdry_run">push_notifications.dry_run<a href="#push_notificationsdry_run" class="hash-link" aria-label="Direct link to push_notifications.dry_run" title="Direct link to push_notifications.dry_run">​</a></h4>
<p>Boolean option, when <code>true</code> Centrifugo PRO does not send push notifications to FCM, APNs, HMS providers but instead just print logs. Useful for development.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="push_notificationsdry_run_latency">push_notifications.dry_run_latency<a href="#push_notificationsdry_run_latency" class="hash-link" aria-label="Direct link to push_notifications.dry_run_latency" title="Direct link to push_notifications.dry_run_latency">​</a></h4>
<p>Duration. When set together with <code>push_notifications.dry_run</code> every dry-run request will cause some delay in workers emulating real-world latency. Useful for development.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="use-postgresql-as-queue">Use PostgreSQL as queue<a href="#use-postgresql-as-queue" class="hash-link" aria-label="Direct link to Use PostgreSQL as queue" title="Direct link to Use PostgreSQL as queue">​</a></h3>
<p>Centrifugo PRO utilizes Redis Streams as the default queue engine for push notifications. However, it also offers the option to employ PostgreSQL for queuing. It&#x27;s as simple as:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockTitle_Ktv7">config.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;database&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;dsn&quot;: &quot;postgresql://postgres:pass@127.0.0.1:5432/postgres&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;push_notifications&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;queue_engine&quot;: &quot;database&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // rest of the options...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Queue based on Redis streams is generally more efficient, so if you start with PostgreSQL based queue – you have an option to switch to a more performant implementation later. Though in-flight and currently queued push notifications will be lost during a switch.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="api-description">API description<a href="#api-description" class="hash-link" aria-label="Direct link to API description" title="Direct link to API description">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_register">device_register<a href="#device_register" class="hash-link" aria-label="Direct link to device_register" title="Direct link to device_register">​</a></h3>
<p>Registers or updates device information.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_register-request">device_register request<a href="#device_register-request" class="hash-link" aria-label="Direct link to device_register request" title="Direct link to device_register request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>No</td><td>ID of the device being registered (provide it when updating).</td></tr><tr><td><code>provider</code></td><td>string</td><td>Yes</td><td>Provider of the device token (valid choices: <code>fcm</code>, <code>hms</code>, <code>apns</code>).</td></tr><tr><td><code>token</code></td><td>string</td><td>Yes</td><td>Push notification token for the device.</td></tr><tr><td><code>platform</code></td><td>string</td><td>Yes</td><td>Platform of the device (valid choices: <code>ios</code>, <code>android</code>, <code>web</code>).</td></tr><tr><td><code>user</code></td><td>string</td><td>No</td><td>User associated with the device.</td></tr><tr><td><code>timezone</code></td><td>string</td><td>No</td><td>Timezone of device user (<a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="noopener noreferrer">IANA time zone identifier</a>, ex. <code>Europe/Nicosia</code>). See <a href="#timezone-aware-push">Timezone aware push</a></td></tr><tr><td><code>locale</code></td><td>string</td><td>No</td><td>Locale of device user. Must be IETF BCP 47 language tag - ex. <code>en-US</code>, <code>fr-CA</code>. See <a href="#localizations">Localizations</a></td></tr><tr><td><code>topics</code></td><td>array of strings</td><td>No</td><td>Device topic subscriptions. This should be a full list which replaces all the topics previously accociated with the device. User topics managed by <code>UserTopic</code> model will be automatically attached.</td></tr><tr><td><code>meta</code></td><td><code>map&lt;string, string&gt;</code></td><td>No</td><td>Additional custom metadata for the device</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_register-result">device_register result<a href="#device_register-result" class="hash-link" aria-label="Direct link to device_register result" title="Direct link to device_register result">​</a></h4>
<table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Yes</td><td>The device ID that was registered/updated.</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_update">device_update<a href="#device_update" class="hash-link" aria-label="Direct link to device_update" title="Direct link to device_update">​</a></h3>
<p>Call this method to update device. For example, when user logs out the app and you need to detach user ID from the device.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_update-request">device_update request<a href="#device_update-request" class="hash-link" aria-label="Direct link to device_update request" title="Direct link to device_update request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>ids</code></td><td>repeated string</td><td>No</td><td>Device ids to filter</td></tr><tr><td><code>users</code></td><td>repeated string</td><td>No</td><td>Device users filter</td></tr><tr><td><code>user_update</code></td><td><code>DeviceUserUpdate</code></td><td>No</td><td>Optional user update object</td></tr><tr><td><code>timezone_update</code></td><td><code>DeviceTimezoneUpdate</code></td><td>No</td><td>Optional timezone update object</td></tr><tr><td><code>locale_update</code></td><td><code>DeviceLocaleUpdate</code></td><td>No</td><td>Optional locale update object</td></tr><tr><td><code>meta_update</code></td><td><code>DeviceMetaUpdate</code></td><td>No</td><td>Optional device meta update object</td></tr><tr><td><code>topics_update</code></td><td><code>DeviceTopicsUpdate</code></td><td>No</td><td>Optional topics update object</td></tr></tbody></table>
<p><code>DeviceUserUpdate</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>user</code></td><td>string</td><td>Yes</td><td>User to set</td></tr></tbody></table>
<p><code>DeviceTimezoneUpdate</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>timezone</code></td><td>string</td><td>Yes</td><td>Timezone to set</td></tr></tbody></table>
<p><code>DeviceLocaleUpdate</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>locale</code></td><td>string</td><td>Yes</td><td>Locale to set</td></tr></tbody></table>
<p><code>DeviceMetaUpdate</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>meta</code></td><td><code>map&lt;string, string&gt;</code></td><td>Yes</td><td>Meta to set</td></tr></tbody></table>
<p><code>DeviceTopicsUpdate</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>op</code></td><td>string</td><td>Yes</td><td>Operation to make: <code>add</code>, <code>remove</code> or <code>set</code></td></tr><tr><td><code>topics</code></td><td>repeated string</td><td>Yes</td><td>Topics for the operation</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_update-result">device_update result<a href="#device_update-result" class="hash-link" aria-label="Direct link to device_update result" title="Direct link to device_update result">​</a></h4>
<p>Empty object.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_remove">device_remove<a href="#device_remove" class="hash-link" aria-label="Direct link to device_remove" title="Direct link to device_remove">​</a></h3>
<p>Removes device from storage. This may be also called when user logs out the app and you don&#x27;t need its device token after that.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_remove-request">device_remove request<a href="#device_remove-request" class="hash-link" aria-label="Direct link to device_remove request" title="Direct link to device_remove request">​</a></h4>
<table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>ids</code></td><td>repeated string</td><td>No</td><td>A list of device IDs to be removed</td></tr><tr><td><code>users</code></td><td>repeated string</td><td>No</td><td>A list of device user IDs to filter devices to remove</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_remove-result">device_remove result<a href="#device_remove-result" class="hash-link" aria-label="Direct link to device_remove result" title="Direct link to device_remove result">​</a></h4>
<p>Empty object.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_list">device_list<a href="#device_list" class="hash-link" aria-label="Direct link to device_list" title="Direct link to device_list">​</a></h3>
<p>Returns a paginated list of registered devices according to request filter conditions.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_list-request">device_list request<a href="#device_list-request" class="hash-link" aria-label="Direct link to device_list request" title="Direct link to device_list request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>filter</code></td><td><code>DeviceFilter</code></td><td>Yes</td><td>How to filter results</td></tr><tr><td><code>cursor</code></td><td>string</td><td>No</td><td>Cursor for pagination (last device id in previous batch, empty for first page).</td></tr><tr><td><code>limit</code></td><td>int32</td><td>No</td><td>Maximum number of devices to retrieve.</td></tr><tr><td><code>include_total_count</code></td><td>bool</td><td>No</td><td>Flag indicating whether to include total count for the current filter.</td></tr><tr><td><code>include_topics</code></td><td>bool</td><td>No</td><td>Flag indicating whether to include topics information for each device.</td></tr><tr><td><code>include_meta</code></td><td>bool</td><td>No</td><td>Flag indicating whether to include meta information for each device.</td></tr></tbody></table>
<p><code>DeviceFilter</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>ids</code></td><td>repeated string</td><td>No</td><td>List of device IDs to filter results.</td></tr><tr><td><code>providers</code></td><td>repeated string</td><td>No</td><td>List of device token providers to filter results.</td></tr><tr><td><code>platforms</code></td><td>repeated string</td><td>No</td><td>List of device platforms to filter results.</td></tr><tr><td><code>users</code></td><td>repeated string</td><td>No</td><td>List of device users to filter results.</td></tr><tr><td><code>topics</code></td><td>repeated string</td><td>No</td><td>List of topics to filter results.</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_list-result">device_list result<a href="#device_list-result" class="hash-link" aria-label="Direct link to device_list result" title="Direct link to device_list result">​</a></h4>
<table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>items</code></td><td>repeated <code>Device</code></td><td>Yes</td><td>A list of devices</td></tr><tr><td><code>next_cursor</code></td><td>string</td><td>No</td><td>Cursor string for retreiving the next page, if not set - then no next page exists</td></tr><tr><td><code>total_count</code></td><td>integer</td><td>No</td><td>Total count value (if <code>include_total_count</code> used)</td></tr></tbody></table>
<p><code>Device</code>:</p>
<table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Yes</td><td>The device&#x27;s ID.</td></tr><tr><td><code>provider</code></td><td>string</td><td>Yes</td><td>The device&#x27;s token provider.</td></tr><tr><td><code>token</code></td><td>string</td><td>Yes</td><td>The device&#x27;s token.</td></tr><tr><td><code>platform</code></td><td>string</td><td>Yes</td><td>The device&#x27;s platform.</td></tr><tr><td><code>user</code></td><td>string</td><td>No</td><td>The user associated with the device.</td></tr><tr><td><code>topics</code></td><td>array of strings</td><td>No</td><td>Only included if <code>include_topics</code> was true</td></tr><tr><td><code>meta</code></td><td><code>map&lt;string, string&gt;</code></td><td>No</td><td>Only included if <code>include_meta</code> was true</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_topic_update">device_topic_update<a href="#device_topic_update" class="hash-link" aria-label="Direct link to device_topic_update" title="Direct link to device_topic_update">​</a></h3>
<p>Manage mapping of device to topics.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_topic_update-request">device_topic_update request<a href="#device_topic_update-request" class="hash-link" aria-label="Direct link to device_topic_update request" title="Direct link to device_topic_update request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>device_id</code></td><td>string</td><td>Yes</td><td>Device ID.</td></tr><tr><td><code>op</code></td><td>string</td><td>Yes</td><td><code>add</code> or <code>remove</code> or <code>set</code></td></tr><tr><td><code>topics</code></td><td>repeated string</td><td>No</td><td>List of topics.</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_topic_update-result">device_topic_update result<a href="#device_topic_update-result" class="hash-link" aria-label="Direct link to device_topic_update result" title="Direct link to device_topic_update result">​</a></h4>
<p>Empty object.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_topic_list">device_topic_list<a href="#device_topic_list" class="hash-link" aria-label="Direct link to device_topic_list" title="Direct link to device_topic_list">​</a></h3>
<p>List device to topic mapping.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_topic_list-request">device_topic_list request<a href="#device_topic_list-request" class="hash-link" aria-label="Direct link to device_topic_list request" title="Direct link to device_topic_list request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>filter</code></td><td><code>DeviceTopicFilter</code></td><td>No</td><td>List of device IDs to filter results.</td></tr><tr><td><code>cursor</code></td><td>string</td><td>No</td><td>Cursor for pagination (last device id in previous batch, empty for first page).</td></tr><tr><td><code>limit</code></td><td>int32</td><td>No</td><td>Maximum number of devices to retrieve.</td></tr><tr><td><code>include_device</code></td><td>bool</td><td>No</td><td>Flag indicating whether to include Device information for each object.</td></tr><tr><td><code>include_total_count</code></td><td>bool</td><td>No</td><td>Flag indicating whether to include total count info to response.</td></tr></tbody></table>
<p><code>DeviceTopicFilter</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>device_ids</code></td><td>repeated string</td><td>No</td><td>List of device IDs to filter results.</td></tr><tr><td><code>device_providers</code></td><td>repeated string</td><td>No</td><td>List of device token providers to filter results.</td></tr><tr><td><code>device_platforms</code></td><td>repeated string</td><td>No</td><td>List of device platforms to filter results.</td></tr><tr><td><code>device_users</code></td><td>repeated string</td><td>No</td><td>List of device users to filter results.</td></tr><tr><td><code>topics</code></td><td>repeated string</td><td>No</td><td>List of topics to filter results.</td></tr><tr><td><code>topic_prefix</code></td><td>string</td><td>No</td><td>Topic prefix to filter results.</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device_topic_list-result">device_topic_list result<a href="#device_topic_list-result" class="hash-link" aria-label="Direct link to device_topic_list result" title="Direct link to device_topic_list result">​</a></h4>
<table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>items</code></td><td>repeated <code>DeviceTopic</code></td><td>Yes</td><td>A list of DeviceChannel objects</td></tr><tr><td><code>next_cursor</code></td><td>string</td><td>No</td><td>Cursor string for retreiving the next page, if not set - then no next page exists</td></tr><tr><td><code>total_count</code></td><td>integer</td><td>No</td><td>Total count value (if <code>include_total_count</code> used)</td></tr></tbody></table>
<p><code>DeviceTopic</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Yes</td><td>ID of DeviceTopic object</td></tr><tr><td><code>device_id</code></td><td>string</td><td>Yes</td><td>Device ID</td></tr><tr><td><code>topic</code></td><td>string</td><td>Yes</td><td>Topic</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user_topic_update">user_topic_update<a href="#user_topic_update" class="hash-link" aria-label="Direct link to user_topic_update" title="Direct link to user_topic_update">​</a></h3>
<p>Manage mapping of topics with users. These user topics will be automatically attached to user devices upon registering. And removed from device upon deattaching user.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user_topic_update-request">user_topic_update request<a href="#user_topic_update-request" class="hash-link" aria-label="Direct link to user_topic_update request" title="Direct link to user_topic_update request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>user</code></td><td>string</td><td>Yes</td><td>User ID.</td></tr><tr><td><code>op</code></td><td>string</td><td>Yes</td><td><code>add</code> or <code>remove</code> or <code>set</code></td></tr><tr><td><code>topics</code></td><td>repeated string</td><td>No</td><td>List of topics.</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user_topic_update-result">user_topic_update result<a href="#user_topic_update-result" class="hash-link" aria-label="Direct link to user_topic_update result" title="Direct link to user_topic_update result">​</a></h4>
<p>Empty object.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user_topic_list">user_topic_list<a href="#user_topic_list" class="hash-link" aria-label="Direct link to user_topic_list" title="Direct link to user_topic_list">​</a></h3>
<p>List user to topic mapping.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user_topic_list-request">user_topic_list request<a href="#user_topic_list-request" class="hash-link" aria-label="Direct link to user_topic_list request" title="Direct link to user_topic_list request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>flter</code></td><td><code>UserTopicFilter</code></td><td>No</td><td>Filter object.</td></tr><tr><td><code>cursor</code></td><td>string</td><td>No</td><td>Cursor for pagination (last id in previous batch, empty for first page).</td></tr><tr><td><code>limit</code></td><td>int32</td><td>No</td><td>Maximum number of <code>UserTopic</code> objects to retrieve.</td></tr><tr><td><code>include_total_count</code></td><td>bool</td><td>No</td><td>Flag indicating whether to include total count info to response.</td></tr></tbody></table>
<p><code>UserTopicFilter</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>users</code></td><td>repeated string</td><td>No</td><td>List of users to filter results.</td></tr><tr><td><code>topics</code></td><td>repeated string</td><td>No</td><td>List of topics to filter results.</td></tr><tr><td><code>topic_prefix</code></td><td>string</td><td>No</td><td>Channel prefix to filter results.</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user_topic_list-result">user_topic_list result<a href="#user_topic_list-result" class="hash-link" aria-label="Direct link to user_topic_list result" title="Direct link to user_topic_list result">​</a></h4>
<table><thead><tr><th>Field Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>items</code></td><td>repeated <code>UserTopic</code></td><td>A list of UserTopic objects</td></tr><tr><td><code>next_cursor</code></td><td>string</td><td>No</td></tr><tr><td><code>total_count</code></td><td>integer</td><td>No</td></tr></tbody></table>
<p><code>UserTopic</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Yes</td><td>ID of <code>UserTopic</code></td></tr><tr><td><code>user</code></td><td>string</td><td>Yes</td><td>User ID</td></tr><tr><td><code>topic</code></td><td>string</td><td>Yes</td><td>Topic</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="send_push_notification">send_push_notification<a href="#send_push_notification" class="hash-link" aria-label="Direct link to send_push_notification" title="Direct link to send_push_notification">​</a></h3>
<p>Send push notification to specific <code>device_ids</code>, or to <code>topics</code>, or native provider identifiers like <code>fcm_tokens</code>, or to <code>fcm_topic</code>. Request will be queued by Centrifugo, consumed by Centrifugo built-in workers and sent to the provider API.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="send_push_notification-request">send_push_notification request<a href="#send_push_notification-request" class="hash-link" aria-label="Direct link to send_push_notification request" title="Direct link to send_push_notification request">​</a></h4>
<table><thead><tr><th>Field name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>recipient</code></td><td><code>PushRecipient</code></td><td>Yes</td><td>Recipient of push notification</td></tr><tr><td><code>notification</code></td><td><code>PushNotification</code></td><td>Yes</td><td>Push notification to send</td></tr><tr><td><code>uid</code></td><td>string</td><td>No</td><td>Unique identifier for each push notification request, can be used to cancel push. We recommend using UUID v4 for it. Two different requests must have different <code>uid</code></td></tr><tr><td><code>send_at</code></td><td>int64</td><td>No</td><td>Optional Unix time in the future (in seconds) when to send push notification, push will be queued until that time.</td></tr><tr><td><code>optimize_for_reliability</code></td><td>bool</td><td>No</td><td>Makes processing heavier, but tolerates edge cases, like not loosing inflight pushes due to temporary queue unavailability.</td></tr><tr><td><code>limit_strategy</code></td><td><code>PushLimitStrategy</code></td><td>No</td><td>Can be used to set push time constraints (based on device timezone) adnd rate limits. Note, when it&#x27;s used Centrifugo processes pushes one by one instead of batch sending</td></tr><tr><td><code>analytics_uid</code></td><td>string</td><td>No</td><td>Identifier for push notification analytics, if not set - Centrifugo will use <code>uid</code> field.</td></tr><tr><td><code>localizations</code></td><td><code>map&lt;string, PushLocalization&gt;</code></td><td>No</td><td>Optional per language localizations for push notification.</td></tr><tr><td><code>use_templating</code></td><td>bool</td><td>No</td><td>If set - Centrifugo will use templating for push notification. Note that setting localizations enables templating automatically.</td></tr><tr><td><code>use_meta</code></td><td>bool</td><td>No</td><td>If set - Centrifugo will additionally load device meta during push sending, this meta becomes available in templating.</td></tr></tbody></table>
<p><code>PushRecipient</code> (you <strong>must set only one of the following fields</strong>):</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>filter</code></td><td><code>DeviceFilter</code></td><td>No</td><td>Send to device IDs based on Centrifugo device storage filter</td></tr><tr><td><code>fcm_tokens</code></td><td>repeated string</td><td>No</td><td>Send to a list of FCM native tokens</td></tr><tr><td><code>fcm_topic</code></td><td>string</td><td>No</td><td>Send to a FCM native topic</td></tr><tr><td><code>fcm_condition</code></td><td>string</td><td>No</td><td>Send to a FCM native condition</td></tr><tr><td><code>hms_tokens</code></td><td>repeated string</td><td>No</td><td>Send to a list of HMS native tokens</td></tr><tr><td><code>hms_topic</code></td><td>string</td><td>No</td><td>Send to a HMS native topic</td></tr><tr><td><code>hms_condition</code></td><td>string</td><td>No</td><td>Send to a HMS native condition</td></tr><tr><td><code>apns_tokens</code></td><td>repeated string</td><td>No</td><td>Send to a list of APNs native tokens</td></tr></tbody></table>
<p><code>PushNotification</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>expire_at</code></td><td>int64</td><td>No</td><td>Unix timestamp when Centrifugo stops attempting to send this notification. Note, it&#x27;s Centrifugo specific and does not relate to notification TTL fields. We generally recommend to always set this to a reasonable value to protect your app from old push notifications sending</td></tr><tr><td><code>fcm</code></td><td><code>FcmPushNotification</code></td><td>No</td><td>Notification for FCM</td></tr><tr><td><code>hms</code></td><td><code>HmsPushNotification</code></td><td>No</td><td>Notification for HMS</td></tr><tr><td><code>apns</code></td><td><code>ApnsPushNotification</code></td><td>No</td><td>Notification for APNs</td></tr></tbody></table>
<p><code>FcmPushNotification</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>message</code></td><td>JSON object</td><td>Yes</td><td>FCM <a href="https://firebase.google.com/docs/reference/fcm/rest/v1/projects.messages#Message" target="_blank" rel="noopener noreferrer">Message</a> described in FCM docs.</td></tr></tbody></table>
<p><code>HmsPushNotification</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>message</code></td><td>JSON object</td><td>Yes</td><td>HMS <a href="https://developer.huawei.com/consumer/en/doc/development/HMSCore-References/https-send-api-0000001050986197#EN-US_TOPIC_0000001134031085__p1324218481619" target="_blank" rel="noopener noreferrer">Message</a> described in HMS Push Kit docs.</td></tr></tbody></table>
<p><code>ApnsPushNotification</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>headers</code></td><td><code>map&lt;string, string&gt;</code></td><td>No</td><td>APNs <a href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/sending_notification_requests_to_apns" target="_blank" rel="noopener noreferrer">headers</a></td></tr><tr><td><code>payload</code></td><td>JSON object</td><td>Yes</td><td>APNs <a href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/generating_a_remote_notification" target="_blank" rel="noopener noreferrer">payload</a></td></tr></tbody></table>
<p><code>PushLocalization</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>translations</code></td><td><code>map&lt;string, string&gt;</code></td><td>Yes</td><td>Variable name to value for the specific language.</td></tr></tbody></table>
<p><code>PushLimitStrategy</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>rate_limit</code></td><td><code>PushRateLimitStrategy</code></td><td>No</td><td>Set rate limit policies</td></tr><tr><td><code>time_limit</code></td><td><code>PushTimeLimitStrategy</code></td><td>No</td><td>Set time limit policy</td></tr></tbody></table>
<p><code>PushRateLimitStrategy</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>key</code></td><td>string</td><td>No</td><td>Optional key for rate limit policy, supports variables (<code>devide.id</code> and <code>device.user</code>).</td></tr><tr><td><code>policies</code></td><td>repeated <code>RateLimitPolicy</code></td><td>No</td><td>Set time limit policy</td></tr><tr><td><code>drop_if_rate_limited</code></td><td>bool</td><td>No</td><td>Drop push if rate limited, otherwise queue for later</td></tr><tr><td>delayed</td><td></td><td></td><td></td></tr><tr><td><code>RateLimitPolicy</code>:</td><td></td><td></td><td></td></tr></tbody></table>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>rate</code></td><td>int</td><td>Yes</td><td>Allowed rate</td></tr><tr><td><code>interval_ms</code></td><td>int</td><td>Yes</td><td>Interval over which rate is allowed</td></tr></tbody></table>
<p><code>PushTimeLimitStrategy</code>:</p>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>send_after_time</code></td><td>string</td><td>Yes</td><td>Local time in format <code>HH:MM:SS</code> after which push must be sent</td></tr><tr><td><code>send_before_time</code></td><td>string</td><td>Yes</td><td>Local time in format <code>HH:MM:SS</code> before which push must be sent</td></tr><tr><td><code>no_tz_send_now</code></td><td>bool</td><td>No</td><td>If device does not have timezone send push immediately, be default - will be dropped</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="send_push_notification-result">send_push_notification result<a href="#send_push_notification-result" class="hash-link" aria-label="Direct link to send_push_notification result" title="Direct link to send_push_notification result">​</a></h4>
<table><thead><tr><th>Field Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>uid</code></td><td>string</td><td>Unique send id, matches <code>uid</code> in request if it was provided</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cancel_push">cancel_push<a href="#cancel_push" class="hash-link" aria-label="Direct link to cancel_push" title="Direct link to cancel_push">​</a></h3>
<p>Cancel delayed push notification (which was sent with custom <code>send_at</code> value).</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update_push_status-request">update_push_status request<a href="#update_push_status-request" class="hash-link" aria-label="Direct link to update_push_status request" title="Direct link to update_push_status request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>uid</code></td><td>string</td><td>Yes</td><td><code>uid</code> of push notification to cancel</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update_push_status-result">update_push_status result<a href="#update_push_status-result" class="hash-link" aria-label="Direct link to update_push_status result" title="Direct link to update_push_status result">​</a></h4>
<p>Empty object.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update_push_status">update_push_status<a href="#update_push_status" class="hash-link" aria-label="Direct link to update_push_status" title="Direct link to update_push_status">​</a></h3>
<p>This API call is experimental, some changes may happen here.</p>
<p>Centrifugo PRO also allows tracking status of push notification delivery and interaction. It&#x27;s possible to use <code>update_push_status</code> API to save the updated status of push notification to the <code>notifications</code> <a href="/docs/pro/analytics#notifications-table">analytics table</a>. Then it&#x27;s possible to build insights into push notification effectiveness by querying the table.</p>
<p>The <code>update_push_status</code> API supposes that you are using <code>uid</code> field with each notification sent and you are using Centrifugo PRO generated device IDs (as described in <a href="#steps-to-integrate">steps to integrate</a>).</p>
<p>This is a part of server API at the moment, so you need to proxy requests to this endpoint over your backend. We can consider making this API suitable for requests from the client side – please reach out if your use case requires it.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update_push_status-request-1">update_push_status request<a href="#update_push_status-request-1" class="hash-link" aria-label="Direct link to update_push_status request" title="Direct link to update_push_status request">​</a></h4>
<table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>analytics_uid</code></td><td>string</td><td>Yes</td><td><code>uid</code> (unique send id) from <code>send_push_notification</code></td></tr><tr><td><code>status</code></td><td>string</td><td>Yes</td><td>Status of push notification - <code>delivered</code> or <code>interacted</code></td></tr><tr><td><code>device_id</code></td><td>string</td><td>Yes</td><td>Device ID</td></tr><tr><td><code>msg_id</code></td><td>string</td><td>No</td><td>Message ID</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update_push_status-result-1">update_push_status result<a href="#update_push_status-result-1" class="hash-link" aria-label="Direct link to update_push_status result" title="Direct link to update_push_status result">​</a></h4>
<p>Empty object.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="timezone-aware-push">Timezone aware push<a href="#timezone-aware-push" class="hash-link" aria-label="Direct link to Timezone aware push" title="Direct link to Timezone aware push">​</a></h2>
<p>Setting <code>timezone</code> to a device (see <a href="#device_register">device_register</a> call) opens a road for timezone-aware push notifications. This is nice because you can send notifications to users in a convenient time of the day. Avoid pushes at night, push at specific time.</p>
<p>To send such push notifications use <code>time_limit</code> field of <code>PushLimitStrategy</code>. For example, you can send push between <code>09:00:00</code> and <code>09:30:00</code> – and Centrifugo will send push somewhere during this period of user&#x27;s local time.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Given Centrifugo takes timezone from devices table into account timezone aware pushes only work with requests where <code>DeviceFilter</code> is used for sending – i.e. when Centrifugo iterates over devices in the database. If you send using raw tokens and want to inherit possibility to use timezones - reach out to us, this may be supported.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="templating">Templating<a href="#templating" class="hash-link" aria-label="Direct link to Templating" title="Direct link to Templating">​</a></h2>
<p>It&#x27;s possible to use templating in the content of your push notifications payloads. By default, Centrifugo does not use templating since this allows broadcasting pushes at max speed. You have to set <code>use_templating</code> flag to <code>true</code> when sending push to enable template execution. Here is an example of using templating:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ..</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;title&quot;: &quot;Hello {{.device.meta.first_name}}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To access device meta content in push template (as shown above) additionally set <code>use_meta</code> flag to <code>true</code> in send push notification request. Without <code>use_meta</code> you only have access to <code>.device.id</code> and <code>.device.user</code> variables.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Given Centrifugo takes timezone from devices table into account timezone aware pushes only work with requests where <code>DeviceFilter</code> is used for sending – i.e. when Centrifugo iterates over devices in the database.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="localizations">Localizations<a href="#localizations" class="hash-link" aria-label="Direct link to Localizations" title="Direct link to Localizations">​</a></h2>
<p>Templating also allows us to localize push notification content based on device <code>locale</code> (see <a href="#device_register">device_register</a> call).</p>
<p>When sending push notification use <code>localizations</code> field of <a href="#send_push_notification-request">send_push_notification request</a>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ..</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;localizations&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;pt&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;translations&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;greeting&quot;: &quot;Olá&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;question&quot;: &quot;Como tá indo&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;fr&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;translations&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;greeting&quot;: &quot;Bonjour&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;question&quot;: &quot;Comment ça va&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In push payload you can then use templating and <code>l10n</code> object will be set to a proper translation map based on device <code>locale</code>:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ..</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;title&quot;: &quot;{{default [[hello]] .l10n.greeting}}! {{ default [[How is it going]] .l10n.question }} ?&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So that a device with <code>pt-BR</code> locale will get a push notification with title <code>Olá! Como tá indo?</code>.</p>
<p>Note, it&#x27;s required to set default value here (we used English language in the example) for the cases when no locale found in device, or no translations for the device language provided in the request.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="push-rate-limits">Push rate limits<a href="#push-rate-limits" class="hash-link" aria-label="Direct link to Push rate limits" title="Direct link to Push rate limits">​</a></h2>
<p>A good practice when working with push notifications is to avoid sending too many notifications to your users, especially marketing ones. Centrifugo PRO provides a way to rate limit notifications on user&#x27;s device level.</p>
<p>To do this, use <code>rate_limit</code> field of <code>PushLimitStrategy</code>. For example, you can configure policies to send push notifications not faster than once per minute and not more pushes than 10 in one hour. I.e. Centrifugo supports several policies for rate limit strategy. If push notification hits provided rate limits then it will be automatically delayed, or dropped if <code>drop_if_rate_limited</code> flag set to <code>true</code>.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Given Centrifugo takes timezone from devices table into account timezone aware pushes only work with requests where <code>DeviceFilter</code> is used for sending – i.e. when Centrifugo iterates over devices in the database. If you send using raw tokens and want to inherit possibility to use rate limits - reach out to us, this may be supported.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="exposed-metrics">Exposed metrics<a href="#exposed-metrics" class="hash-link" aria-label="Direct link to Exposed metrics" title="Direct link to Exposed metrics">​</a></h2>
<p>Several metrics are available to monitor the state of Centrifugo push worker system:</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="centrifugo_push_notification_count">centrifugo_push_notification_count<a href="#centrifugo_push_notification_count" class="hash-link" aria-label="Direct link to centrifugo_push_notification_count" title="Direct link to centrifugo_push_notification_count">​</a></h4>
<ul>
<li><strong>Type:</strong> Counter</li>
<li><strong>Labels:</strong> provider, recipient_type, platform, success, err_code</li>
<li><strong>Description:</strong> Total count of push notifications.</li>
<li><strong>Usage:</strong> Helps in tracking the number and success rate of push notifications sent, providing insights for optimization and troubleshooting.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="centrifugo_push_queue_consuming_lag">centrifugo_push_queue_consuming_lag<a href="#centrifugo_push_queue_consuming_lag" class="hash-link" aria-label="Direct link to centrifugo_push_queue_consuming_lag" title="Direct link to centrifugo_push_queue_consuming_lag">​</a></h4>
<ul>
<li><strong>Type:</strong> Gauge</li>
<li><strong>Labels:</strong> provider, queue</li>
<li><strong>Description:</strong> Queue consuming lag in seconds.</li>
<li><strong>Usage:</strong> Useful for monitoring the delay in processing jobs from the queue, helping identify potential bottlenecks and ensuring timely processing.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="centrifugo_push_consuming_inflight_jobs">centrifugo_push_consuming_inflight_jobs<a href="#centrifugo_push_consuming_inflight_jobs" class="hash-link" aria-label="Direct link to centrifugo_push_consuming_inflight_jobs" title="Direct link to centrifugo_push_consuming_inflight_jobs">​</a></h4>
<ul>
<li><strong>Type:</strong> Gauge</li>
<li><strong>Labels:</strong> provider, queue</li>
<li><strong>Description:</strong> Number of inflight jobs being consumed.</li>
<li><strong>Usage:</strong> Helps in tracking the load on the job processing system, ensuring that resources are being utilized efficiently.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="centrifugo_push_job_duration_seconds">centrifugo_push_job_duration_seconds<a href="#centrifugo_push_job_duration_seconds" class="hash-link" aria-label="Direct link to centrifugo_push_job_duration_seconds" title="Direct link to centrifugo_push_job_duration_seconds">​</a></h4>
<ul>
<li><strong>Type:</strong> Summary</li>
<li><strong>Labels:</strong> provider, recipient_type</li>
<li><strong>Description:</strong> Duration of push processing job in seconds.</li>
<li><strong>Usage:</strong> Useful for monitoring the performance of job processing, helping in performance tuning and issue resolution.</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="further-reading-and-tutorials">Further reading and tutorials<a href="#further-reading-and-tutorials" class="hash-link" aria-label="Direct link to Further reading and tutorials" title="Direct link to Further reading and tutorials">​</a></h2>
<p>Coming soon.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/centrifugal/centrifugal.dev/edit/main/docs/pro/push_notifications.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/pro/rate_limiting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Operation rate limits</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/pro/admin_idp_auth"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SSO for admin UI (OIDC)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#motivation-and-design-choices" class="table-of-contents__link toc-highlight">Motivation and design choices</a><ul><li><a href="#storage-for-tokens" class="table-of-contents__link toc-highlight">Storage for tokens</a></li><li><a href="#efficient-queuing" class="table-of-contents__link toc-highlight">Efficient queuing</a></li><li><a href="#unified-secure-topics" class="table-of-contents__link toc-highlight">Unified secure topics</a></li><li><a href="#push-personalization" class="table-of-contents__link toc-highlight">Push personalization</a></li><li><a href="#non-obtrusive-proxying" class="table-of-contents__link toc-highlight">Non-obtrusive proxying</a></li><li><a href="#builtin-analytics" class="table-of-contents__link toc-highlight">Builtin analytics</a></li></ul></li><li><a href="#steps-to-integrate" class="table-of-contents__link toc-highlight">Steps to integrate</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#fcm" class="table-of-contents__link toc-highlight">FCM</a></li><li><a href="#hms" class="table-of-contents__link toc-highlight">HMS</a></li><li><a href="#apns" class="table-of-contents__link toc-highlight">APNs</a></li><li><a href="#other-options" class="table-of-contents__link toc-highlight">Other options</a></li><li><a href="#use-postgresql-as-queue" class="table-of-contents__link toc-highlight">Use PostgreSQL as queue</a></li></ul></li><li><a href="#api-description" class="table-of-contents__link toc-highlight">API description</a><ul><li><a href="#device_register" class="table-of-contents__link toc-highlight">device_register</a></li><li><a href="#device_update" class="table-of-contents__link toc-highlight">device_update</a></li><li><a href="#device_remove" class="table-of-contents__link toc-highlight">device_remove</a></li><li><a href="#device_list" class="table-of-contents__link toc-highlight">device_list</a></li><li><a href="#device_topic_update" class="table-of-contents__link toc-highlight">device_topic_update</a></li><li><a href="#device_topic_list" class="table-of-contents__link toc-highlight">device_topic_list</a></li><li><a href="#user_topic_update" class="table-of-contents__link toc-highlight">user_topic_update</a></li><li><a href="#user_topic_list" class="table-of-contents__link toc-highlight">user_topic_list</a></li><li><a href="#send_push_notification" class="table-of-contents__link toc-highlight">send_push_notification</a></li><li><a href="#cancel_push" class="table-of-contents__link toc-highlight">cancel_push</a></li><li><a href="#update_push_status" class="table-of-contents__link toc-highlight">update_push_status</a></li></ul></li><li><a href="#timezone-aware-push" class="table-of-contents__link toc-highlight">Timezone aware push</a></li><li><a href="#templating" class="table-of-contents__link toc-highlight">Templating</a></li><li><a href="#localizations" class="table-of-contents__link toc-highlight">Localizations</a></li><li><a href="#push-rate-limits" class="table-of-contents__link toc-highlight">Push rate limits</a></li><li><a href="#exposed-metrics" class="table-of-contents__link toc-highlight">Exposed metrics</a></li><li><a href="#further-reading-and-tutorials" class="table-of-contents__link toc-highlight">Further reading and tutorials</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contact us</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:hello@centrifugal.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Send e-mail</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/joinchat/U57MI8Lam9mhpuhd" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/tYgADKx" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/centrifugal_dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/attributions">Attributions</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Centrifugal Labs LTD</div></div></div></footer></div>
</body>
</html>